<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OrcaSlicer: Slic3r::TreeSupport Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../OrcaSlicer_32px.png"/></td>
  <td id="projectalign">
   <div id="projectname">OrcaSlicer<span id="projectnumber">&#160;1.6.3</span>
   </div>
   <div id="projectbrief">OrcaSlicer</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d1/d72/class_slic3r_1_1_tree_support.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d0/dc5/class_slic3r_1_1_tree_support-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Slic3r::TreeSupport Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Generates a tree structure to support your models.  
 <a href="../../d1/d72/class_slic3r_1_1_tree_support.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../">src/libslic3r/TreeSupport.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for Slic3r::TreeSupport:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../dd/d9a/class_slic3r_1_1_tree_support__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents the metadata of a node in the tree.  <a href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:dc/d1c/struct_slic3r_1_1_tree_support_1_1_support_params"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#dc/d1c/struct_slic3r_1_1_tree_support_1_1_support_params">SupportParams</a></td></tr>
<tr class="separator:dc/d1c/struct_slic3r_1_1_tree_support_1_1_support_params"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ad8a715908231a21dfd417bb8a368fd78"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78">NodeType</a> { <a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a3c9a5a370b90984dc2d104e87514d68a">eCircle</a>
, <a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a7b80a5e8f3ce36850794346cf62dd87c">eSquare</a>
, <a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a80f9da0a91828bd383c02077dfa419f2">ePolygon</a>
 }</td></tr>
<tr class="separator:ad8a715908231a21dfd417bb8a368fd78"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad1a44839bbfd3668ab21ebf06d4e950c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad1a44839bbfd3668ab21ebf06d4e950c">TreeSupport</a> (<a class="el" href="../../de/d87/class_slic3r_1_1_print_object.html">PrintObject</a> &amp;object, const <a class="el" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html">SlicingParameters</a> &amp;slicing_params)</td></tr>
<tr class="memdesc:ad1a44839bbfd3668ab21ebf06d4e950c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates an instance of the tree support generator.  <br /></td></tr>
<tr class="separator:ad1a44839bbfd3668ab21ebf06d4e950c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd2ed9a998b6d77058c209ca8884b1bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#acd2ed9a998b6d77058c209ca8884b1bf">generate</a> ()</td></tr>
<tr class="memdesc:acd2ed9a998b6d77058c209ca8884b1bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create the areas that need support.  <br /></td></tr>
<tr class="separator:acd2ed9a998b6d77058c209ca8884b1bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abee402a4a54cce95519d410554b75444"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#abee402a4a54cce95519d410554b75444">detect_overhangs</a> (bool detect_first_sharp_tail_only=false)</td></tr>
<tr class="separator:abee402a4a54cce95519d410554b75444"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a87bcd1a50c69642adfbd467a7256c23d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d38/lzoconf_8h.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a87bcd1a50c69642adfbd467a7256c23d">avg_node_per_layer</a> = 0</td></tr>
<tr class="separator:a87bcd1a50c69642adfbd467a7256c23d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4453aaa97f66b4d66f47d534979ee149"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4453aaa97f66b4d66f47d534979ee149">nodes_angle</a> = 0</td></tr>
<tr class="separator:a4453aaa97f66b4d66f47d534979ee149"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6ceca30741c916ae61fd99b6e2f000b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ab6ceca30741c916ae61fd99b6e2f000b">has_overhangs</a> = false</td></tr>
<tr class="separator:ab6ceca30741c916ae61fd99b6e2f000b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea51639c5c7e46181da9e0f45bbda696"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aea51639c5c7e46181da9e0f45bbda696">has_sharp_tails</a> = false</td></tr>
<tr class="separator:aea51639c5c7e46181da9e0f45bbda696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac79134cdc391e7219e62f2c69be76ad7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ac79134cdc391e7219e62f2c69be76ad7">has_cantilever</a> = false</td></tr>
<tr class="separator:ac79134cdc391e7219e62f2c69be76ad7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9a79d4d08f9c209973a02bf7293e2e6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad9a79d4d08f9c209973a02bf7293e2e6">max_cantilever_dist</a> = 0</td></tr>
<tr class="separator:ad9a79d4d08f9c209973a02bf7293e2e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dde09f186446f7f085b60e1a1ea3df3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/db8/namespace_slic3r.html#aaaabcf9acc53536eede4610d1218434c">SupportType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a2dde09f186446f7f085b60e1a1ea3df3">support_type</a></td></tr>
<tr class="separator:a2dde09f186446f7f085b60e1a1ea3df3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafc183d8390ddc4b2b7af16954628504"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/db8/namespace_slic3r.html#ac4444e117129d57974e96c39d6976a3b">SupportMaterialStyle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aafc183d8390ddc4b2b7af16954628504">support_style</a></td></tr>
<tr class="separator:aafc183d8390ddc4b2b7af16954628504"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae0dd8cf9cd59f50841b17a85b3ed4d1"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="../../d3/d93/class_slic3r_1_1_fill_lightning_1_1_generator.html">FillLightning::Generator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aae0dd8cf9cd59f50841b17a85b3ed4d1">generator</a></td></tr>
<tr class="separator:aae0dd8cf9cd59f50841b17a85b3ed4d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99db4fd5f893221ceec871fec5d28af2"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; double, size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a99db4fd5f893221ceec871fec5d28af2">printZ_to_lightninglayer</a></td></tr>
<tr class="separator:a99db4fd5f893221ceec871fec5d28af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a5bf8f77ce79d4b92e7a2b28d96e2ffea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a5bf8f77ce79d4b92e7a2b28d96e2ffea">draw_circles</a> (const std::vector&lt; std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &gt; &amp;contact_nodes)</td></tr>
<tr class="memdesc:a5bf8f77ce79d4b92e7a2b28d96e2ffea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draws circles around each node of the tree into the final support.  <br /></td></tr>
<tr class="separator:a5bf8f77ce79d4b92e7a2b28d96e2ffea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5e4f597762d95dd808dbd053aeac6ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad5e4f597762d95dd808dbd053aeac6ba">drop_nodes</a> (std::vector&lt; std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &gt; &amp;contact_nodes)</td></tr>
<tr class="memdesc:ad5e4f597762d95dd808dbd053aeac6ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drops down the nodes of the tree support towards the build plate.  <br /></td></tr>
<tr class="separator:ad5e4f597762d95dd808dbd053aeac6ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a48a228bbe9db750b4acb65e1ea7ae5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a2a48a228bbe9db750b4acb65e1ea7ae5">smooth_nodes</a> (std::vector&lt; std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &gt; &amp;contact_nodes)</td></tr>
<tr class="separator:a2a48a228bbe9db750b4acb65e1ea7ae5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a140270a302619e88c9cb94cd3efb9c29"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a140270a302619e88c9cb94cd3efb9c29">adjust_layer_heights</a> (std::vector&lt; std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &gt; &amp;contact_nodes)</td></tr>
<tr class="separator:a140270a302619e88c9cb94cd3efb9c29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a819f86c9e3f1aef6f1c99d66a4c19725"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d8/d61/struct_slic3r_1_1_layer_height_data.html">LayerHeightData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a819f86c9e3f1aef6f1c99d66a4c19725">plan_layer_heights</a> (std::vector&lt; std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &gt; &amp;contact_nodes)</td></tr>
<tr class="memdesc:a819f86c9e3f1aef6f1c99d66a4c19725"><td class="mdescLeft">&#160;</td><td class="mdescRight">Optimize the generation of tree support by pre-planning the layer_heights.  <br /></td></tr>
<tr class="separator:a819f86c9e3f1aef6f1c99d66a4c19725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4886a3ee32c274a587fd91a9c644802"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#af4886a3ee32c274a587fd91a9c644802">generate_contact_points</a> (std::vector&lt; std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &gt; &amp;contact_nodes)</td></tr>
<tr class="memdesc:af4886a3ee32c274a587fd91a9c644802"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates points where support contacts the model.  <br /></td></tr>
<tr class="separator:af4886a3ee32c274a587fd91a9c644802"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a311cf4a64ef47ee36a1bbcd2fccb2b20"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a311cf4a64ef47ee36a1bbcd2fccb2b20">insert_dropped_node</a> (std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &amp;nodes_layer, <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> *node)</td></tr>
<tr class="memdesc:a311cf4a64ef47ee36a1bbcd2fccb2b20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a node to the next layer.  <br /></td></tr>
<tr class="separator:a311cf4a64ef47ee36a1bbcd2fccb2b20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5a8e24116c706a5471484c8ec730ad5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ab5a8e24116c706a5471484c8ec730ad5">create_tree_support_layers</a> ()</td></tr>
<tr class="separator:ab5a8e24116c706a5471484c8ec730ad5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1b40260186de1e3d617847acf7386b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa1b40260186de1e3d617847acf7386b5">generate_toolpaths</a> ()</td></tr>
<tr class="separator:aa1b40260186de1e3d617847acf7386b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02203b50af22328f55e5eb988d665553"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a02203b50af22328f55e5eb988d665553">spanning_tree_to_polygon</a> (const std::vector&lt; <a class="el" href="../../df/de0/class_slic3r_1_1_minimum_spanning_tree.html">MinimumSpanningTree</a> &gt; &amp;spanning_trees, <a class="el" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a> layer_contours, <a class="el" href="../../de/d38/lzoconf_8h.html#a61569f2965b7a369eb10b6d75d410d11">int</a> layer_nr)</td></tr>
<tr class="separator:a02203b50af22328f55e5eb988d665553"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9042303103f55d74a7f2d7625fec94ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a9042303103f55d74a7f2d7625fec94ea">contact_nodes_to_polygon</a> (const std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &amp;contact_nodes, <a class="el" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a> layer_contours, <a class="el" href="../../de/d38/lzoconf_8h.html#a61569f2965b7a369eb10b6d75d410d11">int</a> layer_nr, std::vector&lt; double &gt; &amp;radiis, std::vector&lt; bool &gt; &amp;is_interface)</td></tr>
<tr class="separator:a9042303103f55d74a7f2d7625fec94ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b7aa7b2d91917c6952d77796d4584c2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a5b7aa7b2d91917c6952d77796d4584c2">calc_branch_radius</a> (<a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a> base_radius, size_t layers_to_top, size_t tip_layers, double diameter_angle_scale_factor)</td></tr>
<tr class="separator:a5b7aa7b2d91917c6952d77796d4584c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9702a9816a666dc7e2042d74658ef859"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a9702a9816a666dc7e2042d74658ef859">calc_branch_radius</a> (<a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a> base_radius, <a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a> mm_to_top, double diameter_angle_scale_factor)</td></tr>
<tr class="separator:a9702a9816a666dc7e2042d74658ef859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f4739dd1f82d8f6dd87945aaf2ac00b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a1f4739dd1f82d8f6dd87945aaf2ac00b">get_trim_support_regions</a> (const <a class="el" href="../../de/d87/class_slic3r_1_1_print_object.html">PrintObject</a> &amp;object, <a class="el" href="../../de/dad/class_slic3r_1_1_support_layer.html">SupportLayer</a> *support_layer_ptr, const <a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a> gap_extra_above, const <a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a> gap_extra_below, const <a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a> gap_xy)</td></tr>
<tr class="separator:a1f4739dd1f82d8f6dd87945aaf2ac00b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aa683ac2cae76bf3adfde9333039016db"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../d9/da6/class_slic3r_1_1_tree_support_data.html">TreeSupportData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a></td></tr>
<tr class="memdesc:aa683ac2cae76bf3adfde9333039016db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generator for model collision, avoidance and internal guide volumes.  <br /></td></tr>
<tr class="separator:aa683ac2cae76bf3adfde9333039016db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dea25663c426511a32a88d80361fa37"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d87/class_slic3r_1_1_print_object.html">PrintObject</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a></td></tr>
<tr class="separator:a3dea25663c426511a32a88d80361fa37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a676288a8d6c41e000fa9c603362300da"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../de/db8/namespace_slic3r.html#ad48b86fa8e529e56c6bd00ff2f9839ab">PrintObjectConfig</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a></td></tr>
<tr class="separator:a676288a8d6c41e000fa9c603362300da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f07085f338767f4b9fff39a418e717f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html">SlicingParameters</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a></td></tr>
<tr class="separator:a0f07085f338767f4b9fff39a418e717f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cebd329d67e84cf50b2942817987696"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#dc/d1c/struct_slic3r_1_1_tree_support_1_1_support_params">SupportParams</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a></td></tr>
<tr class="separator:a4cebd329d67e84cf50b2942817987696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb71d9dc16f8b49fdde6037bce2ca4cd"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a> = 0</td></tr>
<tr class="separator:adb71d9dc16f8b49fdde6037bce2ca4cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39b142c27d4da545d49307bf5569d3ab"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a39b142c27d4da545d49307bf5569d3ab">m_highest_overhang_layer</a> = 0</td></tr>
<tr class="separator:a39b142c27d4da545d49307bf5569d3ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e234c218b1adc33974bc22796876ed2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="../../df/de0/class_slic3r_1_1_minimum_spanning_tree.html">MinimumSpanningTree</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8e234c218b1adc33974bc22796876ed2">m_spanning_trees</a></td></tr>
<tr class="separator:a8e234c218b1adc33974bc22796876ed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa16cc2e23a002f4f13f5f28ae12afbf4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unordered_map&lt; <a class="el" href="../../d6/d3b/class_slic3r_1_1_line.html">Line</a>, bool, <a class="el" href="../../dd/d21/struct_slic3r_1_1_line_hash.html">LineHash</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa16cc2e23a002f4f13f5f28ae12afbf4">m_mst_line_x_layer_contour_caches</a></td></tr>
<tr class="separator:aa16cc2e23a002f4f13f5f28ae12afbf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a161d05526fd75928c2dc1d04e4c0c49a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a161d05526fd75928c2dc1d04e4c0c49a">MAX_BRANCH_RADIUS</a> = 10.0</td></tr>
<tr class="separator:a161d05526fd75928c2dc1d04e4c0c49a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a49148abbffe316cb0548cbc48d0603"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8a49148abbffe316cb0548cbc48d0603">MIN_BRANCH_RADIUS</a> = 0.5</td></tr>
<tr class="separator:a8a49148abbffe316cb0548cbc48d0603"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2482e1ff17824c9f85615be4188049e"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ac2482e1ff17824c9f85615be4188049e">tree_support_branch_diameter_angle</a> = 5.0</td></tr>
<tr class="separator:ac2482e1ff17824c9f85615be4188049e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fe17d4240db49835485cfc72af0fd1b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0fe17d4240db49835485cfc72af0fd1b">is_strong</a> = false</td></tr>
<tr class="separator:a0fe17d4240db49835485cfc72af0fd1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8697e59f9029b0ce83867137111180e1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8697e59f9029b0ce83867137111180e1">is_slim</a> = false</td></tr>
<tr class="separator:a8697e59f9029b0ce83867137111180e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8272b9400f42356243f0973d0f2cb0c0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8272b9400f42356243f0973d0f2cb0c0">with_infill</a> = false</td></tr>
<tr class="separator:a8272b9400f42356243f0973d0f2cb0c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fa44f6f6c9cbe27ad358c1313e1267d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/dc4/class_slic3r_1_1_ex_polygon.html">ExPolygon</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4fa44f6f6c9cbe27ad358c1313e1267d">m_machine_border</a></td></tr>
<tr class="memdesc:a4fa44f6f6c9cbe27ad358c1313e1267d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Polygons representing the limits of the printable area of the machine.  <br /></td></tr>
<tr class="separator:a4fa44f6f6c9cbe27ad358c1313e1267d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Generates a tree structure to support your models. </p>
</div><hr/><h2 class="groupheader">Class Documentation</h2>
<a name="dc/d1c/struct_slic3r_1_1_tree_support_1_1_support_params" id="dc/d1c/struct_slic3r_1_1_tree_support_1_1_support_params"></a>
<h2 class="memtitle"><span class="permalink"><a href="#dc/d1c/struct_slic3r_1_1_tree_support_1_1_support_params">&#9670;&#160;</a></span>Slic3r::TreeSupport::SupportParams</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Slic3r::TreeSupport::SupportParams</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"></div><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for Slic3r::TreeSupport::SupportParams:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/d3a/struct_slic3r_1_1_tree_support_1_1_support_params__coll__graph.svg" width="262" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Class Members</th></tr>
<tr><td class="fieldtype">
<a id="a6951d86b4fb8946fe6a87548640baec6" name="a6951d86b4fb8946fe6a87548640baec6"></a>float</td>
<td class="fieldname">
base_angle</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0b57348bdfe4441d2eae6348b9910789" name="a0b57348bdfe4441d2eae6348b9910789"></a><a class="el" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391f">InfillPattern</a></td>
<td class="fieldname">
base_fill_pattern</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0339d38ac01b2a8e37430d328290f81c" name="a0339d38ac01b2a8e37430d328290f81c"></a>bool</td>
<td class="fieldname">
can_merge_support_regions</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af304f7a2146b1c0e97bd5f50d53ddf89" name="af304f7a2146b1c0e97bd5f50d53ddf89"></a><a class="el" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391f">InfillPattern</a></td>
<td class="fieldname">
contact_fill_pattern</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4037fe9fc8861fb74e1630976ac1a88b" name="a4037fe9fc8861fb74e1630976ac1a88b"></a><a class="el" href="../../d6/d0f/class_slic3r_1_1_flow.html">Flow</a></td>
<td class="fieldname">
first_layer_flow</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad443916bc6a979eedc20a43b9245b36f" name="ad443916bc6a979eedc20a43b9245b36f"></a><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a></td>
<td class="fieldname">
gap_xy</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8c2af0b936af426eb622c1cd353d5d9c" name="a8c2af0b936af426eb622c1cd353d5d9c"></a>float</td>
<td class="fieldname">
interface_angle</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4896c011eaa36be1fd0d8887dd10f52c" name="a4896c011eaa36be1fd0d8887dd10f52c"></a><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a></td>
<td class="fieldname">
interface_density</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad9411f4ffde2f4dc9aa96f5e016eb919" name="ad9411f4ffde2f4dc9aa96f5e016eb919"></a><a class="el" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391f">InfillPattern</a></td>
<td class="fieldname">
interface_fill_pattern</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af345a46ebbdace89979a4510596228ba" name="af345a46ebbdace89979a4510596228ba"></a><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a></td>
<td class="fieldname">
interface_spacing</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a44bfccfd0efae71de0de19437d28a251" name="a44bfccfd0efae71de0de19437d28a251"></a><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a></td>
<td class="fieldname">
support_density</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa0479aee3f9b52bd26f72c7f94ee4dc0" name="aa0479aee3f9b52bd26f72c7f94ee4dc0"></a><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a></td>
<td class="fieldname">
support_extrusion_width</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a018a7b5f10b8c1416868e1c341468a5c" name="a018a7b5f10b8c1416868e1c341468a5c"></a><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a></td>
<td class="fieldname">
support_layer_height_min</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2b9cc22c8f86b06b39eb1033b7409a55" name="a2b9cc22c8f86b06b39eb1033b7409a55"></a><a class="el" href="../../d6/d0f/class_slic3r_1_1_flow.html">Flow</a></td>
<td class="fieldname">
support_material_bottom_interface_flow</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af8d086e69a909a7f871326f93e621812" name="af8d086e69a909a7f871326f93e621812"></a><a class="el" href="../../d6/d0f/class_slic3r_1_1_flow.html">Flow</a></td>
<td class="fieldname">
support_material_flow</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7f18bdb7671ff17f334a8407da37af54" name="a7f18bdb7671ff17f334a8407da37af54"></a><a class="el" href="../../d6/d0f/class_slic3r_1_1_flow.html">Flow</a></td>
<td class="fieldname">
support_material_interface_flow</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae384384c282580651b943114d79985a5" name="ae384384c282580651b943114d79985a5"></a><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a></td>
<td class="fieldname">
support_spacing</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af4d2760e2fc64fbd954c6fefa926200e" name="af4d2760e2fc64fbd954c6fefa926200e"></a>const double</td>
<td class="fieldname">
thresh_big_overhang = <a class="el" href="../../db/d7c/_orient_8cpp.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(<a class="el" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(10))</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a755c9773bf2e5ee3cc06a6947c402124" name="a755c9773bf2e5ee3cc06a6947c402124"></a>bool</td>
<td class="fieldname">
with_sheath</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="ad8a715908231a21dfd417bb8a368fd78" name="ad8a715908231a21dfd417bb8a368fd78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8a715908231a21dfd417bb8a368fd78">&#9670;&#160;</a></span>NodeType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78">Slic3r::TreeSupport::NodeType</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ad8a715908231a21dfd417bb8a368fd78a3c9a5a370b90984dc2d104e87514d68a" name="ad8a715908231a21dfd417bb8a368fd78a3c9a5a370b90984dc2d104e87514d68a"></a>eCircle&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad8a715908231a21dfd417bb8a368fd78a7b80a5e8f3ce36850794346cf62dd87c" name="ad8a715908231a21dfd417bb8a368fd78a7b80a5e8f3ce36850794346cf62dd87c"></a>eSquare&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad8a715908231a21dfd417bb8a368fd78a80f9da0a91828bd383c02077dfa419f2" name="ad8a715908231a21dfd417bb8a368fd78a80f9da0a91828bd383c02077dfa419f2"></a>ePolygon&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><span class="lineno">  229</span>                  {</div>
<div class="line"><span class="lineno">  230</span>        <a class="code hl_enumvalue" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a3c9a5a370b90984dc2d104e87514d68a">eCircle</a>,</div>
<div class="line"><span class="lineno">  231</span>        <a class="code hl_enumvalue" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a7b80a5e8f3ce36850794346cf62dd87c">eSquare</a>,</div>
<div class="line"><span class="lineno">  232</span>        <a class="code hl_enumvalue" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a80f9da0a91828bd383c02077dfa419f2">ePolygon</a></div>
<div class="line"><span class="lineno">  233</span>    };</div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_ad8a715908231a21dfd417bb8a368fd78a3c9a5a370b90984dc2d104e87514d68a"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a3c9a5a370b90984dc2d104e87514d68a">Slic3r::TreeSupport::eCircle</a></div><div class="ttdeci">@ eCircle</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:230</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_ad8a715908231a21dfd417bb8a368fd78a7b80a5e8f3ce36850794346cf62dd87c"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a7b80a5e8f3ce36850794346cf62dd87c">Slic3r::TreeSupport::eSquare</a></div><div class="ttdeci">@ eSquare</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:231</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_ad8a715908231a21dfd417bb8a368fd78a80f9da0a91828bd383c02077dfa419f2"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a80f9da0a91828bd383c02077dfa419f2">Slic3r::TreeSupport::ePolygon</a></div><div class="ttdeci">@ ePolygon</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:232</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad1a44839bbfd3668ab21ebf06d4e950c" name="ad1a44839bbfd3668ab21ebf06d4e950c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1a44839bbfd3668ab21ebf06d4e950c">&#9670;&#160;</a></span>TreeSupport()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Slic3r::TreeSupport::TreeSupport </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d87/class_slic3r_1_1_print_object.html">PrintObject</a> &amp;&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html">SlicingParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>slicing_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates an instance of the tree support generator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">storage</td><td>The data storage to get global settings from. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  665</span>    : <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>(&amp;<span class="keywordtype">object</span>), <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>(slicing_params), <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>(&amp;<span class="keywordtype">object</span>.config())</div>
<div class="line"><span class="lineno">  666</span>{</div>
<div class="line"><span class="lineno">  667</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a> = slicing_params.base_raft_layers + slicing_params.interface_raft_layers;</div>
<div class="line"><span class="lineno">  668</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a2dde09f186446f7f085b60e1a1ea3df3">support_type</a> = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;support_type;</div>
<div class="line"><span class="lineno">  669</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aafc183d8390ddc4b2b7af16954628504">support_style</a> = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;support_style;</div>
<div class="line"><span class="lineno">  670</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aafc183d8390ddc4b2b7af16954628504">support_style</a> == <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#ac4444e117129d57974e96c39d6976a3bac612928db4605fa5c708afde67f78d3e">smsDefault</a>)</div>
<div class="line"><span class="lineno">  671</span>        <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aafc183d8390ddc4b2b7af16954628504">support_style</a> = <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#ac4444e117129d57974e96c39d6976a3ba2d0abf8e046fa487260fa805a652b9d5">smsTreeHybrid</a>;</div>
<div class="line"><span class="lineno">  672</span>    <a class="code hl_enumeration" href="../../de/db8/namespace_slic3r.html#a83b9b01271dda8378c1cc57f30699d18">SupportMaterialPattern</a> support_pattern  = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;support_base_pattern;</div>
<div class="line"><span class="lineno">  673</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aafc183d8390ddc4b2b7af16954628504">support_style</a> == <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#ac4444e117129d57974e96c39d6976a3ba2d0abf8e046fa487260fa805a652b9d5">smsTreeHybrid</a> &amp;&amp; support_pattern == <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a83b9b01271dda8378c1cc57f30699d18a72d013e1008cfd10ed36fdaf4b70632b">smpDefault</a>) support_pattern = <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a83b9b01271dda8378c1cc57f30699d18a85b22b3252fadde1298942b7763b580a">smpRectilinear</a>;</div>
<div class="line"><span class="lineno">  674</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0b57348bdfe4441d2eae6348b9910789">base_fill_pattern</a>      = </div>
<div class="line"><span class="lineno">  675</span>        support_pattern == <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a83b9b01271dda8378c1cc57f30699d18aea857112697595b7848f7e3c1490dbb3">smpLightning</a> ? <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391faed23767b6563b5210ab79edf529e963f">ipLightning</a> :</div>
<div class="line"><span class="lineno">  676</span>        support_pattern == <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a83b9b01271dda8378c1cc57f30699d18a415cb3ea09fd044aba43e28dbff0fbae">smpHoneycomb</a> ? <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fa9ab65fe60393bf811c7d2b2ceb490914">ipHoneycomb</a> :</div>
<div class="line"><span class="lineno">  677</span>                                              <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a44bfccfd0efae71de0de19437d28a251">support_density</a> &gt; 0.95 || <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a755c9773bf2e5ee3cc06a6947c402124">with_sheath</a> ? <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fac9e881fccb86a6b1c7cf776b66c6e0db">ipRectilinear</a> :</div>
<div class="line"><span class="lineno">  678</span>                                                                                                                        <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fad27422de5599a8df0e5390e941f026d8">ipSupportBase</a>;</div>
<div class="line"><span class="lineno">  679</span> </div>
<div class="line"><span class="lineno">  680</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad9411f4ffde2f4dc9aa96f5e016eb919">interface_fill_pattern</a> = (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4896c011eaa36be1fd0d8887dd10f52c">interface_density</a> &gt; 0.95 ? <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fac9e881fccb86a6b1c7cf776b66c6e0db">ipRectilinear</a> : <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fad27422de5599a8df0e5390e941f026d8">ipSupportBase</a>);</div>
<div class="line"><span class="lineno">  681</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;support_interface_pattern == <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a2425d8c19b9e870d7cf339a4d20b359fa7fcfb7d754ada354877eef825b10826b">smipGrid</a>)</div>
<div class="line"><span class="lineno">  682</span>        <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#af304f7a2146b1c0e97bd5f50d53ddf89">contact_fill_pattern</a> = <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fa1af242c1f2f088f5cb8606d65b6d6882">ipGrid</a>;</div>
<div class="line"><span class="lineno">  683</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;support_interface_pattern == <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a2425d8c19b9e870d7cf339a4d20b359fa8bff5091a211100369778c1d8503f609">smipRectilinearInterlaced</a>)</div>
<div class="line"><span class="lineno">  684</span>        <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#af304f7a2146b1c0e97bd5f50d53ddf89">contact_fill_pattern</a> = <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fac9e881fccb86a6b1c7cf776b66c6e0db">ipRectilinear</a>;</div>
<div class="line"><span class="lineno">  685</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  686</span>        <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#af304f7a2146b1c0e97bd5f50d53ddf89">contact_fill_pattern</a> = (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;support_interface_pattern == <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a2425d8c19b9e870d7cf339a4d20b359fad8fb0b118d6ba40b9266865105b007ae">smipAuto</a> &amp;&amp; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#ac8f1765efb10ac97c597982a0b4847f5">soluble_interface</a>) ||</div>
<div class="line"><span class="lineno">  687</span>        <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;support_interface_pattern == <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a2425d8c19b9e870d7cf339a4d20b359fa47d89130617fd8ce6ffb4c5c1ea765e5">smipConcentric</a> ?</div>
<div class="line"><span class="lineno">  688</span>        <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fa34c84fa363677f6c3465fdf3ad296c2f">ipConcentric</a> :</div>
<div class="line"><span class="lineno">  689</span>        (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.interface_density &gt; 0.95 ? <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fac9e881fccb86a6b1c7cf776b66c6e0db">ipRectilinear</a> : <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fad27422de5599a8df0e5390e941f026d8">ipSupportBase</a>);</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>    <span class="keyword">const</span> <span class="keyword">auto</span> nozzle_diameter = <span class="keywordtype">object</span>.print()-&gt;config().nozzle_diameter.get_at(<span class="keywordtype">object</span>.config().support_interface_filament-1);</div>
<div class="line"><span class="lineno">  692</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> extrusion_width = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;line_width.get_abs_value(nozzle_diameter);</div>
<div class="line"><span class="lineno">  693</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> support_extrusion_width = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;support_line_width.get_abs_value(nozzle_diameter);</div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa0479aee3f9b52bd26f72c7f94ee4dc0">support_extrusion_width</a> = support_extrusion_width &gt; 0 ? support_extrusion_width : extrusion_width;</div>
<div class="line"><span class="lineno">  696</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8697e59f9029b0ce83867137111180e1">is_slim</a>                                  = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#acea487914e9a59d090643d971f5cedb7">is_tree_slim</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a2dde09f186446f7f085b60e1a1ea3df3">support_type</a>, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aafc183d8390ddc4b2b7af16954628504">support_style</a>);</div>
<div class="line"><span class="lineno">  697</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0fe17d4240db49835485cfc72af0fd1b">is_strong</a> = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a61b97e6f6260d750b0110a6b0d0ebc88">is_tree</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a2dde09f186446f7f085b60e1a1ea3df3">support_type</a>) &amp;&amp; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aafc183d8390ddc4b2b7af16954628504">support_style</a> == <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#ac4444e117129d57974e96c39d6976a3ba2d668c9a5b5a7e89e08c0bb31db80f7f">smsTreeStrong</a>;</div>
<div class="line"><span class="lineno">  698</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a161d05526fd75928c2dc1d04e4c0c49a">MAX_BRANCH_RADIUS</a>                        = 10.0;</div>
<div class="line"><span class="lineno">  699</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ac2482e1ff17824c9f85615be4188049e">tree_support_branch_diameter_angle</a>       = 5.0;<span class="comment">//is_slim ? 10.0 : 5.0;</span></div>
<div class="line"><span class="lineno">  700</span>    <span class="comment">// by default tree support needs no infill, unless it&#39;s tree hybrid which contains normal nodes.</span></div>
<div class="line"><span class="lineno">  701</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8272b9400f42356243f0973d0f2cb0c0">with_infill</a>                              = support_pattern != <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a83b9b01271dda8378c1cc57f30699d18a35e3d0d06bab3f0c6ac825a36e031e63">smpNone</a> &amp;&amp; support_pattern != <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a83b9b01271dda8378c1cc57f30699d18a72d013e1008cfd10ed36fdaf4b70632b">smpDefault</a>;</div>
<div class="line"><span class="lineno">  702</span>    <span class="keyword">const</span> PrintConfig&amp; print_config = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../d5/d8f/class_slic3r_1_1_print.html#af1937a680d19c7dd8d3c24e5ff7332b8">config</a>();</div>
<div class="line"><span class="lineno">  703</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4fa44f6f6c9cbe27ad358c1313e1267d">m_machine_border</a>.<a class="code hl_variable" href="../../db/dc4/class_slic3r_1_1_ex_polygon.html#a3fd4f1e86f356c9ac79dabfda8b43aec">contour</a> = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#ac753ec8226df83c882eeacd6967ee2ec">get_bed_shape_with_excluded_area</a>(print_config);</div>
<div class="line"><span class="lineno">  704</span>    <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a6b8e15a6e63fb72a48bc5e49b8a6f6b1">Vec3d</a> plate_offset       = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../d5/d8f/class_slic3r_1_1_print.html#a8fa531f7f792c49066c565becd037973">get_plate_origin</a>();</div>
<div class="line"><span class="lineno">  705</span>    <span class="comment">// align with the centered object in current plate (may not be the 1st plate, so need to add the plate offset)</span></div>
<div class="line"><span class="lineno">  706</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4fa44f6f6c9cbe27ad358c1313e1267d">m_machine_border</a>.<a class="code hl_function" href="../../db/dc4/class_slic3r_1_1_ex_polygon.html#ac0473cb34e9382aaa9180bbd0b6a6e4e">translate</a>(<a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(<a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(plate_offset(0)), <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(plate_offset(1))) - <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a0d2ecba1a8eb6257be5586d5b32045e3">instances</a>().front().shift);</div>
<div class="line"><span class="lineno">  707</span><span class="preprocessor">#ifdef SUPPORT_TREE_DEBUG_TO_SVG</span></div>
<div class="line"><span class="lineno">  708</span>    <a class="code hl_enumvalue" href="../../df/ddf/namespacelibnest2d.html#af597612c78e3eb318a885f34ddafa180acd15a75c26008696647b31a3f0de43b3">SVG</a> svg(<span class="stringliteral">&quot;SVG/machine_boarder.svg&quot;</span>, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a571b601aadc8d8a24208e933bbd8704c">bounding_box</a>());</div>
<div class="line"><span class="lineno">  709</span>    <span class="keywordflow">if</span> (svg.is_opened()) svg.draw(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4fa44f6f6c9cbe27ad358c1313e1267d">m_machine_border</a>, <span class="stringliteral">&quot;yellow&quot;</span>);</div>
<div class="line"><span class="lineno">  710</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  711</span>}</div>
<div class="ttc" id="aclass_slic3r_1_1_ex_polygon_html_a3fd4f1e86f356c9ac79dabfda8b43aec"><div class="ttname"><a href="../../db/dc4/class_slic3r_1_1_ex_polygon.html#a3fd4f1e86f356c9ac79dabfda8b43aec">Slic3r::ExPolygon::contour</a></div><div class="ttdeci">Polygon contour</div><div class="ttdef"><b>Definition</b> ExPolygon.hpp:35</div></div>
<div class="ttc" id="aclass_slic3r_1_1_ex_polygon_html_ac0473cb34e9382aaa9180bbd0b6a6e4e"><div class="ttname"><a href="../../db/dc4/class_slic3r_1_1_ex_polygon.html#ac0473cb34e9382aaa9180bbd0b6a6e4e">Slic3r::ExPolygon::translate</a></div><div class="ttdeci">void translate(double x, double y)</div><div class="ttdef"><b>Definition</b> ExPolygon.hpp:41</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_html_a8fa531f7f792c49066c565becd037973"><div class="ttname"><a href="../../d5/d8f/class_slic3r_1_1_print.html#a8fa531f7f792c49066c565becd037973">Slic3r::Print::get_plate_origin</a></div><div class="ttdeci">const Vec3d get_plate_origin() const</div><div class="ttdef"><b>Definition</b> Print.hpp:791</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_html_af1937a680d19c7dd8d3c24e5ff7332b8"><div class="ttname"><a href="../../d5/d8f/class_slic3r_1_1_print.html#af1937a680d19c7dd8d3c24e5ff7332b8">Slic3r::Print::config</a></div><div class="ttdeci">const PrintConfig &amp; config() const</div><div class="ttdef"><b>Definition</b> Print.hpp:740</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_base_with_state_html_ac2790a8abd4e0ae7ca1290b25285940e"><div class="ttname"><a href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">Slic3r::PrintObjectBaseWithState::print</a></div><div class="ttdeci">PrintType * print()</div><div class="ttdef"><b>Definition</b> PrintBase.hpp:625</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_a0d2ecba1a8eb6257be5586d5b32045e3"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#a0d2ecba1a8eb6257be5586d5b32045e3">Slic3r::PrintObject::instances</a></div><div class="ttdeci">const PrintInstances &amp; instances() const</div><div class="ttdef"><b>Definition</b> Print.hpp:307</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_a571b601aadc8d8a24208e933bbd8704c"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#a571b601aadc8d8a24208e933bbd8704c">Slic3r::PrintObject::bounding_box</a></div><div class="ttdeci">BoundingBox bounding_box() const</div><div class="ttdef"><b>Definition</b> Print.hpp:325</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a0b57348bdfe4441d2eae6348b9910789"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0b57348bdfe4441d2eae6348b9910789">Slic3r::TreeSupport::SupportParams::base_fill_pattern</a></div><div class="ttdeci">InfillPattern base_fill_pattern</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:386</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a0f07085f338767f4b9fff39a418e717f"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">Slic3r::TreeSupport::m_slicing_params</a></div><div class="ttdeci">SlicingParameters m_slicing_params</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:414</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a0fe17d4240db49835485cfc72af0fd1b"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0fe17d4240db49835485cfc72af0fd1b">Slic3r::TreeSupport::is_strong</a></div><div class="ttdeci">bool is_strong</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:424</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a161d05526fd75928c2dc1d04e4c0c49a"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a161d05526fd75928c2dc1d04e4c0c49a">Slic3r::TreeSupport::MAX_BRANCH_RADIUS</a></div><div class="ttdeci">coordf_t MAX_BRANCH_RADIUS</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:421</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a2dde09f186446f7f085b60e1a1ea3df3"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a2dde09f186446f7f085b60e1a1ea3df3">Slic3r::TreeSupport::support_type</a></div><div class="ttdeci">SupportType support_type</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:399</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a3dea25663c426511a32a88d80361fa37"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">Slic3r::TreeSupport::m_object</a></div><div class="ttdeci">PrintObject * m_object</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:412</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a44bfccfd0efae71de0de19437d28a251"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a44bfccfd0efae71de0de19437d28a251">Slic3r::TreeSupport::SupportParams::support_density</a></div><div class="ttdeci">coordf_t support_density</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:384</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a4896c011eaa36be1fd0d8887dd10f52c"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4896c011eaa36be1fd0d8887dd10f52c">Slic3r::TreeSupport::SupportParams::interface_density</a></div><div class="ttdeci">coordf_t interface_density</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:382</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a4cebd329d67e84cf50b2942817987696"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">Slic3r::TreeSupport::m_support_params</a></div><div class="ttdeci">SupportParams m_support_params</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:416</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a4fa44f6f6c9cbe27ad358c1313e1267d"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4fa44f6f6c9cbe27ad358c1313e1267d">Slic3r::TreeSupport::m_machine_border</a></div><div class="ttdeci">ExPolygon m_machine_border</div><div class="ttdoc">Polygons representing the limits of the printable area of the machine.</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:433</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a676288a8d6c41e000fa9c603362300da"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">Slic3r::TreeSupport::m_object_config</a></div><div class="ttdeci">const PrintObjectConfig * m_object_config</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:413</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a755c9773bf2e5ee3cc06a6947c402124"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a755c9773bf2e5ee3cc06a6947c402124">Slic3r::TreeSupport::SupportParams::with_sheath</a></div><div class="ttdeci">bool with_sheath</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:389</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a8272b9400f42356243f0973d0f2cb0c0"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8272b9400f42356243f0973d0f2cb0c0">Slic3r::TreeSupport::with_infill</a></div><div class="ttdeci">bool with_infill</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:426</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a8697e59f9029b0ce83867137111180e1"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8697e59f9029b0ce83867137111180e1">Slic3r::TreeSupport::is_slim</a></div><div class="ttdeci">bool is_slim</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:425</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_aa0479aee3f9b52bd26f72c7f94ee4dc0"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa0479aee3f9b52bd26f72c7f94ee4dc0">Slic3r::TreeSupport::SupportParams::support_extrusion_width</a></div><div class="ttdeci">coordf_t support_extrusion_width</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:370</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_aafc183d8390ddc4b2b7af16954628504"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#aafc183d8390ddc4b2b7af16954628504">Slic3r::TreeSupport::support_style</a></div><div class="ttdeci">SupportMaterialStyle support_style</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:400</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_ac2482e1ff17824c9f85615be4188049e"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#ac2482e1ff17824c9f85615be4188049e">Slic3r::TreeSupport::tree_support_branch_diameter_angle</a></div><div class="ttdeci">float tree_support_branch_diameter_angle</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:423</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_ad9411f4ffde2f4dc9aa96f5e016eb919"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad9411f4ffde2f4dc9aa96f5e016eb919">Slic3r::TreeSupport::SupportParams::interface_fill_pattern</a></div><div class="ttdeci">InfillPattern interface_fill_pattern</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:387</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_adb71d9dc16f8b49fdde6037bce2ca4cd"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">Slic3r::TreeSupport::m_raft_layers</a></div><div class="ttdeci">size_t m_raft_layers</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:417</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_af304f7a2146b1c0e97bd5f50d53ddf89"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#af304f7a2146b1c0e97bd5f50d53ddf89">Slic3r::TreeSupport::SupportParams::contact_fill_pattern</a></div><div class="ttdeci">InfillPattern contact_fill_pattern</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:388</div></div>
<div class="ttc" id="alibslic3r_8h_html_a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2"><div class="ttname"><a href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a></div><div class="ttdeci">#define scale_(val)</div><div class="ttdef"><b>Definition</b> libslic3r.h:81</div></div>
<div class="ttc" id="alibslic3r_8h_html_a95c875c81df33d788132374e2b57c6c1"><div class="ttname"><a href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a></div><div class="ttdeci">double coordf_t</div><div class="ttdef"><b>Definition</b> libslic3r.h:46</div></div>
<div class="ttc" id="anamespace_slic3r_html_a0799da4d5630e9003a6732d1b159391fa1af242c1f2f088f5cb8606d65b6d6882"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fa1af242c1f2f088f5cb8606d65b6d6882">Slic3r::ipGrid</a></div><div class="ttdeci">@ ipGrid</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:55</div></div>
<div class="ttc" id="anamespace_slic3r_html_a0799da4d5630e9003a6732d1b159391fa34c84fa363677f6c3465fdf3ad296c2f"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fa34c84fa363677f6c3465fdf3ad296c2f">Slic3r::ipConcentric</a></div><div class="ttdeci">@ ipConcentric</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:55</div></div>
<div class="ttc" id="anamespace_slic3r_html_a0799da4d5630e9003a6732d1b159391fa9ab65fe60393bf811c7d2b2ceb490914"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fa9ab65fe60393bf811c7d2b2ceb490914">Slic3r::ipHoneycomb</a></div><div class="ttdeci">@ ipHoneycomb</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:55</div></div>
<div class="ttc" id="anamespace_slic3r_html_a0799da4d5630e9003a6732d1b159391fac9e881fccb86a6b1c7cf776b66c6e0db"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fac9e881fccb86a6b1c7cf776b66c6e0db">Slic3r::ipRectilinear</a></div><div class="ttdeci">@ ipRectilinear</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:55</div></div>
<div class="ttc" id="anamespace_slic3r_html_a0799da4d5630e9003a6732d1b159391fad27422de5599a8df0e5390e941f026d8"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fad27422de5599a8df0e5390e941f026d8">Slic3r::ipSupportBase</a></div><div class="ttdeci">@ ipSupportBase</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:56</div></div>
<div class="ttc" id="anamespace_slic3r_html_a0799da4d5630e9003a6732d1b159391faed23767b6563b5210ab79edf529e963f"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391faed23767b6563b5210ab79edf529e963f">Slic3r::ipLightning</a></div><div class="ttdeci">@ ipLightning</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:57</div></div>
<div class="ttc" id="anamespace_slic3r_html_a2425d8c19b9e870d7cf339a4d20b359fa47d89130617fd8ce6ffb4c5c1ea765e5"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a2425d8c19b9e870d7cf339a4d20b359fa47d89130617fd8ce6ffb4c5c1ea765e5">Slic3r::smipConcentric</a></div><div class="ttdeci">@ smipConcentric</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:108</div></div>
<div class="ttc" id="anamespace_slic3r_html_a2425d8c19b9e870d7cf339a4d20b359fa7fcfb7d754ada354877eef825b10826b"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a2425d8c19b9e870d7cf339a4d20b359fa7fcfb7d754ada354877eef825b10826b">Slic3r::smipGrid</a></div><div class="ttdeci">@ smipGrid</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:108</div></div>
<div class="ttc" id="anamespace_slic3r_html_a2425d8c19b9e870d7cf339a4d20b359fa8bff5091a211100369778c1d8503f609"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a2425d8c19b9e870d7cf339a4d20b359fa8bff5091a211100369778c1d8503f609">Slic3r::smipRectilinearInterlaced</a></div><div class="ttdeci">@ smipRectilinearInterlaced</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:108</div></div>
<div class="ttc" id="anamespace_slic3r_html_a2425d8c19b9e870d7cf339a4d20b359fad8fb0b118d6ba40b9266865105b007ae"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a2425d8c19b9e870d7cf339a4d20b359fad8fb0b118d6ba40b9266865105b007ae">Slic3r::smipAuto</a></div><div class="ttdeci">@ smipAuto</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:108</div></div>
<div class="ttc" id="anamespace_slic3r_html_a61b97e6f6260d750b0110a6b0d0ebc88"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a61b97e6f6260d750b0110a6b0d0ebc88">Slic3r::is_tree</a></div><div class="ttdeci">bool is_tree(SupportType stype)</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:115</div></div>
<div class="ttc" id="anamespace_slic3r_html_a6b8e15a6e63fb72a48bc5e49b8a6f6b1"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a6b8e15a6e63fb72a48bc5e49b8a6f6b1">Slic3r::Vec3d</a></div><div class="ttdeci">Eigen::Matrix&lt; double, 3, 1, Eigen::DontAlign &gt; Vec3d</div><div class="ttdef"><b>Definition</b> Point.hpp:46</div></div>
<div class="ttc" id="anamespace_slic3r_html_a83b9b01271dda8378c1cc57f30699d18"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a83b9b01271dda8378c1cc57f30699d18">Slic3r::SupportMaterialPattern</a></div><div class="ttdeci">SupportMaterialPattern</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:96</div></div>
<div class="ttc" id="anamespace_slic3r_html_a83b9b01271dda8378c1cc57f30699d18a35e3d0d06bab3f0c6ac825a36e031e63"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a83b9b01271dda8378c1cc57f30699d18a35e3d0d06bab3f0c6ac825a36e031e63">Slic3r::smpNone</a></div><div class="ttdeci">@ smpNone</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:100</div></div>
<div class="ttc" id="anamespace_slic3r_html_a83b9b01271dda8378c1cc57f30699d18a415cb3ea09fd044aba43e28dbff0fbae"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a83b9b01271dda8378c1cc57f30699d18a415cb3ea09fd044aba43e28dbff0fbae">Slic3r::smpHoneycomb</a></div><div class="ttdeci">@ smpHoneycomb</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:98</div></div>
<div class="ttc" id="anamespace_slic3r_html_a83b9b01271dda8378c1cc57f30699d18a72d013e1008cfd10ed36fdaf4b70632b"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a83b9b01271dda8378c1cc57f30699d18a72d013e1008cfd10ed36fdaf4b70632b">Slic3r::smpDefault</a></div><div class="ttdeci">@ smpDefault</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:97</div></div>
<div class="ttc" id="anamespace_slic3r_html_a83b9b01271dda8378c1cc57f30699d18a85b22b3252fadde1298942b7763b580a"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a83b9b01271dda8378c1cc57f30699d18a85b22b3252fadde1298942b7763b580a">Slic3r::smpRectilinear</a></div><div class="ttdeci">@ smpRectilinear</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:98</div></div>
<div class="ttc" id="anamespace_slic3r_html_a83b9b01271dda8378c1cc57f30699d18aea857112697595b7848f7e3c1490dbb3"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a83b9b01271dda8378c1cc57f30699d18aea857112697595b7848f7e3c1490dbb3">Slic3r::smpLightning</a></div><div class="ttdeci">@ smpLightning</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:99</div></div>
<div class="ttc" id="anamespace_slic3r_html_ac4444e117129d57974e96c39d6976a3ba2d0abf8e046fa487260fa805a652b9d5"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#ac4444e117129d57974e96c39d6976a3ba2d0abf8e046fa487260fa805a652b9d5">Slic3r::smsTreeHybrid</a></div><div class="ttdeci">@ smsTreeHybrid</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:104</div></div>
<div class="ttc" id="anamespace_slic3r_html_ac4444e117129d57974e96c39d6976a3ba2d668c9a5b5a7e89e08c0bb31db80f7f"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#ac4444e117129d57974e96c39d6976a3ba2d668c9a5b5a7e89e08c0bb31db80f7f">Slic3r::smsTreeStrong</a></div><div class="ttdeci">@ smsTreeStrong</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:104</div></div>
<div class="ttc" id="anamespace_slic3r_html_ac4444e117129d57974e96c39d6976a3bac612928db4605fa5c708afde67f78d3e"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#ac4444e117129d57974e96c39d6976a3bac612928db4605fa5c708afde67f78d3e">Slic3r::smsDefault</a></div><div class="ttdeci">@ smsDefault</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:104</div></div>
<div class="ttc" id="anamespace_slic3r_html_ac753ec8226df83c882eeacd6967ee2ec"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#ac753ec8226df83c882eeacd6967ee2ec">Slic3r::get_bed_shape_with_excluded_area</a></div><div class="ttdeci">Polygon get_bed_shape_with_excluded_area(const PrintConfig &amp;cfg)</div><div class="ttdef"><b>Definition</b> PrintConfig.cpp:5626</div></div>
<div class="ttc" id="anamespace_slic3r_html_acea487914e9a59d090643d971f5cedb7"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#acea487914e9a59d090643d971f5cedb7">Slic3r::is_tree_slim</a></div><div class="ttdeci">bool is_tree_slim(SupportType type, SupportMaterialStyle style)</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:119</div></div>
<div class="ttc" id="anamespacelibnest2d_html_af597612c78e3eb318a885f34ddafa180acd15a75c26008696647b31a3f0de43b3"><div class="ttname"><a href="../../df/ddf/namespacelibnest2d.html#af597612c78e3eb318a885f34ddafa180acd15a75c26008696647b31a3f0de43b3">libnest2d::Formats::SVG</a></div><div class="ttdeci">@ SVG</div></div>
<div class="ttc" id="apoint__areas_8cpp_html_a6a2f109ab3e0aba2f61e7d28188c3660"><div class="ttname"><a href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a></div><div class="ttdeci">Kernel::Point_2 Point</div><div class="ttdef"><b>Definition</b> point_areas.cpp:20</div></div>
<div class="ttc" id="astruct_slic3r_1_1_slicing_parameters_html_ac8f1765efb10ac97c597982a0b4847f5"><div class="ttname"><a href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#ac8f1765efb10ac97c597982a0b4847f5">Slic3r::SlicingParameters::soluble_interface</a></div><div class="ttdeci">bool soluble_interface</div><div class="ttdef"><b>Definition</b> Slicing.hpp:82</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00386">Slic3r::TreeSupport::SupportParams::base_fill_pattern</a>, <a class="el" href="../../#l00050">Slic3r::SlicingParameters::base_raft_layers</a>, <a class="el" href="../../#l00325">Slic3r::PrintObject::bounding_box()</a>, <a class="el" href="../../#l00740">Slic3r::Print::config()</a>, <a class="el" href="../../#l00388">Slic3r::TreeSupport::SupportParams::contact_fill_pattern</a>, <a class="el" href="../../#l00035">Slic3r::ExPolygon::contour</a>, <a class="el" href="../../#l00049">Slic3r::SVG::draw()</a>, <a class="el" href="../../#l05626">Slic3r::get_bed_shape_with_excluded_area()</a>, <a class="el" href="../../#l00791">Slic3r::Print::get_plate_origin()</a>, <a class="el" href="../../#l00307">Slic3r::PrintObject::instances()</a>, <a class="el" href="../../#l00382">Slic3r::TreeSupport::SupportParams::interface_density</a>, <a class="el" href="../../#l00387">Slic3r::TreeSupport::SupportParams::interface_fill_pattern</a>, <a class="el" href="../../#l00052">Slic3r::SlicingParameters::interface_raft_layers</a>, <a class="el" href="../../#l00055">Slic3r::ipConcentric</a>, <a class="el" href="../../#l00055">Slic3r::ipGrid</a>, <a class="el" href="../../#l00055">Slic3r::ipHoneycomb</a>, <a class="el" href="../../#l00057">Slic3r::ipLightning</a>, <a class="el" href="../../#l00055">Slic3r::ipRectilinear</a>, <a class="el" href="../../#l00056">Slic3r::ipSupportBase</a>, <a class="el" href="../../#l00043">Slic3r::SVG::is_opened()</a>, <a class="el" href="../../#l00425">is_slim</a>, <a class="el" href="../../#l00424">is_strong</a>, <a class="el" href="../../#l00115">Slic3r::is_tree()</a>, <a class="el" href="../../#l00119">Slic3r::is_tree_slim()</a>, <a class="el" href="../../#l00433">m_machine_border</a>, <a class="el" href="../../#l00412">m_object</a>, <a class="el" href="../../#l00413">m_object_config</a>, <a class="el" href="../../#l00417">m_raft_layers</a>, <a class="el" href="../../#l00414">m_slicing_params</a>, <a class="el" href="../../#l00416">m_support_params</a>, <a class="el" href="../../#l00421">MAX_BRANCH_RADIUS</a>, <a class="el" href="../../#l00625">Slic3r::PrintObjectBaseWithState&lt; PrintType, PrintObjectStepEnum, COUNT &gt;::print()</a>, <a class="el" href="../../#l00081">scale_</a>, <a class="el" href="../../#l00108">Slic3r::smipAuto</a>, <a class="el" href="../../#l00108">Slic3r::smipConcentric</a>, <a class="el" href="../../#l00108">Slic3r::smipGrid</a>, <a class="el" href="../../#l00108">Slic3r::smipRectilinearInterlaced</a>, <a class="el" href="../../#l00097">Slic3r::smpDefault</a>, <a class="el" href="../../#l00098">Slic3r::smpHoneycomb</a>, <a class="el" href="../../#l00099">Slic3r::smpLightning</a>, <a class="el" href="../../#l00100">Slic3r::smpNone</a>, <a class="el" href="../../#l00098">Slic3r::smpRectilinear</a>, <a class="el" href="../../#l00104">Slic3r::smsDefault</a>, <a class="el" href="../../#l00104">Slic3r::smsTreeHybrid</a>, <a class="el" href="../../#l00104">Slic3r::smsTreeStrong</a>, <a class="el" href="../../#l00082">Slic3r::SlicingParameters::soluble_interface</a>, <a class="el" href="../../#l00384">Slic3r::TreeSupport::SupportParams::support_density</a>, <a class="el" href="../../#l00370">Slic3r::TreeSupport::SupportParams::support_extrusion_width</a>, <a class="el" href="../../#l00400">support_style</a>, <a class="el" href="../../#l00399">support_type</a>, <a class="el" href="../../#l00041">Slic3r::ExPolygon::translate()</a>, <a class="el" href="../../#l00423">tree_support_branch_diameter_angle</a>, <a class="el" href="../../#l00426">with_infill</a>, and <a class="el" href="../../#l00389">Slic3r::TreeSupport::SupportParams::with_sheath</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_ad1a44839bbfd3668ab21ebf06d4e950c_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a140270a302619e88c9cb94cd3efb9c29" name="a140270a302619e88c9cb94cd3efb9c29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a140270a302619e88c9cb94cd3efb9c29">&#9670;&#160;</a></span>adjust_layer_heights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> Slic3r::TreeSupport::adjust_layer_heights </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>contact_nodes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3191</span>{</div>
<div class="line"><span class="lineno"> 3192</span>    <span class="keywordflow">if</span> (contact_nodes.empty())</div>
<div class="line"><span class="lineno"> 3193</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3194</span> </div>
<div class="line"><span class="lineno"> 3195</span>    <span class="keyword">const</span> PrintConfig&amp; print_config = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../d5/d8f/class_slic3r_1_1_print.html#af1937a680d19c7dd8d3c24e5ff7332b8">config</a>();</div>
<div class="line"><span class="lineno"> 3196</span>    <span class="keyword">const</span> <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#ad48b86fa8e529e56c6bd00ff2f9839ab">PrintObjectConfig</a>&amp; config = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#abde3ac4f19e1f9d342423a7643e17266">config</a>();</div>
<div class="line"><span class="lineno"> 3197</span>    <span class="comment">// don&#39;t merge layers for Vine support, or the branches will be unsmooth</span></div>
<div class="line"><span class="lineno"> 3198</span>    <span class="comment">// TODO can we merge layers in a way that guaranttees smoothness?</span></div>
<div class="line"><span class="lineno"> 3199</span>    <span class="keywordflow">if</span> (!print_config.independent_support_layer_height || <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8697e59f9029b0ce83867137111180e1">is_slim</a>) {</div>
<div class="line"><span class="lineno"> 3200</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = 0; layer_nr &lt; contact_nodes.size(); layer_nr++) {</div>
<div class="line"><span class="lineno"> 3201</span>            std::vector&lt;Node*&gt;&amp; curr_layer_nodes = contact_nodes[layer_nr];</div>
<div class="line"><span class="lineno"> 3202</span>            <span class="keywordflow">for</span> (Node* node : curr_layer_nodes) {</div>
<div class="line"><span class="lineno"> 3203</span>                node-&gt;print_z = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a8918ae15322de198ce6d0632feaac9b4">print_z</a>;</div>
<div class="line"><span class="lineno"> 3204</span>                node-&gt;height = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a37f53b1ef3b7fc3131f18845cd9c264a">height</a>;</div>
<div class="line"><span class="lineno"> 3205</span>            }</div>
<div class="line"><span class="lineno"> 3206</span>        }</div>
<div class="line"><span class="lineno"> 3207</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3208</span>    }</div>
<div class="line"><span class="lineno"> 3209</span> </div>
<div class="line"><span class="lineno"> 3210</span>    <span class="comment">// extreme layer_id</span></div>
<div class="line"><span class="lineno"> 3211</span>    std::vector&lt;int&gt; extremes;</div>
<div class="line"><span class="lineno"> 3212</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a> = config.layer_height.value;</div>
<div class="line"><span class="lineno"> 3213</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a19be622d0f5e34b67adb49c73cfaae53">max_layer_height</a> = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a015b5a46493742b5a3fe2094507ac411">max_layer_height</a>;</div>
<div class="line"><span class="lineno"> 3214</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> bot_intf_layers = config.support_interface_bottom_layers.value;</div>
<div class="line"><span class="lineno"> 3215</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> top_intf_layers = config.support_interface_top_layers.value;</div>
<div class="line"><span class="lineno"> 3216</span> </div>
<div class="line"><span class="lineno"> 3217</span>    <span class="comment">// if already using max layer height, no need to adjust</span></div>
<div class="line"><span class="lineno"> 3218</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a> == <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a19be622d0f5e34b67adb49c73cfaae53">max_layer_height</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3219</span> </div>
<div class="line"><span class="lineno"> 3220</span>    extremes.push_back(0);</div>
<div class="line"><span class="lineno"> 3221</span>    <span class="keywordflow">for</span> (Node* node : contact_nodes[0]) {</div>
<div class="line"><span class="lineno"> 3222</span>        node-&gt;print_z = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(0)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a8918ae15322de198ce6d0632feaac9b4">print_z</a>;</div>
<div class="line"><span class="lineno"> 3223</span>        node-&gt;height = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(0)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a37f53b1ef3b7fc3131f18845cd9c264a">height</a>;</div>
<div class="line"><span class="lineno"> 3224</span>    }</div>
<div class="line"><span class="lineno"> 3225</span> </div>
<div class="line"><span class="lineno"> 3226</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = 1; layer_nr &lt; contact_nodes.size(); layer_nr++) {</div>
<div class="line"><span class="lineno"> 3227</span>        std::vector&lt;Node*&gt;&amp; curr_layer_nodes = contact_nodes[layer_nr];</div>
<div class="line"><span class="lineno"> 3228</span>        <span class="keywordflow">for</span> (Node* node : curr_layer_nodes) {</div>
<div class="line"><span class="lineno"> 3229</span>            <span class="keywordflow">if</span> (node-&gt;support_roof_layers_below &gt;0 || node-&gt;support_floor_layers_above == bot_intf_layers) {</div>
<div class="line"><span class="lineno"> 3230</span>                extremes.push_back(layer_nr);</div>
<div class="line"><span class="lineno"> 3231</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3232</span>            }</div>
<div class="line"><span class="lineno"> 3233</span>        }</div>
<div class="line"><span class="lineno"> 3234</span> </div>
<div class="line"><span class="lineno"> 3235</span>        <span class="keywordflow">if</span> (extremes.back() == layer_nr) {</div>
<div class="line"><span class="lineno"> 3236</span>            <span class="comment">// contact layer use the same print_z and layer height with object layer</span></div>
<div class="line"><span class="lineno"> 3237</span>            <span class="keywordflow">for</span> (Node* node : curr_layer_nodes) {</div>
<div class="line"><span class="lineno"> 3238</span>                node-&gt;print_z = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a8918ae15322de198ce6d0632feaac9b4">print_z</a>;</div>
<div class="line"><span class="lineno"> 3239</span>                node-&gt;height = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a37f53b1ef3b7fc3131f18845cd9c264a">height</a>;</div>
<div class="line"><span class="lineno"> 3240</span>            }</div>
<div class="line"><span class="lineno"> 3241</span>        }</div>
<div class="line"><span class="lineno"> 3242</span>    }</div>
<div class="line"><span class="lineno"> 3243</span> </div>
<div class="line"><span class="lineno"> 3244</span>    <span class="comment">// schedule new layer heights and print_z</span></div>
<div class="line"><span class="lineno"> 3245</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> idx_extreme = 0; idx_extreme &lt; extremes.size(); idx_extreme++) {</div>
<div class="line"><span class="lineno"> 3246</span>        <span class="keywordtype">int</span> extr2_layer_nr = extremes[idx_extreme];</div>
<div class="line"><span class="lineno"> 3247</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> extr2z = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(extr2_layer_nr)-&gt;<a class="code hl_function" href="../../d1/d68/class_slic3r_1_1_layer.html#abdaf2fa25fbc0bc32cdcd71f53583845">bottom_z</a>();</div>
<div class="line"><span class="lineno"> 3248</span>        <span class="keywordtype">int</span> extr1_layer_nr = idx_extreme == 0 ? -1 : extremes[idx_extreme - 1];</div>
<div class="line"><span class="lineno"> 3249</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> extr1z = idx_extreme == 0 ? 0.f : <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(extr1_layer_nr)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a8918ae15322de198ce6d0632feaac9b4">print_z</a>;</div>
<div class="line"><span class="lineno"> 3250</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../d3/dfb/namespace_slic3r_1_1_geometry.html#a2b2112c1026a31e7c4c00693ca0bc2e2">dist</a> = extr2z - extr1z;</div>
<div class="line"><span class="lineno"> 3251</span> </div>
<div class="line"><span class="lineno"> 3252</span>        <span class="comment">// Insert intermediate layers.</span></div>
<div class="line"><span class="lineno"> 3253</span>        <span class="keywordtype">size_t</span> n_layers_extra = size_t(<a class="code hl_function" href="../../d4/df0/_array_cwise_unary_ops_8h.html#a63043b6807e8e10fb1adf4667e3664d2">ceil</a>(dist / <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#adcacd33d748550926fbff35daa13d8eb">max_suport_layer_height</a>));</div>
<div class="line"><span class="lineno"> 3254</span>        <span class="keywordflow">if</span> (n_layers_extra &lt;= 1)</div>
<div class="line"><span class="lineno"> 3255</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3256</span> </div>
<div class="line"><span class="lineno"> 3257</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a6ceea497872e0323516dbb68ef605a21">step</a> = <a class="code hl_function" href="../../d3/dfb/namespace_slic3r_1_1_geometry.html#a2b2112c1026a31e7c4c00693ca0bc2e2">dist</a> / <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a>(n_layers_extra);</div>
<div class="line"><span class="lineno"> 3258</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> print_z = extr1z + <a class="code hl_function" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a6ceea497872e0323516dbb68ef605a21">step</a>;</div>
<div class="line"><span class="lineno"> 3259</span>        assert(step &gt;= <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a> - <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>);</div>
<div class="line"><span class="lineno"> 3260</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = extr1_layer_nr + 1; layer_nr &lt; extr2_layer_nr; layer_nr++) {</div>
<div class="line"><span class="lineno"> 3261</span>            std::vector&lt;Node*&gt;&amp; curr_layer_nodes = contact_nodes[layer_nr];</div>
<div class="line"><span class="lineno"> 3262</span>            <span class="keywordflow">if</span> (curr_layer_nodes.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3263</span> </div>
<div class="line"><span class="lineno"> 3264</span>            <span class="keywordflow">if</span> (std::abs(print_z - curr_layer_nodes[0]-&gt;print_z) &lt; step / 2 + <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>) {</div>
<div class="line"><span class="lineno"> 3265</span>                <span class="keywordflow">for</span> (Node* node : curr_layer_nodes) {</div>
<div class="line"><span class="lineno"> 3266</span>                    node-&gt;print_z = print_z;</div>
<div class="line"><span class="lineno"> 3267</span>                    node-&gt;height = <a class="code hl_function" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a6ceea497872e0323516dbb68ef605a21">step</a>;</div>
<div class="line"><span class="lineno"> 3268</span>                }</div>
<div class="line"><span class="lineno"> 3269</span>                print_z += <a class="code hl_function" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a6ceea497872e0323516dbb68ef605a21">step</a>;</div>
<div class="line"><span class="lineno"> 3270</span>            }</div>
<div class="line"><span class="lineno"> 3271</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3272</span>                <span class="comment">// can&#39;t clear curr_layer_nodes, or the model will have empty layers</span></div>
<div class="line"><span class="lineno"> 3273</span>                <span class="keywordflow">for</span> (Node* node : curr_layer_nodes) {</div>
<div class="line"><span class="lineno"> 3274</span>                    node-&gt;print_z = 0.0;</div>
<div class="line"><span class="lineno"> 3275</span>                    node-&gt;height  = 0.0;</div>
<div class="line"><span class="lineno"> 3276</span>                }</div>
<div class="line"><span class="lineno"> 3277</span>            }</div>
<div class="line"><span class="lineno"> 3278</span>        }</div>
<div class="line"><span class="lineno"> 3279</span>    }</div>
<div class="line"><span class="lineno"> 3280</span>}</div>
<div class="ttc" id="a_array_cwise_unary_ops_8h_html_a63043b6807e8e10fb1adf4667e3664d2"><div class="ttname"><a href="../../d4/df0/_array_cwise_unary_ops_8h.html#a63043b6807e8e10fb1adf4667e3664d2">ceil</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC const CeilReturnType ceil() const</div><div class="ttdef"><b>Definition</b> ArrayCwiseUnaryOps.h:402</div></div>
<div class="ttc" id="aclass_slic3r_1_1_layer_html_a37f53b1ef3b7fc3131f18845cd9c264a"><div class="ttname"><a href="../../d1/d68/class_slic3r_1_1_layer.html#a37f53b1ef3b7fc3131f18845cd9c264a">Slic3r::Layer::height</a></div><div class="ttdeci">coordf_t height</div><div class="ttdef"><b>Definition</b> Layer.hpp:132</div></div>
<div class="ttc" id="aclass_slic3r_1_1_layer_html_a8918ae15322de198ce6d0632feaac9b4"><div class="ttname"><a href="../../d1/d68/class_slic3r_1_1_layer.html#a8918ae15322de198ce6d0632feaac9b4">Slic3r::Layer::print_z</a></div><div class="ttdeci">coordf_t print_z</div><div class="ttdef"><b>Definition</b> Layer.hpp:131</div></div>
<div class="ttc" id="aclass_slic3r_1_1_layer_html_abdaf2fa25fbc0bc32cdcd71f53583845"><div class="ttname"><a href="../../d1/d68/class_slic3r_1_1_layer.html#abdaf2fa25fbc0bc32cdcd71f53583845">Slic3r::Layer::bottom_z</a></div><div class="ttdeci">coordf_t bottom_z() const</div><div class="ttdef"><b>Definition</b> Layer.hpp:133</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_abde3ac4f19e1f9d342423a7643e17266"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#abde3ac4f19e1f9d342423a7643e17266">Slic3r::PrintObject::config</a></div><div class="ttdeci">const PrintObjectConfig &amp; config() const</div><div class="ttdef"><b>Definition</b> Print.hpp:299</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_aeb29a80908c06dd8644112f4cfff9354"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">Slic3r::PrintObject::get_layer</a></div><div class="ttdeci">const Layer * get_layer(int idx) const</div><div class="ttdef"><b>Definition</b> Print.hpp:355</div></div>
<div class="ttc" id="alibslic3r_8h_html_a75f355966e0a97665eaf5a4c79baa7af"><div class="ttname"><a href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a></div><div class="ttdeci">static constexpr double EPSILON</div><div class="ttdef"><b>Definition</b> libslic3r.h:52</div></div>
<div class="ttc" id="anamespace_slic3r_1_1_geometry_html_a2b2112c1026a31e7c4c00693ca0bc2e2"><div class="ttname"><a href="../../d3/dfb/namespace_slic3r_1_1_geometry.html#a2b2112c1026a31e7c4c00693ca0bc2e2">Slic3r::Geometry::dist</a></div><div class="ttdeci">T dist(const boost::polygon::point_data&lt; T &gt; &amp;p1, const boost::polygon::point_data&lt; T &gt; &amp;p2)</div><div class="ttdef"><b>Definition</b> Geometry.cpp:287</div></div>
<div class="ttc" id="anamespace_slic3r_html_a19be622d0f5e34b67adb49c73cfaae53"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a19be622d0f5e34b67adb49c73cfaae53">Slic3r::max_layer_height</a></div><div class="ttdeci">machine_min_extruding_rate max_layer_height((ConfigOptionInts, fan_min_speed))((ConfigOptionFloats</div></div>
<div class="ttc" id="anamespace_slic3r_html_a2ac5c755948c74f5f5f975acd5057fe9"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">Slic3r::coordf_t</a></div><div class="ttdeci">double coordf_t</div><div class="ttdef"><b>Definition</b> GUI_ObjectList.hpp:36</div></div>
<div class="ttc" id="anamespace_slic3r_html_a3fc0fbbcb45d8a2fef27e26e1289ec21"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">Slic3r::layer_height</a></div><div class="ttdeci">layer_height((ConfigOptionInt, faded_layers))((ConfigOptionFloat</div></div>
<div class="ttc" id="anamespace_slic3r_html_ad48b86fa8e529e56c6bd00ff2f9839ab"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#ad48b86fa8e529e56c6bd00ff2f9839ab">Slic3r::PrintObjectConfig</a></div><div class="ttdeci">machine_min_extruding_rate PrintObjectConfig</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:1047</div></div>
<div class="ttc" id="anamespacemarchsq_1_1____impl_html_a6ceea497872e0323516dbb68ef605a21"><div class="ttname"><a href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a6ceea497872e0323516dbb68ef605a21">marchsq::__impl::step</a></div><div class="ttdeci">Coord step(const Coord &amp;crd, Dir d)</div><div class="ttdef"><b>Definition</b> MarchingSquares.hpp:137</div></div>
<div class="ttc" id="astruct_slic3r_1_1_slicing_parameters_html_a015b5a46493742b5a3fe2094507ac411"><div class="ttname"><a href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a015b5a46493742b5a3fe2094507ac411">Slic3r::SlicingParameters::max_layer_height</a></div><div class="ttdeci">coordf_t max_layer_height</div><div class="ttdef"><b>Definition</b> Slicing.hpp:65</div></div>
<div class="ttc" id="astruct_slic3r_1_1_slicing_parameters_html_adcacd33d748550926fbff35daa13d8eb"><div class="ttname"><a href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#adcacd33d748550926fbff35daa13d8eb">Slic3r::SlicingParameters::max_suport_layer_height</a></div><div class="ttdeci">coordf_t max_suport_layer_height</div><div class="ttdef"><b>Definition</b> Slicing.hpp:66</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00402">ceil()</a>, <a class="el" href="../../#l00052">EPSILON</a>, <a class="el" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">Slic3r::layer_height()</a>, <a class="el" href="../../de/db8/namespace_slic3r.html#a19be622d0f5e34b67adb49c73cfaae53">Slic3r::max_layer_height()</a>, and <a class="el" href="../../#l01047">Slic3r::PrintObjectConfig</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_a140270a302619e88c9cb94cd3efb9c29_cgraph.svg" width="372" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a9702a9816a666dc7e2042d74658ef859" name="a9702a9816a666dc7e2042d74658ef859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9702a9816a666dc7e2042d74658ef859">&#9670;&#160;</a></span>calc_branch_radius() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a> Slic3r::TreeSupport::calc_branch_radius </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a>&#160;</td>
          <td class="paramname"><em>base_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a>&#160;</td>
          <td class="paramname"><em>mm_to_top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>diameter_angle_scale_factor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1963</span>{</div>
<div class="line"><span class="lineno"> 1964</span>    <span class="keywordtype">double</span> radius;</div>
<div class="line"><span class="lineno"> 1965</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> tip_height = base_radius;<span class="comment">// this is a 45 degree tip</span></div>
<div class="line"><span class="lineno"> 1966</span>    <span class="keywordflow">if</span> (mm_to_top &gt; tip_height)</div>
<div class="line"><span class="lineno"> 1967</span>    {</div>
<div class="line"><span class="lineno"> 1968</span>        radius = base_radius + (mm_to_top-tip_height) * diameter_angle_scale_factor;</div>
<div class="line"><span class="lineno"> 1969</span>    }</div>
<div class="line"><span class="lineno"> 1970</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1971</span>    {</div>
<div class="line"><span class="lineno"> 1972</span>        radius = mm_to_top;<span class="comment">// this is a 45 degree tip</span></div>
<div class="line"><span class="lineno"> 1973</span>    }</div>
<div class="line"><span class="lineno"> 1974</span> </div>
<div class="line"><span class="lineno"> 1975</span>    radius = std::max(radius, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8a49148abbffe316cb0548cbc48d0603">MIN_BRANCH_RADIUS</a>);</div>
<div class="line"><span class="lineno"> 1976</span>    radius = std::min(radius, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a161d05526fd75928c2dc1d04e4c0c49a">MAX_BRANCH_RADIUS</a>);</div>
<div class="line"><span class="lineno"> 1977</span>    <span class="comment">// if have interface layers, radius should be larger</span></div>
<div class="line"><span class="lineno"> 1978</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;support_interface_top_layers.value &gt; 0)</div>
<div class="line"><span class="lineno"> 1979</span>        radius = std::max(radius, base_radius);</div>
<div class="line"><span class="lineno"> 1980</span>    <span class="keywordflow">return</span> radius;</div>
<div class="line"><span class="lineno"> 1981</span>}</div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a8a49148abbffe316cb0548cbc48d0603"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8a49148abbffe316cb0548cbc48d0603">Slic3r::TreeSupport::MIN_BRANCH_RADIUS</a></div><div class="ttdeci">coordf_t MIN_BRANCH_RADIUS</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:422</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b7aa7b2d91917c6952d77796d4584c2" name="a5b7aa7b2d91917c6952d77796d4584c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b7aa7b2d91917c6952d77796d4584c2">&#9670;&#160;</a></span>calc_branch_radius() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a> Slic3r::TreeSupport::calc_branch_radius </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a>&#160;</td>
          <td class="paramname"><em>base_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>layers_to_top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>tip_layers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>diameter_angle_scale_factor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1942</span>{</div>
<div class="line"><span class="lineno"> 1943</span>    <span class="keywordtype">double</span> radius;</div>
<div class="line"><span class="lineno"> 1944</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8697e59f9029b0ce83867137111180e1">is_slim</a>) {</div>
<div class="line"><span class="lineno"> 1945</span>        <span class="keywordflow">if</span> ((layers_to_top + 1) &gt; tip_layers) {</div>
<div class="line"><span class="lineno"> 1946</span>            radius = base_radius + base_radius * (layers_to_top + 1) * diameter_angle_scale_factor;</div>
<div class="line"><span class="lineno"> 1947</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1948</span>            radius = base_radius * (layers_to_top + 1) / tip_layers;</div>
<div class="line"><span class="lineno"> 1949</span>        }</div>
<div class="line"><span class="lineno"> 1950</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1951</span>        <span class="keywordflow">if</span> ((layers_to_top + 1) &gt; tip_layers * 2) {</div>
<div class="line"><span class="lineno"> 1952</span>            radius = base_radius + base_radius * (layers_to_top + 1) * diameter_angle_scale_factor;</div>
<div class="line"><span class="lineno"> 1953</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1954</span>            radius = base_radius * (layers_to_top + 1) / (tip_layers * 2);</div>
<div class="line"><span class="lineno"> 1955</span>        }</div>
<div class="line"><span class="lineno"> 1956</span>        radius = std::max(radius, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8a49148abbffe316cb0548cbc48d0603">MIN_BRANCH_RADIUS</a>);</div>
<div class="line"><span class="lineno"> 1957</span>    }</div>
<div class="line"><span class="lineno"> 1958</span>    radius = std::min(radius, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a161d05526fd75928c2dc1d04e4c0c49a">MAX_BRANCH_RADIUS</a>);</div>
<div class="line"><span class="lineno"> 1959</span>    <span class="keywordflow">return</span> radius;</div>
<div class="line"><span class="lineno"> 1960</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9042303103f55d74a7f2d7625fec94ea" name="a9042303103f55d74a7f2d7625fec94ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9042303103f55d74a7f2d7625fec94ea">&#9670;&#160;</a></span>contact_nodes_to_polygon()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a> Slic3r::TreeSupport::contact_nodes_to_polygon </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>contact_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a>&#160;</td>
          <td class="paramname"><em>layer_contours</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d38/lzoconf_8h.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>layer_nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>radiis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; bool &gt; &amp;&#160;</td>
          <td class="paramname"><em>is_interface</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1751</span>{</div>
<div class="line"><span class="lineno"> 1752</span>    <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a> polys;</div>
<div class="line"><span class="lineno"> 1753</span>    std::vector&lt;MinimumSpanningTree&gt; spanning_trees;</div>
<div class="line"><span class="lineno"> 1754</span>    std::vector&lt;double&gt; radiis_mtree;</div>
<div class="line"><span class="lineno"> 1755</span>    std::vector&lt;bool&gt; is_interface_mtree;</div>
<div class="line"><span class="lineno"> 1756</span>    <span class="comment">// generate minimum spanning trees</span></div>
<div class="line"><span class="lineno"> 1757</span>    {</div>
<div class="line"><span class="lineno"> 1758</span>        std::map&lt;Node*, bool&gt; visited;</div>
<div class="line"><span class="lineno"> 1759</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; contact_nodes.size(); i++)</div>
<div class="line"><span class="lineno"> 1760</span>            visited.emplace(contact_nodes[i], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1761</span>        std::unordered_set&lt;Line, LineHash&gt; to_ignore;</div>
<div class="line"><span class="lineno"> 1762</span> </div>
<div class="line"><span class="lineno"> 1763</span>        <span class="comment">// generate minimum spaning trees</span></div>
<div class="line"><span class="lineno"> 1764</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; contact_nodes.size(); i++) {</div>
<div class="line"><span class="lineno"> 1765</span>            Node* node = contact_nodes[i];</div>
<div class="line"><span class="lineno"> 1766</span>            <span class="keywordflow">if</span> (visited[node])</div>
<div class="line"><span class="lineno"> 1767</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1768</span> </div>
<div class="line"><span class="lineno"> 1769</span>            std::vector&lt;Point&gt; points_to_mstree;</div>
<div class="line"><span class="lineno"> 1770</span>            <span class="keywordtype">double</span> radius = 0;</div>
<div class="line"><span class="lineno"> 1771</span>            <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> pt1 = node-&gt;position;</div>
<div class="line"><span class="lineno"> 1772</span>            points_to_mstree.push_back(pt1);</div>
<div class="line"><span class="lineno"> 1773</span>            visited[node] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1774</span>            radius += node-&gt;radius;</div>
<div class="line"><span class="lineno"> 1775</span> </div>
<div class="line"><span class="lineno"> 1776</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = i + 1; j &lt; contact_nodes.size(); j++) {</div>
<div class="line"><span class="lineno"> 1777</span>                Node* node2 = contact_nodes[j];</div>
<div class="line"><span class="lineno"> 1778</span>                <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> pt2 = node2-&gt;position;</div>
<div class="line"><span class="lineno"> 1779</span>                <span class="comment">// connect to this neighbor if:</span></div>
<div class="line"><span class="lineno"> 1780</span>                <span class="comment">// 1) both are interface or both are not</span></div>
<div class="line"><span class="lineno"> 1781</span>                <span class="comment">// 3) not readly added</span></div>
<div class="line"><span class="lineno"> 1782</span>                <span class="comment">// 4) won&#39;t cross perimeters: this is not right since we need to check all possible connections</span></div>
<div class="line"><span class="lineno"> 1783</span>                <span class="keywordflow">if</span> ((node-&gt;support_roof_layers_below &gt; 0) == (node2-&gt;support_roof_layers_below &gt; 0)</div>
<div class="line"><span class="lineno"> 1784</span>                    &amp;&amp; to_ignore.find(Line(pt1, pt2)) == to_ignore.end())</div>
<div class="line"><span class="lineno"> 1785</span>                {</div>
<div class="line"><span class="lineno"> 1786</span>                    points_to_mstree.emplace_back(pt2);</div>
<div class="line"><span class="lineno"> 1787</span>                    visited[node2] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1788</span>                    radius += node2-&gt;radius;</div>
<div class="line"><span class="lineno"> 1789</span>                }</div>
<div class="line"><span class="lineno"> 1790</span>            }</div>
<div class="line"><span class="lineno"> 1791</span> </div>
<div class="line"><span class="lineno"> 1792</span>            spanning_trees.emplace_back(points_to_mstree);</div>
<div class="line"><span class="lineno"> 1793</span>            radiis_mtree.push_back(radius / points_to_mstree.size());</div>
<div class="line"><span class="lineno"> 1794</span>            is_interface_mtree.push_back(node-&gt;support_roof_layers_below &gt; 0);</div>
<div class="line"><span class="lineno"> 1795</span>        }</div>
<div class="line"><span class="lineno"> 1796</span>    }</div>
<div class="line"><span class="lineno"> 1797</span>    <span class="keyword">auto</span> lines = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#abdff69392c13e5d55c55528446030bf8">spanning_tree_to_lines</a>(spanning_trees);</div>
<div class="line"><span class="lineno"> 1798</span><span class="preprocessor">#if 1</span></div>
<div class="line"><span class="lineno"> 1799</span>    <span class="comment">// convert mtree to polygon</span></div>
<div class="line"><span class="lineno"> 1800</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; spanning_trees.size(); k++) {</div>
<div class="line"><span class="lineno"> 1801</span>        <span class="keyword">auto</span>&amp; mst_line_x_layer_contour_cache = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa16cc2e23a002f4f13f5f28ae12afbf4">m_mst_line_x_layer_contour_caches</a>[layer_nr];</div>
<div class="line"><span class="lineno"> 1802</span>        MinimumSpanningTree mst = spanning_trees[k];</div>
<div class="line"><span class="lineno"> 1803</span>        std::vector&lt;Point&gt; points = mst.vertices();</div>
<div class="line"><span class="lineno"> 1804</span>        std::map&lt;Point, bool&gt; visited;</div>
<div class="line"><span class="lineno"> 1805</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; points.size(); i++)</div>
<div class="line"><span class="lineno"> 1806</span>            visited.emplace(points[i], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1807</span> </div>
<div class="line"><span class="lineno"> 1808</span>        std::unordered_set&lt;Line, LineHash&gt; to_ignore;</div>
<div class="line"><span class="lineno"> 1809</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; points.size(); i++) {</div>
<div class="line"><span class="lineno"> 1810</span>            <span class="keywordflow">if</span> (visited[points[i]])</div>
<div class="line"><span class="lineno"> 1811</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1812</span> </div>
<div class="line"><span class="lineno"> 1813</span>            <a class="code hl_enumvalue" href="../../d5/dd8/namespace_clipper2_lib.html#ae11c4d64b0c006fdcb85278a8d4a414ea4c0a11247d92f73fb84baa51e37a3263">Polygon</a> poly;</div>
<div class="line"><span class="lineno"> 1814</span>            <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> pt1 = points[i];</div>
<div class="line"><span class="lineno"> 1815</span>            poly.points.push_back(pt1);</div>
<div class="line"><span class="lineno"> 1816</span>            visited[pt1] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1817</span> </div>
<div class="line"><span class="lineno"> 1818</span>            <span class="keywordtype">bool</span> has_next = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1819</span>            <span class="keywordflow">while</span> (has_next)</div>
<div class="line"><span class="lineno"> 1820</span>            {</div>
<div class="line"><span class="lineno"> 1821</span>                <span class="keyword">const</span> std::vector&lt;Point&gt;&amp; neighbours = mst.adjacent_nodes(pt1);</div>
<div class="line"><span class="lineno"> 1822</span>                <span class="keywordtype">double</span> min_ccw = -std::numeric_limits&lt;double&gt;::max();</div>
<div class="line"><span class="lineno"> 1823</span>                <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> pt_selected;</div>
<div class="line"><span class="lineno"> 1824</span>                has_next = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1825</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> pt2 : neighbours) {</div>
<div class="line"><span class="lineno"> 1826</span>                    <span class="keywordflow">if</span> (to_ignore.find(Line(pt1, pt2)) == to_ignore.end()) {</div>
<div class="line"><span class="lineno"> 1827</span>                        <span class="keyword">auto</span> iter = mst_line_x_layer_contour_cache.find({ pt1,pt2 });</div>
<div class="line"><span class="lineno"> 1828</span>                        <span class="keywordflow">if</span> (iter != mst_line_x_layer_contour_cache.end()) {</div>
<div class="line"><span class="lineno"> 1829</span>                            <span class="keywordflow">if</span> (iter-&gt;second)</div>
<div class="line"><span class="lineno"> 1830</span>                                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1831</span>                        }</div>
<div class="line"><span class="lineno"> 1832</span>                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1833</span>                            <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a498065f79ccb865fc410d4afeacffc9c">Polylines</a> pls;</div>
<div class="line"><span class="lineno"> 1834</span>                            pls.emplace_back(pt1, pt2);</div>
<div class="line"><span class="lineno"> 1835</span>                            <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a498065f79ccb865fc410d4afeacffc9c">Polylines</a> pls_intersect = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#acebc3af95608afde6afc3aae65d00bd0">intersection_pl</a>(pls, layer_contours);</div>
<div class="line"><span class="lineno"> 1836</span>                            mst_line_x_layer_contour_cache.insert({ {pt1, pt2}, !pls_intersect.empty() });</div>
<div class="line"><span class="lineno"> 1837</span>                            mst_line_x_layer_contour_cache.insert({ {pt2, pt1}, !pls_intersect.empty() });</div>
<div class="line"><span class="lineno"> 1838</span>                            <span class="keywordflow">if</span> (!pls_intersect.empty())</div>
<div class="line"><span class="lineno"> 1839</span>                                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1840</span>                        }</div>
<div class="line"><span class="lineno"> 1841</span>                        <span class="keywordflow">if</span> (poly.points.size() &lt; 2)</div>
<div class="line"><span class="lineno"> 1842</span>                        {</div>
<div class="line"><span class="lineno"> 1843</span>                            pt_selected = pt2;</div>
<div class="line"><span class="lineno"> 1844</span>                            has_next = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1845</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1846</span>                        }</div>
<div class="line"><span class="lineno"> 1847</span>                        <span class="keywordtype">double</span> curr_ccw = pt2.ccw(pt1, poly.points.rbegin()[1]);</div>
<div class="line"><span class="lineno"> 1848</span>                        <span class="keywordflow">if</span> (curr_ccw &gt; min_ccw)</div>
<div class="line"><span class="lineno"> 1849</span>                        {</div>
<div class="line"><span class="lineno"> 1850</span>                            has_next = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1851</span>                            min_ccw = curr_ccw;</div>
<div class="line"><span class="lineno"> 1852</span>                            pt_selected = pt2;</div>
<div class="line"><span class="lineno"> 1853</span>                        }</div>
<div class="line"><span class="lineno"> 1854</span>                    }</div>
<div class="line"><span class="lineno"> 1855</span>                }</div>
<div class="line"><span class="lineno"> 1856</span>                <span class="keywordflow">if</span> (!has_next)</div>
<div class="line"><span class="lineno"> 1857</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1858</span> </div>
<div class="line"><span class="lineno"> 1859</span>                poly.points.push_back(pt_selected);</div>
<div class="line"><span class="lineno"> 1860</span>                to_ignore.insert(Line(pt1, pt_selected));</div>
<div class="line"><span class="lineno"> 1861</span>                visited[pt_selected] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1862</span>                pt1 = pt_selected;</div>
<div class="line"><span class="lineno"> 1863</span>            }</div>
<div class="line"><span class="lineno"> 1864</span>            polys.emplace_back(std::move(poly));</div>
<div class="line"><span class="lineno"> 1865</span>            radiis.push_back(radiis_mtree[k]);</div>
<div class="line"><span class="lineno"> 1866</span>            is_interface.push_back(is_interface_mtree[k]);</div>
<div class="line"><span class="lineno"> 1867</span>        }</div>
<div class="line"><span class="lineno"> 1868</span>    }</div>
<div class="line"><span class="lineno"> 1869</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1870</span>    polys = <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a02203b50af22328f55e5eb988d665553">spanning_tree_to_polygon</a>(spanning_trees, layer_contours, layer_nr, radiis);</div>
<div class="line"><span class="lineno"> 1871</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1872</span>    <span class="keywordflow">return</span> polys;</div>
<div class="line"><span class="lineno"> 1873</span>}</div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a02203b50af22328f55e5eb988d665553"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a02203b50af22328f55e5eb988d665553">Slic3r::TreeSupport::spanning_tree_to_polygon</a></div><div class="ttdeci">Polygons spanning_tree_to_polygon(const std::vector&lt; MinimumSpanningTree &gt; &amp;spanning_trees, Polygons layer_contours, int layer_nr)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:1672</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_aa16cc2e23a002f4f13f5f28ae12afbf4"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa16cc2e23a002f4f13f5f28ae12afbf4">Slic3r::TreeSupport::m_mst_line_x_layer_contour_caches</a></div><div class="ttdeci">std::vector&lt; std::unordered_map&lt; Line, bool, LineHash &gt; &gt; m_mst_line_x_layer_contour_caches</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:420</div></div>
<div class="ttc" id="anamespace_clipper2_lib_html_ae11c4d64b0c006fdcb85278a8d4a414ea4c0a11247d92f73fb84baa51e37a3263"><div class="ttname"><a href="../../d5/dd8/namespace_clipper2_lib.html#ae11c4d64b0c006fdcb85278a8d4a414ea4c0a11247d92f73fb84baa51e37a3263">Clipper2Lib::EndType::Polygon</a></div><div class="ttdeci">@ Polygon</div></div>
<div class="ttc" id="anamespace_slic3r_html_a498065f79ccb865fc410d4afeacffc9c"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a498065f79ccb865fc410d4afeacffc9c">Slic3r::Polylines</a></div><div class="ttdeci">std::vector&lt; Polyline &gt; Polylines</div><div class="ttdef"><b>Definition</b> Polyline.hpp:16</div></div>
<div class="ttc" id="anamespace_slic3r_html_abdff69392c13e5d55c55528446030bf8"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#abdff69392c13e5d55c55528446030bf8">Slic3r::spanning_tree_to_lines</a></div><div class="ttdeci">Lines spanning_tree_to_lines(const std::vector&lt; MinimumSpanningTree &gt; &amp;spanning_trees)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:152</div></div>
<div class="ttc" id="anamespace_slic3r_html_acebc3af95608afde6afc3aae65d00bd0"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#acebc3af95608afde6afc3aae65d00bd0">Slic3r::intersection_pl</a></div><div class="ttdeci">Slic3r::Polylines intersection_pl(const Slic3r::Polylines &amp;subject, const Slic3r::Polygon &amp;clip)</div><div class="ttdef"><b>Definition</b> ClipperUtils.cpp:877</div></div>
<div class="ttc" id="anamespace_slic3r_html_ae39547681b4c9f15f0d44712cdb01d6a"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Slic3r::Polygons</a></div><div class="ttdeci">std::vector&lt; Polygon &gt; Polygons</div><div class="ttdef"><b>Definition</b> Polygon.hpp:14</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00101">Slic3r::MinimumSpanningTree::adjacent_nodes()</a>, <a class="el" href="../../#l00118">Slic3r::Point::ccw()</a>, <a class="el" href="../../#l00877">Slic3r::intersection_pl()</a>, <a class="el" href="../../#l00018">Slic3r::MultiPoint::points</a>, <a class="el" href="../../#l00297">Slic3r::TreeSupport::Node::position</a>, <a class="el" href="../../#l00299">Slic3r::TreeSupport::Node::radius</a>, <a class="el" href="../../#l00152">Slic3r::spanning_tree_to_lines()</a>, <a class="el" href="../../#l00323">Slic3r::TreeSupport::Node::support_roof_layers_below</a>, and <a class="el" href="../../#l00127">Slic3r::MinimumSpanningTree::vertices()</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_a9042303103f55d74a7f2d7625fec94ea_cgraph.svg" width="100%" height="511"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ab5a8e24116c706a5471484c8ec730ad5" name="ab5a8e24116c706a5471484c8ec730ad5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5a8e24116c706a5471484c8ec730ad5">&#9670;&#160;</a></span>create_tree_support_layers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> Slic3r::TreeSupport::create_tree_support_layers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1186</span>{</div>
<div class="line"><span class="lineno"> 1187</span>    <span class="keywordtype">int</span> layer_id = 0;</div>
<div class="line"><span class="lineno"> 1188</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> raft_print_z = 0.f;</div>
<div class="line"><span class="lineno"> 1189</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> raft_slice_z = 0.f;</div>
<div class="line"><span class="lineno"> 1190</span>    <span class="keywordflow">for</span> (; layer_id &lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a2aa68d58cabcb7cea93686d1cd08c022">base_raft_layers</a>; layer_id++) {</div>
<div class="line"><span class="lineno"> 1191</span>        raft_print_z += <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a3b602295c5e23f6193a9769b41e193ca">base_raft_layer_height</a>;</div>
<div class="line"><span class="lineno"> 1192</span>        raft_slice_z = raft_print_z - <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a3b602295c5e23f6193a9769b41e193ca">base_raft_layer_height</a> / 2;</div>
<div class="line"><span class="lineno"> 1193</span>        <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a41b1d84364e4e45cad719131b45b80fa">add_tree_support_layer</a>(layer_id, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a3b602295c5e23f6193a9769b41e193ca">base_raft_layer_height</a>, raft_print_z, raft_slice_z);</div>
<div class="line"><span class="lineno"> 1194</span>    }</div>
<div class="line"><span class="lineno"> 1195</span> </div>
<div class="line"><span class="lineno"> 1196</span>    <span class="keywordflow">for</span> (; layer_id &lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a2aa68d58cabcb7cea93686d1cd08c022">base_raft_layers</a> + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#ae6cca9e93ef7f659e4e8be919ff1342f">interface_raft_layers</a>; layer_id++) {</div>
<div class="line"><span class="lineno"> 1197</span>        raft_print_z += <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a32988256e6f98aeb1672e3739003d24c">interface_raft_layer_height</a>;</div>
<div class="line"><span class="lineno"> 1198</span>        raft_slice_z = raft_print_z - <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a32988256e6f98aeb1672e3739003d24c">interface_raft_layer_height</a> / 2;</div>
<div class="line"><span class="lineno"> 1199</span>        <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a41b1d84364e4e45cad719131b45b80fa">add_tree_support_layer</a>(layer_id, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a3b602295c5e23f6193a9769b41e193ca">base_raft_layer_height</a>, raft_print_z, raft_slice_z);</div>
<div class="line"><span class="lineno"> 1200</span>    }</div>
<div class="line"><span class="lineno"> 1201</span> </div>
<div class="line"><span class="lineno"> 1202</span>    <span class="keywordflow">for</span> (Layer *layer : <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;layers()) {</div>
<div class="line"><span class="lineno"> 1203</span>        SupportLayer* ts_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a41b1d84364e4e45cad719131b45b80fa">add_tree_support_layer</a>(layer-&gt;id(), layer-&gt;height, layer-&gt;print_z, layer-&gt;slice_z);</div>
<div class="line"><span class="lineno"> 1204</span>        <span class="keywordflow">if</span> (ts_layer-&gt;id() &gt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>) {</div>
<div class="line"><span class="lineno"> 1205</span>            SupportLayer* lower_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(ts_layer-&gt;id() - 1);</div>
<div class="line"><span class="lineno"> 1206</span>            lower_layer-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a01c730472baa33af9e8a95fd24591be7">upper_layer</a> = ts_layer;</div>
<div class="line"><span class="lineno"> 1207</span>            ts_layer-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#aff84b8f549804babf9ecaee1a49e260e">lower_layer</a> = lower_layer;</div>
<div class="line"><span class="lineno"> 1208</span>        }</div>
<div class="line"><span class="lineno"> 1209</span>    }</div>
<div class="line"><span class="lineno"> 1210</span>}</div>
<div class="ttc" id="aclass_slic3r_1_1_layer_html_a01c730472baa33af9e8a95fd24591be7"><div class="ttname"><a href="../../d1/d68/class_slic3r_1_1_layer.html#a01c730472baa33af9e8a95fd24591be7">Slic3r::Layer::upper_layer</a></div><div class="ttdeci">Layer * upper_layer</div><div class="ttdef"><b>Definition</b> Layer.hpp:127</div></div>
<div class="ttc" id="aclass_slic3r_1_1_layer_html_aff84b8f549804babf9ecaee1a49e260e"><div class="ttname"><a href="../../d1/d68/class_slic3r_1_1_layer.html#aff84b8f549804babf9ecaee1a49e260e">Slic3r::Layer::lower_layer</a></div><div class="ttdeci">Layer * lower_layer</div><div class="ttdef"><b>Definition</b> Layer.hpp:128</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_a41b1d84364e4e45cad719131b45b80fa"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#a41b1d84364e4e45cad719131b45b80fa">Slic3r::PrintObject::add_tree_support_layer</a></div><div class="ttdeci">SupportLayer * add_tree_support_layer(int id, coordf_t height, coordf_t print_z, coordf_t slice_z)</div><div class="ttdef"><b>Definition</b> PrintObject.cpp:665</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_a82f39ab79ee6822bab0b43c89fa7a3ff"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">Slic3r::PrintObject::get_support_layer</a></div><div class="ttdeci">SupportLayer * get_support_layer(int idx)</div><div class="ttdef"><b>Definition</b> Print.hpp:381</div></div>
<div class="ttc" id="astruct_slic3r_1_1_slicing_parameters_html_a2aa68d58cabcb7cea93686d1cd08c022"><div class="ttname"><a href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a2aa68d58cabcb7cea93686d1cd08c022">Slic3r::SlicingParameters::base_raft_layers</a></div><div class="ttdeci">size_t base_raft_layers</div><div class="ttdef"><b>Definition</b> Slicing.hpp:50</div></div>
<div class="ttc" id="astruct_slic3r_1_1_slicing_parameters_html_a32988256e6f98aeb1672e3739003d24c"><div class="ttname"><a href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a32988256e6f98aeb1672e3739003d24c">Slic3r::SlicingParameters::interface_raft_layer_height</a></div><div class="ttdeci">coordf_t interface_raft_layer_height</div><div class="ttdef"><b>Definition</b> Slicing.hpp:56</div></div>
<div class="ttc" id="astruct_slic3r_1_1_slicing_parameters_html_a3b602295c5e23f6193a9769b41e193ca"><div class="ttname"><a href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a3b602295c5e23f6193a9769b41e193ca">Slic3r::SlicingParameters::base_raft_layer_height</a></div><div class="ttdeci">coordf_t base_raft_layer_height</div><div class="ttdef"><b>Definition</b> Slicing.hpp:55</div></div>
<div class="ttc" id="astruct_slic3r_1_1_slicing_parameters_html_ae6cca9e93ef7f659e4e8be919ff1342f"><div class="ttname"><a href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#ae6cca9e93ef7f659e4e8be919ff1342f">Slic3r::SlicingParameters::interface_raft_layers</a></div><div class="ttdeci">size_t interface_raft_layers</div><div class="ttdef"><b>Definition</b> Slicing.hpp:52</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00122">Slic3r::Layer::id()</a>, <a class="el" href="../../#l00128">Slic3r::Layer::lower_layer</a>, and <a class="el" href="../../#l00127">Slic3r::Layer::upper_layer</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../#l00715">detect_overhangs()</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_ab5a8e24116c706a5471484c8ec730ad5_cgraph.svg" width="316" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_ab5a8e24116c706a5471484c8ec730ad5_icgraph.svg" width="336" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="abee402a4a54cce95519d410554b75444" name="abee402a4a54cce95519d410554b75444"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abee402a4a54cce95519d410554b75444">&#9670;&#160;</a></span>detect_overhangs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> Slic3r::TreeSupport::detect_overhangs </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>detect_first_sharp_tail_only</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  716</span>{</div>
<div class="line"><span class="lineno">  717</span>    <span class="comment">// overhangs are already detected</span></div>
<div class="line"><span class="lineno">  718</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#ad77e3d2fb551f8261f9298335a9a0ec5">support_layer_count</a>() &gt;= <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aea3e7f3fc4b46b4290105f655edcde47">layer_count</a>())</div>
<div class="line"><span class="lineno">  719</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>    <span class="comment">// Clear and create Tree Support Layers</span></div>
<div class="line"><span class="lineno">  722</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a5e5ccd90a04666a6a9525279b49c1908">clear_support_layers</a>();</div>
<div class="line"><span class="lineno">  723</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a714cf0166f39d8a016073e91affeeb54">clear_tree_support_preview_cache</a>();</div>
<div class="line"><span class="lineno">  724</span>    <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ab5a8e24116c706a5471484c8ec730ad5">create_tree_support_layers</a>();</div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span>    <span class="keyword">const</span> <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#ad48b86fa8e529e56c6bd00ff2f9839ab">PrintObjectConfig</a>&amp; config = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#abde3ac4f19e1f9d342423a7643e17266">config</a>();</div>
<div class="line"><span class="lineno">  727</span>    <a class="code hl_enumeration" href="../../de/db8/namespace_slic3r.html#aaaabcf9acc53536eede4610d1218434c">SupportType</a> stype = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a2dde09f186446f7f085b60e1a1ea3df3">support_type</a>;</div>
<div class="line"><span class="lineno">  728</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> radius_sample_resolution = <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a5fbcba443134401cfa23255d3ce72cad">g_config_tree_support_collision_resolution</a>;</div>
<div class="line"><span class="lineno">  729</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> nozzle_diameter = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../d5/d8f/class_slic3r_1_1_print.html#af1937a680d19c7dd8d3c24e5ff7332b8">config</a>().nozzle_diameter.get_at(0);</div>
<div class="line"><span class="lineno">  730</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> extrusion_width = config.get_abs_value(<span class="stringliteral">&quot;line_width&quot;</span>, nozzle_diameter);</div>
<div class="line"><span class="lineno">  731</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> extrusion_width_scaled = <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(extrusion_width);</div>
<div class="line"><span class="lineno">  732</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> max_bridge_length = <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(config.max_bridge_length.value);</div>
<div class="line"><span class="lineno">  733</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> bridge_no_support = max_bridge_length &gt; 0;</div>
<div class="line"><span class="lineno">  734</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> support_critical_regions_only = config.support_critical_regions_only.value;</div>
<div class="line"><span class="lineno">  735</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> config_remove_small_overhangs = config.support_remove_small_overhang.value;</div>
<div class="line"><span class="lineno">  736</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> enforce_support_layers = config.enforce_support_layers.value;</div>
<div class="line"><span class="lineno">  737</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a15f6728115269978cc5e0a44c22479a8">area_thresh_well_supported</a> = <a class="code hl_define" href="../../db/d7c/_orient_8cpp.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(<a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(6));</div>
<div class="line"><span class="lineno">  738</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a509efc840b8460ee975221330ef6d82f">length_thresh_well_supported</a> = <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(6);</div>
<div class="line"><span class="lineno">  739</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a852e19ab281b44709b3c5a3779c9c4cf">sharp_tail_max_support_height</a> = 16.f;</div>
<div class="line"><span class="lineno">  740</span>    <span class="comment">// a region is considered well supported if the number of layers below it exceeds this threshold</span></div>
<div class="line"><span class="lineno">  741</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> thresh_layers_below = 10 / config.layer_height;</div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordtype">double</span> obj_height = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#ad88e205a24924b8c8f9e3c74a1daf6fc">size</a>().z();</div>
<div class="line"><span class="lineno">  743</span>    <span class="comment">// +1 makes the threshold inclusive</span></div>
<div class="line"><span class="lineno">  744</span>    <span class="keywordtype">double</span> thresh_angle = config.support_threshold_angle.value &gt; <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a> ? config.support_threshold_angle.value + 1 : 30;</div>
<div class="line"><span class="lineno">  745</span>    thresh_angle = std::min(thresh_angle, 89.); <span class="comment">// should be smaller than 90</span></div>
<div class="line"><span class="lineno">  746</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> threshold_rad = <a class="code hl_function" href="../../d3/dfb/namespace_slic3r_1_1_geometry.html#a345f6f1e6238a364b20bdabac88a8314">Geometry::deg2rad</a>(thresh_angle);</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>    <span class="comment">// for small overhang removal</span></div>
<div class="line"><span class="lineno">  749</span>    <span class="keyword">struct </span>OverhangCluster {</div>
<div class="line"><span class="lineno">  750</span>        std::map&lt;int, const ExPolygon*&gt; layer_overhangs;</div>
<div class="line"><span class="lineno">  751</span>        <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a> merged_poly;</div>
<div class="line"><span class="lineno">  752</span>        BoundingBox merged_bbox;</div>
<div class="line"><span class="lineno">  753</span>        <span class="keywordtype">int</span> min_layer = 1e7;</div>
<div class="line"><span class="lineno">  754</span>        <span class="keywordtype">int</span> max_layer = 0;</div>
<div class="line"><span class="lineno">  755</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#ab29201ea713e88d9d709ae4fa8f2576f">offset</a> = 0;</div>
<div class="line"><span class="lineno">  756</span>        <span class="keywordtype">bool</span> is_cantilever = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  757</span>        <span class="keywordtype">bool</span> is_sharp_tail = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  758</span>        <span class="keywordtype">bool</span> is_small_overhang = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  759</span>        OverhangCluster(<span class="keyword">const</span> ExPolygon* expoly, <span class="keywordtype">int</span> layer_nr) {</div>
<div class="line"><span class="lineno">  760</span>            push_back(expoly, layer_nr);</div>
<div class="line"><span class="lineno">  761</span>        }</div>
<div class="line"><span class="lineno">  762</span>        <span class="keywordtype">void</span> push_back(<span class="keyword">const</span> ExPolygon* expoly, <span class="keywordtype">int</span> layer_nr) {</div>
<div class="line"><span class="lineno">  763</span>            layer_overhangs.emplace(layer_nr, expoly);</div>
<div class="line"><span class="lineno">  764</span>            <span class="keyword">auto</span> dilate1 = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5e96c84b799b62906e4a46a94eb8916c">offset_ex</a>(*expoly, offset);</div>
<div class="line"><span class="lineno">  765</span>            <span class="keywordflow">if</span> (!dilate1.empty())</div>
<div class="line"><span class="lineno">  766</span>                merged_poly = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a37166e144522fceee41e6d8ed8245315">union_ex</a>(merged_poly, dilate1);</div>
<div class="line"><span class="lineno">  767</span>            min_layer = std::min(min_layer, layer_nr);</div>
<div class="line"><span class="lineno">  768</span>            max_layer = std::max(max_layer, layer_nr);</div>
<div class="line"><span class="lineno">  769</span>            merged_bbox.merge(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a6e3ba75aef7600dbb0a294a47d88ecb8">get_extents</a>(dilate1));</div>
<div class="line"><span class="lineno">  770</span>        }</div>
<div class="line"><span class="lineno">  771</span>        <span class="keywordtype">int</span> <a class="code hl_function" href="../../d0/d25/namespace_slic3r_1_1arrangement.html#a5b816dd05a95b740ac2194b643ceaacc">height</a>() {</div>
<div class="line"><span class="lineno">  772</span>            <span class="keywordflow">return</span> max_layer - min_layer + 1;</div>
<div class="line"><span class="lineno">  773</span>        }</div>
<div class="line"><span class="lineno">  774</span>        <span class="keywordtype">bool</span> <a class="code hl_function" href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#ae980d1aae4595291ca4eb978e66c4834">intersects</a>(<span class="keyword">const</span> ExPolygon&amp; region, <span class="keywordtype">int</span> layer_nr, <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> offset) {</div>
<div class="line"><span class="lineno">  775</span>            <span class="keywordflow">if</span> (layer_nr &lt; 1) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  776</span>            <span class="keyword">auto</span> it = layer_overhangs.find(layer_nr - 1);</div>
<div class="line"><span class="lineno">  777</span>            <span class="keywordflow">if</span> (it == layer_overhangs.end()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  778</span>            <span class="keyword">const</span> ExPolygon* overhang = it-&gt;second;</div>
<div class="line"><span class="lineno">  779</span> </div>
<div class="line"><span class="lineno">  780</span>            this-&gt;offset = <a class="code hl_function" href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#ab29201ea713e88d9d709ae4fa8f2576f">offset</a>;</div>
<div class="line"><span class="lineno">  781</span>            <span class="keyword">auto</span> dilate1 = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5e96c84b799b62906e4a46a94eb8916c">offset_ex</a>(region, offset);</div>
<div class="line"><span class="lineno">  782</span>            BoundingBox bbox = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a6e3ba75aef7600dbb0a294a47d88ecb8">get_extents</a>(dilate1);</div>
<div class="line"><span class="lineno">  783</span>            <span class="keywordflow">if</span> (!merged_bbox.overlap(bbox))</div>
<div class="line"><span class="lineno">  784</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  785</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#ac054ee91b47bfcb7c5e12ff3344c6153">overlaps</a>({ *overhang }, dilate1);</div>
<div class="line"><span class="lineno">  786</span>        }</div>
<div class="line"><span class="lineno">  787</span>        <span class="comment">// it&#39;s basically the combination of push_back and intersects, but saves an offset_ex</span></div>
<div class="line"><span class="lineno">  788</span>        <span class="keywordtype">bool</span> push_back_if_intersects(<span class="keyword">const</span> ExPolygon&amp; region, <span class="keywordtype">int</span> layer_nr, <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> offset) {</div>
<div class="line"><span class="lineno">  789</span>            <span class="keywordtype">bool</span> is_intersect = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  790</span>            <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a> dilate1;</div>
<div class="line"><span class="lineno">  791</span>            BoundingBox bbox;</div>
<div class="line"><span class="lineno">  792</span>            <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno">  793</span>                <span class="keywordflow">if</span> (layer_nr &lt; 1) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  794</span>                <span class="keyword">auto</span> it = layer_overhangs.find(layer_nr - 1);</div>
<div class="line"><span class="lineno">  795</span>                <span class="keywordflow">if</span> (it == layer_overhangs.end()) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  796</span>                <span class="keyword">const</span> ExPolygon* overhang = it-&gt;second;</div>
<div class="line"><span class="lineno">  797</span> </div>
<div class="line"><span class="lineno">  798</span>                this-&gt;offset = <a class="code hl_function" href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#ab29201ea713e88d9d709ae4fa8f2576f">offset</a>;</div>
<div class="line"><span class="lineno">  799</span>                dilate1 = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5e96c84b799b62906e4a46a94eb8916c">offset_ex</a>(region, offset);</div>
<div class="line"><span class="lineno">  800</span>                <span class="keywordflow">if</span> (dilate1.empty()) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  801</span>                bbox = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a6e3ba75aef7600dbb0a294a47d88ecb8">get_extents</a>(dilate1);</div>
<div class="line"><span class="lineno">  802</span>                <span class="keywordflow">if</span> (!merged_bbox.overlap(bbox))</div>
<div class="line"><span class="lineno">  803</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  804</span>                is_intersect = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#ac054ee91b47bfcb7c5e12ff3344c6153">overlaps</a>({ *overhang }, dilate1);</div>
<div class="line"><span class="lineno">  805</span>            } <span class="keywordflow">while</span> (0);</div>
<div class="line"><span class="lineno">  806</span>            <span class="keywordflow">if</span> (is_intersect) {</div>
<div class="line"><span class="lineno">  807</span>                layer_overhangs.emplace(layer_nr, &amp;region);</div>
<div class="line"><span class="lineno">  808</span>                merged_poly = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a37166e144522fceee41e6d8ed8245315">union_ex</a>(merged_poly, dilate1);</div>
<div class="line"><span class="lineno">  809</span>                min_layer = std::min(min_layer, layer_nr);</div>
<div class="line"><span class="lineno">  810</span>                max_layer = std::max(max_layer, layer_nr);</div>
<div class="line"><span class="lineno">  811</span>                merged_bbox.merge(bbox);</div>
<div class="line"><span class="lineno">  812</span>            }</div>
<div class="line"><span class="lineno">  813</span>            <span class="keywordflow">return</span> is_intersect;</div>
<div class="line"><span class="lineno">  814</span>        }</div>
<div class="line"><span class="lineno">  815</span>    };</div>
<div class="line"><span class="lineno">  816</span>    std::vector&lt;OverhangCluster&gt; overhangClusters;</div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span>    <span class="keyword">auto</span> find_and_insert_cluster = [](<span class="keyword">auto</span> &amp;regionClusters, <span class="keyword">const</span> ExPolygon &amp;region, <span class="keywordtype">int</span> layer_nr, <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5ec552d076296fd705739c608edc1580">offset</a>) {</div>
<div class="line"><span class="lineno">  819</span>        OverhangCluster *<a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  820</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; regionClusters.size(); i++) {</div>
<div class="line"><span class="lineno">  821</span>            <span class="keyword">auto</span> cluster_i = &amp;regionClusters[i];</div>
<div class="line"><span class="lineno">  822</span>            <span class="keywordflow">if</span> (cluster_i-&gt;push_back_if_intersects(region, layer_nr, <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5ec552d076296fd705739c608edc1580">offset</a>)) {</div>
<div class="line"><span class="lineno">  823</span>                <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a> = cluster_i;</div>
<div class="line"><span class="lineno">  824</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  825</span>            }</div>
<div class="line"><span class="lineno">  826</span>        }</div>
<div class="line"><span class="lineno">  827</span>        <span class="keywordflow">if</span> (!cluster) {</div>
<div class="line"><span class="lineno">  828</span>            <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a> = &amp;regionClusters.emplace_back(&amp;region, layer_nr);</div>
<div class="line"><span class="lineno">  829</span>        }</div>
<div class="line"><span class="lineno">  830</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>;</div>
<div class="line"><span class="lineno">  831</span>    };</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a61b97e6f6260d750b0110a6b0d0ebc88">is_tree</a>(stype)) <span class="keywordflow">return</span>;   </div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad9a79d4d08f9c209973a02bf7293e2e6">max_cantilever_dist</a> = 0;</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>    <span class="comment">// main part of overhang detection can be parallel</span></div>
<div class="line"><span class="lineno">  838</span>    tbb::parallel_for(tbb::blocked_range&lt;size_t&gt;(0, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aea3e7f3fc4b46b4290105f655edcde47">layer_count</a>()),</div>
<div class="line"><span class="lineno">  839</span>        [&amp;](<span class="keyword">const</span> tbb::blocked_range&lt;size_t&gt;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a51e1ea9708d6434aae1e8394bef8acdc">range</a>) {</div>
<div class="line"><span class="lineno">  840</span>            for (size_t layer_nr = range.begin(); layer_nr &lt; range.end(); layer_nr++) {</div>
<div class="line"><span class="lineno">  841</span>                if (m_object-&gt;print()-&gt;canceled())</div>
<div class="line"><span class="lineno">  842</span>                    break;</div>
<div class="line"><span class="lineno">  843</span> </div>
<div class="line"><span class="lineno">  844</span>                if (!is_auto(stype) &amp;&amp; layer_nr &gt; enforce_support_layers)</div>
<div class="line"><span class="lineno">  845</span>                    continue;</div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span>                Layer* layer = m_object-&gt;get_layer(layer_nr);</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>                if (layer-&gt;lower_layer == nullptr) {</div>
<div class="line"><span class="lineno">  850</span>                    for (auto&amp; slice : layer-&gt;lslices) {</div>
<div class="line"><span class="lineno">  851</span>                        auto bbox_size = get_extents(slice).size();</div>
<div class="line"><span class="lineno">  852</span>                        if (!((bbox_size.x() &gt; length_thresh_well_supported &amp;&amp; bbox_size.y() &gt; length_thresh_well_supported))</div>
<div class="line"><span class="lineno">  853</span>                            &amp;&amp; g_config_support_sharp_tails) {</div>
<div class="line"><span class="lineno">  854</span>                            layer-&gt;sharp_tails.push_back(slice);</div>
<div class="line"><span class="lineno">  855</span>                            layer-&gt;sharp_tails_height.insert({ &amp;slice, layer-&gt;height });</div>
<div class="line"><span class="lineno">  856</span>                        }</div>
<div class="line"><span class="lineno">  857</span>                    }</div>
<div class="line"><span class="lineno">  858</span>                    continue;</div>
<div class="line"><span class="lineno">  859</span>                }</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>                Layer* lower_layer = layer-&gt;lower_layer;</div>
<div class="line"><span class="lineno">  862</span>                coordf_t lower_layer_offset = layer_nr &lt; enforce_support_layers ? -0.15 * extrusion_width : (float)lower_layer-&gt;height / tan(threshold_rad);</div>
<div class="line"><span class="lineno">  863</span>                coordf_t support_offset_scaled = scale_(lower_layer_offset);</div>
<div class="line"><span class="lineno">  864</span>                <span class="comment">// Filter out areas whose diameter that is smaller than extrusion_width. Do not use offset2() for this purpose!</span></div>
<div class="line"><span class="lineno">  865</span>                ExPolygons lower_polys;</div>
<div class="line"><span class="lineno">  866</span>                for (const ExPolygon&amp; expoly : lower_layer-&gt;lslices) {</div>
<div class="line"><span class="lineno">  867</span>                    if (!offset_ex(expoly, -extrusion_width_scaled / 2).empty()) {</div>
<div class="line"><span class="lineno">  868</span>                        lower_polys.emplace_back(expoly);</div>
<div class="line"><span class="lineno">  869</span>                    }</div>
<div class="line"><span class="lineno">  870</span>                }</div>
<div class="line"><span class="lineno">  871</span>                ExPolygons curr_polys;</div>
<div class="line"><span class="lineno">  872</span>                std::vector&lt;const ExPolygon*&gt; curr_poly_ptrs;</div>
<div class="line"><span class="lineno">  873</span>                for (const ExPolygon&amp; expoly : layer-&gt;lslices) {</div>
<div class="line"><span class="lineno">  874</span>                    if (!offset_ex(expoly, -extrusion_width_scaled / 2).empty()) {</div>
<div class="line"><span class="lineno">  875</span>                        curr_polys.emplace_back(expoly);</div>
<div class="line"><span class="lineno">  876</span>                        curr_poly_ptrs.emplace_back(&amp;expoly);</div>
<div class="line"><span class="lineno">  877</span>                    }</div>
<div class="line"><span class="lineno">  878</span>                }</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>                <span class="comment">// normal overhang</span></div>
<div class="line"><span class="lineno">  881</span>                ExPolygons lower_layer_offseted = offset_ex(lower_polys, support_offset_scaled, SUPPORT_SURFACES_OFFSET_PARAMETERS);</div>
<div class="line"><span class="lineno">  882</span>                ExPolygons overhang_areas = std::move(diff_ex(curr_polys, lower_layer_offseted));</div>
<div class="line"><span class="lineno">  883</span> </div>
<div class="line"><span class="lineno">  884</span>                overhang_areas.erase(std::remove_if(overhang_areas.begin(), overhang_areas.end(),</div>
<div class="line"><span class="lineno">  885</span>                    [extrusion_width_scaled](ExPolygon&amp; area) { return offset_ex(area, -0.1 * extrusion_width_scaled).empty(); }),</div>
<div class="line"><span class="lineno">  886</span>                    overhang_areas.end());</div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>                if (is_auto(stype) &amp;&amp; g_config_support_sharp_tails)</div>
<div class="line"><span class="lineno">  890</span>                {</div>
<div class="line"><span class="lineno">  891</span>                    <span class="comment">// BBS detect sharp tail</span></div>
<div class="line"><span class="lineno">  892</span>                    for (const ExPolygon* expoly : curr_poly_ptrs) {</div>
<div class="line"><span class="lineno">  893</span>                        bool  is_sharp_tail = false;</div>
<div class="line"><span class="lineno">  894</span>                        <span class="comment">// 1. nothing below</span></div>
<div class="line"><span class="lineno">  895</span>                        <span class="comment">// this is a sharp tail region if it&#39;s small but non-ignorable</span></div>
<div class="line"><span class="lineno">  896</span>                        if (!overlaps(offset_ex(*expoly, 0.5 * extrusion_width_scaled), lower_polys)) {</div>
<div class="line"><span class="lineno">  897</span>                            is_sharp_tail = expoly-&gt;area() &lt; area_thresh_well_supported &amp;&amp; !offset_ex(*expoly, -0.1 * extrusion_width_scaled).empty();</div>
<div class="line"><span class="lineno">  898</span>                        }</div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span>                        if (is_sharp_tail) {</div>
<div class="line"><span class="lineno">  901</span>                            ExPolygons overhang = diff_ex({ *expoly }, lower_polys);</div>
<div class="line"><span class="lineno">  902</span>                            layer-&gt;sharp_tails.push_back(*expoly);</div>
<div class="line"><span class="lineno">  903</span>                            layer-&gt;sharp_tails_height.insert({ expoly, layer-&gt;height });</div>
<div class="line"><span class="lineno">  904</span>                            append(overhang_areas, overhang);</div>
<div class="line"><span class="lineno">  905</span> </div>
<div class="line"><span class="lineno">  906</span>                            if (!overhang.empty()) {</div>
<div class="line"><span class="lineno">  907</span>                                has_sharp_tails = true;</div>
<div class="line"><span class="lineno">  908</span>#ifdef SUPPORT_TREE_DEBUG_TO_SVG</div>
<div class="line"><span class="lineno">  909</span>                                SVG svg(format(<span class="stringliteral">&quot;SVG/sharp_tail_orig_%.02f.svg&quot;</span>, layer-&gt;print_z), m_object-&gt;bounding_box());</div>
<div class="line"><span class="lineno">  910</span>                                if (svg.is_opened()) svg.draw(overhang, <span class="stringliteral">&quot;red&quot;</span>);</div>
<div class="line"><span class="lineno">  911</span>#endif</div>
<div class="line"><span class="lineno">  912</span>                            }</div>
<div class="line"><span class="lineno">  913</span>                        }                        </div>
<div class="line"><span class="lineno">  914</span>                    }</div>
<div class="line"><span class="lineno">  915</span>                }</div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span>                SupportLayer* ts_layer = m_object-&gt;get_support_layer(layer_nr + m_raft_layers);</div>
<div class="line"><span class="lineno">  918</span>                for (ExPolygon&amp; poly : overhang_areas) {</div>
<div class="line"><span class="lineno">  919</span>                    if (offset_ex(poly, -0.1 * extrusion_width_scaled).empty()) continue;</div>
<div class="line"><span class="lineno">  920</span>                    ts_layer-&gt;overhang_areas.emplace_back(poly);</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>                    <span class="comment">// check cantilever</span></div>
<div class="line"><span class="lineno">  923</span>                    {</div>
<div class="line"><span class="lineno">  924</span>                        auto cluster_boundary_ex = intersection_ex(poly, offset_ex(lower_layer-&gt;lslices, scale_(0.5)));</div>
<div class="line"><span class="lineno">  925</span>                        Polygons cluster_boundary = to_polygons(cluster_boundary_ex);</div>
<div class="line"><span class="lineno">  926</span>                        if (cluster_boundary.empty()) continue;</div>
<div class="line"><span class="lineno">  927</span>                        double dist_max = 0;</div>
<div class="line"><span class="lineno">  928</span>                        for (auto&amp; pt : poly.contour.points) {</div>
<div class="line"><span class="lineno">  929</span>                            double dist_pt = std::numeric_limits&lt;double&gt;::max();</div>
<div class="line"><span class="lineno">  930</span>                            for (auto&amp; ply : cluster_boundary) {</div>
<div class="line"><span class="lineno">  931</span>                                double d = ply.distance_to(pt);</div>
<div class="line"><span class="lineno">  932</span>                                dist_pt = std::min(dist_pt, d);</div>
<div class="line"><span class="lineno">  933</span>                            }</div>
<div class="line"><span class="lineno">  934</span>                            dist_max = std::max(dist_max, dist_pt);</div>
<div class="line"><span class="lineno">  935</span>                        }</div>
<div class="line"><span class="lineno">  936</span>                        if (dist_max &gt; scale_(3)) {  <span class="comment">// is cantilever if the farmost point is larger than 3mm away from base                            </span></div>
<div class="line"><span class="lineno">  937</span>                            max_cantilever_dist = std::max(max_cantilever_dist, dist_max);</div>
<div class="line"><span class="lineno">  938</span>                            layer-&gt;cantilevers.emplace_back(poly);</div>
<div class="line"><span class="lineno">  939</span>                            BOOST_LOG_TRIVIAL(debug) &lt;&lt; <span class="stringliteral">&quot;found a cantilever cluster. layer_nr=&quot;</span> &lt;&lt; layer_nr &lt;&lt; dist_max;</div>
<div class="line"><span class="lineno">  940</span>                            has_cantilever = true;</div>
<div class="line"><span class="lineno">  941</span>                        }</div>
<div class="line"><span class="lineno">  942</span>                    }</div>
<div class="line"><span class="lineno">  943</span>                }</div>
<div class="line"><span class="lineno">  944</span>            }</div>
<div class="line"><span class="lineno">  945</span>        }</div>
<div class="line"><span class="lineno">  946</span>    ); <span class="comment">// end tbb::parallel_for</span></div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span>    BOOST_LOG_TRIVIAL(info) &lt;&lt; <span class="stringliteral">&quot;max_cantilever_dist=&quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad9a79d4d08f9c209973a02bf7293e2e6">max_cantilever_dist</a>;</div>
<div class="line"><span class="lineno">  949</span> </div>
<div class="line"><span class="lineno">  950</span>    <span class="comment">// check if the sharp tails should be extended higher</span></div>
<div class="line"><span class="lineno">  951</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a6025cd9b54824e8bcac090b8f5d29337">is_auto</a>(stype) &amp;&amp; <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a7b0d40f9a8619b673f9ceea8de04661a">g_config_support_sharp_tails</a> &amp;&amp; !detect_first_sharp_tail_only) {</div>
<div class="line"><span class="lineno">  952</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> layer_nr = 0; layer_nr &lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aea3e7f3fc4b46b4290105f655edcde47">layer_count</a>(); layer_nr++) {</div>
<div class="line"><span class="lineno">  953</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../dc/d88/class_slic3r_1_1_print_base.html#ab5f6b4781d433373200f5f328ebcb4a8">canceled</a>())</div>
<div class="line"><span class="lineno">  954</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  955</span> </div>
<div class="line"><span class="lineno">  956</span>            Layer* layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr);</div>
<div class="line"><span class="lineno">  957</span>            SupportLayer* ts_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>);</div>
<div class="line"><span class="lineno">  958</span>            Layer* lower_layer = layer-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#aff84b8f549804babf9ecaee1a49e260e">lower_layer</a>;</div>
<div class="line"><span class="lineno">  959</span>            <span class="keywordflow">if</span> (!lower_layer)</div>
<div class="line"><span class="lineno">  960</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  961</span> </div>
<div class="line"><span class="lineno">  962</span>            <span class="comment">// BBS detect sharp tail</span></div>
<div class="line"><span class="lineno">  963</span>            <span class="keyword">const</span> <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a>&amp; lower_layer_sharptails = lower_layer-&gt;sharp_tails;</div>
<div class="line"><span class="lineno">  964</span>            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; lower_layer_sharptails_height = lower_layer-&gt;sharp_tails_height;</div>
<div class="line"><span class="lineno">  965</span>            <span class="keywordflow">for</span> (ExPolygon&amp; expoly : layer-&gt;lslices) {</div>
<div class="line"><span class="lineno">  966</span>                <span class="keywordtype">bool</span>  is_sharp_tail = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  967</span>                <span class="keywordtype">float</span> accum_height = layer-&gt;height;</div>
<div class="line"><span class="lineno">  968</span>                <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno">  969</span>                    <span class="comment">// 2. something below</span></div>
<div class="line"><span class="lineno">  970</span>                    <span class="comment">// check whether this is above a sharp tail region.</span></div>
<div class="line"><span class="lineno">  971</span> </div>
<div class="line"><span class="lineno">  972</span>                    <span class="comment">// 2.1 If no sharp tail below, this is considered as common region.</span></div>
<div class="line"><span class="lineno">  973</span>                    <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a> supported_by_lower = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a9853756af06b71590c902865926b8e28">intersection_ex</a>({ expoly }, lower_layer_sharptails);</div>
<div class="line"><span class="lineno">  974</span>                    <span class="keywordflow">if</span> (supported_by_lower.empty()) {</div>
<div class="line"><span class="lineno">  975</span>                        is_sharp_tail = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  976</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  977</span>                    }</div>
<div class="line"><span class="lineno">  978</span> </div>
<div class="line"><span class="lineno">  979</span>                    <span class="comment">// 2.2 If sharp tail below, check whether it support this region enough.</span></div>
<div class="line"><span class="lineno">  980</span><span class="preprocessor">#if 0</span></div>
<div class="line"><span class="lineno">  981</span>                    <span class="comment">// judge by area isn&#39;t reliable, failure cases include 45 degree rotated cube</span></div>
<div class="line"><span class="lineno">  982</span>                    <span class="keywordtype">float</span>       supported_area = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a58007b1077539ba492d56398b92fea70">area</a>(supported_by_lower);</div>
<div class="line"><span class="lineno">  983</span>                    <span class="keywordflow">if</span> (supported_area &gt; <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a15f6728115269978cc5e0a44c22479a8">area_thresh_well_supported</a>) {</div>
<div class="line"><span class="lineno">  984</span>                        is_sharp_tail = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  985</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  986</span>                    }</div>
<div class="line"><span class="lineno">  987</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  988</span>                    BoundingBox bbox = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a6e3ba75aef7600dbb0a294a47d88ecb8">get_extents</a>(supported_by_lower);</div>
<div class="line"><span class="lineno">  989</span>                    <span class="keywordflow">if</span> (bbox.size().x() &gt; <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a509efc840b8460ee975221330ef6d82f">length_thresh_well_supported</a> &amp;&amp; bbox.size().y() &gt; <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a509efc840b8460ee975221330ef6d82f">length_thresh_well_supported</a>) {</div>
<div class="line"><span class="lineno">  990</span>                        is_sharp_tail = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  991</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  992</span>                    }</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>                    <span class="comment">// 2.3 check whether sharp tail exceed the max height</span></div>
<div class="line"><span class="lineno">  995</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; lower_sharp_tail_height : lower_layer_sharptails_height) {</div>
<div class="line"><span class="lineno">  996</span>                        <span class="keywordflow">if</span> (lower_sharp_tail_height.first-&gt;overlaps(expoly)) {</div>
<div class="line"><span class="lineno">  997</span>                            accum_height += lower_sharp_tail_height.second;</div>
<div class="line"><span class="lineno">  998</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  999</span>                        }</div>
<div class="line"><span class="lineno"> 1000</span>                    }</div>
<div class="line"><span class="lineno"> 1001</span>                    <span class="keywordflow">if</span> (accum_height &gt; <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a852e19ab281b44709b3c5a3779c9c4cf">sharp_tail_max_support_height</a>) {</div>
<div class="line"><span class="lineno"> 1002</span>                        is_sharp_tail = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1003</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1004</span>                    }</div>
<div class="line"><span class="lineno"> 1005</span> </div>
<div class="line"><span class="lineno"> 1006</span>                    <span class="comment">// 2.4 if the area grows fast than threshold, it get connected to other part or</span></div>
<div class="line"><span class="lineno"> 1007</span>                    <span class="comment">// it has a sharp slop and will be auto supported.</span></div>
<div class="line"><span class="lineno"> 1008</span>                    <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a> new_overhang_expolys = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a2b1bfe9b50e13403d42de533b8a19916">diff_ex</a>({ expoly }, lower_layer_sharptails);</div>
<div class="line"><span class="lineno"> 1009</span>                    <span class="keywordflow">if</span> ((<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a6e3ba75aef7600dbb0a294a47d88ecb8">get_extents</a>(new_overhang_expolys).<a class="code hl_variable" href="../../de/d38/lzoconf_8h.html#a809275ccd755fb7b88661d952134b14d">size</a>() - <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a6e3ba75aef7600dbb0a294a47d88ecb8">get_extents</a>(lower_layer_sharptails).<a class="code hl_variable" href="../../de/d38/lzoconf_8h.html#a809275ccd755fb7b88661d952134b14d">size</a>()).both_comp(<a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(<a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(5), <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(5)), <span class="stringliteral">&quot;&gt;&quot;</span>) || !<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5e96c84b799b62906e4a46a94eb8916c">offset_ex</a>(new_overhang_expolys, -5.0 * extrusion_width_scaled).<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a83fc268888773d5c0f886fc2e54b8c64">empty</a>()) {</div>
<div class="line"><span class="lineno"> 1010</span>                        is_sharp_tail = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1011</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1012</span>                    }</div>
<div class="line"><span class="lineno"> 1013</span> </div>
<div class="line"><span class="lineno"> 1014</span>                    <span class="comment">// 2.5 mark the expoly as sharptail</span></div>
<div class="line"><span class="lineno"> 1015</span>                    is_sharp_tail = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1016</span>                } <span class="keywordflow">while</span> (0);</div>
<div class="line"><span class="lineno"> 1017</span> </div>
<div class="line"><span class="lineno"> 1018</span>                <span class="keywordflow">if</span> (is_sharp_tail) {</div>
<div class="line"><span class="lineno"> 1019</span>                    <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a> overhang = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a2b1bfe9b50e13403d42de533b8a19916">diff_ex</a>({ expoly }, lower_layer-&gt;lslices);</div>
<div class="line"><span class="lineno"> 1020</span>                    layer-&gt;sharp_tails.push_back(expoly);</div>
<div class="line"><span class="lineno"> 1021</span>                    layer-&gt;sharp_tails_height.insert({ &amp;expoly, accum_height });</div>
<div class="line"><span class="lineno"> 1022</span>                    <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5f240a84e573ed2d7785a439f4239e1a">append</a>(ts_layer-&gt;overhang_areas, overhang);</div>
<div class="line"><span class="lineno"> 1023</span> </div>
<div class="line"><span class="lineno"> 1024</span>                    <span class="keywordflow">if</span> (!overhang.empty())</div>
<div class="line"><span class="lineno"> 1025</span>                        <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aea51639c5c7e46181da9e0f45bbda696">has_sharp_tails</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1026</span><span class="preprocessor">#ifdef SUPPORT_TREE_DEBUG_TO_SVG</span></div>
<div class="line"><span class="lineno"> 1027</span>                    <a class="code hl_enumvalue" href="../../df/ddf/namespacelibnest2d.html#af597612c78e3eb318a885f34ddafa180acd15a75c26008696647b31a3f0de43b3">SVG</a> svg(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#ab28c13d286b2d1767d7c63b020ebd042">format</a>(<span class="stringliteral">&quot;SVG/sharp_tail_%.02f.svg&quot;</span>,layer-&gt;print_z), <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a571b601aadc8d8a24208e933bbd8704c">bounding_box</a>());</div>
<div class="line"><span class="lineno"> 1028</span>                    <span class="keywordflow">if</span> (svg.is_opened()) svg.draw(overhang, <span class="stringliteral">&quot;red&quot;</span>);</div>
<div class="line"><span class="lineno"> 1029</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1030</span>                }</div>
<div class="line"><span class="lineno"> 1031</span> </div>
<div class="line"><span class="lineno"> 1032</span>            }          </div>
<div class="line"><span class="lineno"> 1033</span>        }</div>
<div class="line"><span class="lineno"> 1034</span>    }</div>
<div class="line"><span class="lineno"> 1035</span>    </div>
<div class="line"><span class="lineno"> 1036</span>    <span class="comment">// group overhang clusters</span></div>
<div class="line"><span class="lineno"> 1037</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> layer_nr = 0; layer_nr &lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aea3e7f3fc4b46b4290105f655edcde47">layer_count</a>(); layer_nr++) {</div>
<div class="line"><span class="lineno"> 1038</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../dc/d88/class_slic3r_1_1_print_base.html#ab5f6b4781d433373200f5f328ebcb4a8">canceled</a>())</div>
<div class="line"><span class="lineno"> 1039</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1040</span>        SupportLayer* ts_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>);</div>
<div class="line"><span class="lineno"> 1041</span>        Layer* layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr);</div>
<div class="line"><span class="lineno"> 1042</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; overhang : ts_layer-&gt;overhang_areas) {</div>
<div class="line"><span class="lineno"> 1043</span>            OverhangCluster* <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a> = find_and_insert_cluster(overhangClusters, overhang, layer_nr, extrusion_width_scaled);</div>
<div class="line"><span class="lineno"> 1044</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#ac054ee91b47bfcb7c5e12ff3344c6153">overlaps</a>({ overhang },layer-&gt;cantilevers))</div>
<div class="line"><span class="lineno"> 1045</span>                <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>-&gt;is_cantilever = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1046</span>        }</div>
<div class="line"><span class="lineno"> 1047</span>    }</div>
<div class="line"><span class="lineno"> 1048</span> </div>
<div class="line"><span class="lineno"> 1049</span>    <span class="keyword">auto</span> enforcers = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a9d8f15c559b04e238ac1066bc20975ab">slice_support_enforcers</a>();</div>
<div class="line"><span class="lineno"> 1050</span>    <span class="keyword">auto</span> blockers  = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#ae96af7161a2c596e832879eea8e95f5c">slice_support_blockers</a>();</div>
<div class="line"><span class="lineno"> 1051</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a3b3906b04b6ef3f958b5cc95f4720a30">project_and_append_custom_facets</a>(<span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a5ce80416d9bd655d2fb946edf0f602f0a66623df40a88662bfd8a271edb488841">EnforcerBlockerType::ENFORCER</a>, enforcers);</div>
<div class="line"><span class="lineno"> 1052</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a3b3906b04b6ef3f958b5cc95f4720a30">project_and_append_custom_facets</a>(<span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a5ce80416d9bd655d2fb946edf0f602f0a95a95df0c5337385356cd00cbd59a000">EnforcerBlockerType::BLOCKER</a>, blockers);</div>
<div class="line"><span class="lineno"> 1053</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a6025cd9b54824e8bcac090b8f5d29337">is_auto</a>(stype) &amp;&amp; config_remove_small_overhangs) {</div>
<div class="line"><span class="lineno"> 1054</span>        <span class="keywordflow">if</span> (blockers.size() &lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aea3e7f3fc4b46b4290105f655edcde47">layer_count</a>())</div>
<div class="line"><span class="lineno"> 1055</span>            blockers.resize(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aea3e7f3fc4b46b4290105f655edcde47">layer_count</a>());</div>
<div class="line"><span class="lineno"> 1056</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; cluster : overhangClusters) {</div>
<div class="line"><span class="lineno"> 1057</span>            <span class="comment">// 3. check whether the small overhang is sharp tail</span></div>
<div class="line"><span class="lineno"> 1058</span>            <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.is_sharp_tail = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1059</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> layer_id = <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.min_layer; layer_id &lt;= <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.max_layer; layer_id++) {</div>
<div class="line"><span class="lineno"> 1060</span>                Layer* layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_id);</div>
<div class="line"><span class="lineno"> 1061</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#ac054ee91b47bfcb7c5e12ff3344c6153">overlaps</a>(layer-&gt;sharp_tails, <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.merged_poly)) {</div>
<div class="line"><span class="lineno"> 1062</span>                    <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.is_sharp_tail = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1063</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1064</span>                }</div>
<div class="line"><span class="lineno"> 1065</span>            }</div>
<div class="line"><span class="lineno"> 1066</span> </div>
<div class="line"><span class="lineno"> 1067</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.is_sharp_tail &amp;&amp; !<a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.is_cantilever) {</div>
<div class="line"><span class="lineno"> 1068</span>                <span class="comment">// 2. check overhang cluster size is smaller than 3.0 * fw_scaled</span></div>
<div class="line"><span class="lineno"> 1069</span>                <span class="keyword">auto</span> erode1 = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5e96c84b799b62906e4a46a94eb8916c">offset_ex</a>(<a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.merged_poly, -1 * extrusion_width_scaled);</div>
<div class="line"><span class="lineno"> 1070</span>                <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> bbox_sz = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a6e3ba75aef7600dbb0a294a47d88ecb8">get_extents</a>(erode1).<a class="code hl_function" href="../../dc/d28/class_slic3r_1_1_bounding_box_base.html#a2233d300d197f650b6fefa6ac1607203">size</a>();</div>
<div class="line"><span class="lineno"> 1071</span>                <span class="keywordflow">if</span> (bbox_sz.x() &lt; 2 * extrusion_width_scaled || bbox_sz.y() &lt; 2 * extrusion_width_scaled) {</div>
<div class="line"><span class="lineno"> 1072</span>                    <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.is_small_overhang = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1073</span>                }</div>
<div class="line"><span class="lineno"> 1074</span>            }</div>
<div class="line"><span class="lineno"> 1075</span> </div>
<div class="line"><span class="lineno"> 1076</span><span class="preprocessor">#ifdef SUPPORT_TREE_DEBUG_TO_SVG</span></div>
<div class="line"><span class="lineno"> 1077</span>            <span class="keyword">const</span> Layer* layer1 = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(<a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.min_layer);</div>
<div class="line"><span class="lineno"> 1078</span>            BoundingBox bbox = <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.merged_bbox;</div>
<div class="line"><span class="lineno"> 1079</span>            bbox.merge(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a6e3ba75aef7600dbb0a294a47d88ecb8">get_extents</a>(layer1-&gt;lslices));</div>
<div class="line"><span class="lineno"> 1080</span>            <a class="code hl_enumvalue" href="../../df/ddf/namespacelibnest2d.html#af597612c78e3eb318a885f34ddafa180acd15a75c26008696647b31a3f0de43b3">SVG</a> svg(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#ab28c13d286b2d1767d7c63b020ebd042">format</a>(<span class="stringliteral">&quot;SVG/overhangCluster_%s-%s_%s-%s_tail=%s_cantilever=%s_small=%s.svg&quot;</span>,</div>
<div class="line"><span class="lineno"> 1081</span>                <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.min_layer, <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.max_layer, layer1-&gt;print_z, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(<a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.max_layer)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a8918ae15322de198ce6d0632feaac9b4">print_z</a>,</div>
<div class="line"><span class="lineno"> 1082</span>                <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.is_sharp_tail, <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.is_cantilever, <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.is_small_overhang), bbox);</div>
<div class="line"><span class="lineno"> 1083</span>            <span class="keywordflow">if</span> (svg.is_opened()) {</div>
<div class="line"><span class="lineno"> 1084</span>                svg.draw(layer1-&gt;lslices, <span class="stringliteral">&quot;red&quot;</span>);</div>
<div class="line"><span class="lineno"> 1085</span>                svg.draw(<a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.merged_poly, <span class="stringliteral">&quot;blue&quot;</span>);</div>
<div class="line"><span class="lineno"> 1086</span>                svg.draw_text(bbox.min + <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(<a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(0), <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(2)), <span class="stringliteral">&quot;lslices&quot;</span>, <span class="stringliteral">&quot;red&quot;</span>, 2);</div>
<div class="line"><span class="lineno"> 1087</span>                svg.draw_text(bbox.min + <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(<a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(0), <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(2)), <span class="stringliteral">&quot;overhang&quot;</span>, <span class="stringliteral">&quot;blue&quot;</span>, 2);</div>
<div class="line"><span class="lineno"> 1088</span>            }</div>
<div class="line"><span class="lineno"> 1089</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.is_small_overhang)</div>
<div class="line"><span class="lineno"> 1092</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1093</span> </div>
<div class="line"><span class="lineno"> 1094</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.layer_overhangs.begin(); it != <a class="code hl_function" href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">cluster</a>.layer_overhangs.end(); it++) {</div>
<div class="line"><span class="lineno"> 1095</span>                <span class="keywordtype">int</span>  layer_nr   = it-&gt;first;</div>
<div class="line"><span class="lineno"> 1096</span>                <span class="keyword">auto</span> p_overhang = it-&gt;second;</div>
<div class="line"><span class="lineno"> 1097</span>                blockers[layer_nr].push_back(p_overhang-&gt;contour);</div>
<div class="line"><span class="lineno"> 1098</span>            }</div>
<div class="line"><span class="lineno"> 1099</span>        }</div>
<div class="line"><span class="lineno"> 1100</span>    }</div>
<div class="line"><span class="lineno"> 1101</span> </div>
<div class="line"><span class="lineno"> 1102</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ab6ceca30741c916ae61fd99b6e2f000b">has_overhangs</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1103</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = 0; layer_nr &lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aea3e7f3fc4b46b4290105f655edcde47">layer_count</a>(); layer_nr++) {</div>
<div class="line"><span class="lineno"> 1104</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../dc/d88/class_slic3r_1_1_print_base.html#ab5f6b4781d433373200f5f328ebcb4a8">canceled</a>())</div>
<div class="line"><span class="lineno"> 1105</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1106</span> </div>
<div class="line"><span class="lineno"> 1107</span>        SupportLayer* ts_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>);</div>
<div class="line"><span class="lineno"> 1108</span>        <span class="keyword">auto</span> layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr);</div>
<div class="line"><span class="lineno"> 1109</span>        <span class="keyword">auto</span> lower_layer = layer-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#aff84b8f549804babf9ecaee1a49e260e">lower_layer</a>;</div>
<div class="line"><span class="lineno"> 1110</span>        <span class="keywordflow">if</span> (support_critical_regions_only &amp;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a6025cd9b54824e8bcac090b8f5d29337">is_auto</a>(stype)) {</div>
<div class="line"><span class="lineno"> 1111</span>            ts_layer-&gt;overhang_areas.clear();</div>
<div class="line"><span class="lineno"> 1112</span>            <span class="keywordflow">if</span> (lower_layer == <span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno"> 1113</span>                ts_layer-&gt;overhang_areas = layer-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#acf046a073310ad9d7868390519bd42a7">sharp_tails</a>;</div>
<div class="line"><span class="lineno"> 1114</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1115</span>                ts_layer-&gt;overhang_areas = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a2b1bfe9b50e13403d42de533b8a19916">diff_ex</a>(layer-&gt;sharp_tails, lower_layer-&gt;lslices);</div>
<div class="line"><span class="lineno"> 1116</span> </div>
<div class="line"><span class="lineno"> 1117</span>            <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5f240a84e573ed2d7785a439f4239e1a">append</a>(ts_layer-&gt;overhang_areas, layer-&gt;cantilevers);</div>
<div class="line"><span class="lineno"> 1118</span>        }</div>
<div class="line"><span class="lineno"> 1119</span> </div>
<div class="line"><span class="lineno"> 1120</span>        <span class="keywordflow">if</span> (layer_nr &lt; blockers.size()) {</div>
<div class="line"><span class="lineno"> 1121</span>            <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a>&amp; blocker = blockers[layer_nr];</div>
<div class="line"><span class="lineno"> 1122</span>            <span class="comment">// Arthur: union_ is a must because after mirroring, the blocker polygons are in left-hand coordinates, ie clockwise, </span></div>
<div class="line"><span class="lineno"> 1123</span>            <span class="comment">// which are not valid polygons, and will be removed by offset_ex. union_ can make these polygons right.</span></div>
<div class="line"><span class="lineno"> 1124</span>            ts_layer-&gt;overhang_areas = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a2b1bfe9b50e13403d42de533b8a19916">diff_ex</a>(ts_layer-&gt;overhang_areas, <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5e96c84b799b62906e4a46a94eb8916c">offset_ex</a>(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a015388ff0752a25649a975078f7a5431">union_</a>(blocker), <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(radius_sample_resolution)));</div>
<div class="line"><span class="lineno"> 1125</span>        }</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span>        <span class="keywordflow">if</span> (max_bridge_length &gt; 0 &amp;&amp; ts_layer-&gt;overhang_areas.size() &gt; 0 &amp;&amp; lower_layer) {</div>
<div class="line"><span class="lineno"> 1128</span>            <span class="comment">// do not break bridge for normal part in TreeHybrid</span></div>
<div class="line"><span class="lineno"> 1129</span>            <span class="keywordtype">bool</span> break_bridge = !(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aafc183d8390ddc4b2b7af16954628504">support_style</a> == <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#ac4444e117129d57974e96c39d6976a3ba2d0abf8e046fa487260fa805a652b9d5">smsTreeHybrid</a> &amp;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a58007b1077539ba492d56398b92fea70">area</a>(ts_layer-&gt;overhang_areas) &gt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#af4d2760e2fc64fbd954c6fefa926200e">thresh_big_overhang</a>);</div>
<div class="line"><span class="lineno"> 1130</span>            <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#ac551155879c0a33cd1ce835c99d2049e">remove_bridges_from_contacts</a>(lower_layer, layer, extrusion_width_scaled, &amp;ts_layer-&gt;overhang_areas, max_bridge_length, break_bridge);</div>
<div class="line"><span class="lineno"> 1131</span>        }</div>
<div class="line"><span class="lineno"> 1132</span> </div>
<div class="line"><span class="lineno"> 1133</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a58007b1077539ba492d56398b92fea70">area</a> : ts_layer-&gt;overhang_areas) {</div>
<div class="line"><span class="lineno"> 1134</span>            ts_layer-&gt;overhang_types.emplace(&amp;<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a58007b1077539ba492d56398b92fea70">area</a>, <a class="code hl_enumvalue" href="../../de/dad/class_slic3r_1_1_support_layer.html#aa5243471c16b51ef1ebc7f4b38cabbcca3869353538024929965c3878ebacd6aa">SupportLayer::Detected</a>);</div>
<div class="line"><span class="lineno"> 1135</span>        }</div>
<div class="line"><span class="lineno"> 1136</span>        <span class="comment">// enforcers now follow same logic as normal support. See STUDIO-3692</span></div>
<div class="line"><span class="lineno"> 1137</span>        <span class="keywordflow">if</span> (layer_nr &lt; enforcers.size() &amp;&amp; lower_layer) {</div>
<div class="line"><span class="lineno"> 1138</span>            <span class="keywordtype">float</span> no_interface_offset = std::accumulate(layer-&gt;regions().begin(), layer-&gt;regions().end(), FLT_MAX,</div>
<div class="line"><span class="lineno"> 1139</span>                [](<span class="keywordtype">float</span> acc, <span class="keyword">const</span> LayerRegion* layerm) { return std::min(acc, float(layerm-&gt;flow(frExternalPerimeter).scaled_width())); });</div>
<div class="line"><span class="lineno"> 1140</span>            <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a>  lower_layer_polygons = (layer_nr == 0) ? <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a>() : <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a843ba2fe16b213f550fb3d55c55a716e">to_polygons</a>(lower_layer-&gt;lslices);</div>
<div class="line"><span class="lineno"> 1141</span>            <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a>&amp; enforcer = enforcers[layer_nr];</div>
<div class="line"><span class="lineno"> 1142</span>            <span class="keywordflow">if</span> (!enforcer.empty()) {</div>
<div class="line"><span class="lineno"> 1143</span>                <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a> enforcer_polygons = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a2b1bfe9b50e13403d42de533b8a19916">diff_ex</a>(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a9853756af06b71590c902865926b8e28">intersection_ex</a>(layer-&gt;lslices, enforcer),</div>
<div class="line"><span class="lineno"> 1144</span>                    <span class="comment">// Inflate just a tiny bit to avoid intersection of the overhang areas with the object.</span></div>
<div class="line"><span class="lineno"> 1145</span>                    <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3139b5c30f46b41a991edc50308554f6">expand</a>(lower_layer_polygons, 0.05f * no_interface_offset, <a class="code hl_define" href="../../db/d63/_print_object_8cpp.html#a952c572f92c0eee8cc1866011a230243">SUPPORT_SURFACES_OFFSET_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 1146</span>                <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5f240a84e573ed2d7785a439f4239e1a">append</a>(ts_layer-&gt;overhang_areas, enforcer_polygons);</div>
<div class="line"><span class="lineno"> 1147</span>                ts_layer-&gt;overhang_types.emplace(&amp;ts_layer-&gt;overhang_areas.back(), <a class="code hl_enumvalue" href="../../de/dad/class_slic3r_1_1_support_layer.html#aa5243471c16b51ef1ebc7f4b38cabbccac5444b57223bf206553a8d6cd2b23916">SupportLayer::Enforced</a>);</div>
<div class="line"><span class="lineno"> 1148</span>            }</div>
<div class="line"><span class="lineno"> 1149</span>        }</div>
<div class="line"><span class="lineno"> 1150</span> </div>
<div class="line"><span class="lineno"> 1151</span>        <span class="keywordflow">if</span> (!ts_layer-&gt;overhang_areas.empty()) <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ab6ceca30741c916ae61fd99b6e2f000b">has_overhangs</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1152</span>        <span class="keywordflow">if</span> (!layer-&gt;cantilevers.empty()) <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ac79134cdc391e7219e62f2c69be76ad7">has_cantilever</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1153</span>    }</div>
<div class="line"><span class="lineno"> 1154</span> </div>
<div class="line"><span class="lineno"> 1155</span><span class="preprocessor">#ifdef SUPPORT_TREE_DEBUG_TO_SVG</span></div>
<div class="line"><span class="lineno"> 1156</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> SupportLayer* layer : <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;support_layers()) {</div>
<div class="line"><span class="lineno"> 1157</span>        <span class="keywordflow">if</span> (layer-&gt;overhang_areas.empty() &amp;&amp; (blockers.size()&lt;=layer-&gt;id() || blockers[layer-&gt;id()].empty()))</div>
<div class="line"><span class="lineno"> 1158</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1159</span> </div>
<div class="line"><span class="lineno"> 1160</span>        <a class="code hl_enumvalue" href="../../df/ddf/namespacelibnest2d.html#af597612c78e3eb318a885f34ddafa180acd15a75c26008696647b31a3f0de43b3">SVG</a> svg(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#ab28c13d286b2d1767d7c63b020ebd042">format</a>(<span class="stringliteral">&quot;SVG/overhang_areas_%s.svg&quot;</span>, layer-&gt;print_z), <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a571b601aadc8d8a24208e933bbd8704c">bounding_box</a>());</div>
<div class="line"><span class="lineno"> 1161</span>        <span class="keywordflow">if</span> (svg.is_opened()) {</div>
<div class="line"><span class="lineno"> 1162</span>            svg.draw_outline(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer-&gt;id())-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a3052da5e28b9b358d43ad43d7e9173ed">lslices</a>, <span class="stringliteral">&quot;yellow&quot;</span>);</div>
<div class="line"><span class="lineno"> 1163</span>            svg.draw(layer-&gt;overhang_areas, <span class="stringliteral">&quot;orange&quot;</span>);</div>
<div class="line"><span class="lineno"> 1164</span>            <span class="keywordflow">if</span> (blockers.size() &gt; layer-&gt;id())</div>
<div class="line"><span class="lineno"> 1165</span>                svg.draw(blockers[layer-&gt;id()], <span class="stringliteral">&quot;red&quot;</span>);</div>
<div class="line"><span class="lineno"> 1166</span>        }</div>
<div class="line"><span class="lineno"> 1167</span>        <span class="keywordflow">if</span> (enforcers.size() &gt; layer-&gt;id()) {</div>
<div class="line"><span class="lineno"> 1168</span>            <a class="code hl_enumvalue" href="../../df/ddf/namespacelibnest2d.html#af597612c78e3eb318a885f34ddafa180acd15a75c26008696647b31a3f0de43b3">SVG</a> svg(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#ab28c13d286b2d1767d7c63b020ebd042">format</a>(<span class="stringliteral">&quot;SVG/enforcer_%s.svg&quot;</span>, layer-&gt;print_z), <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a571b601aadc8d8a24208e933bbd8704c">bounding_box</a>());</div>
<div class="line"><span class="lineno"> 1169</span>            <span class="keywordflow">if</span> (svg.is_opened()) {</div>
<div class="line"><span class="lineno"> 1170</span>                svg.draw_outline(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer-&gt;id())-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a3052da5e28b9b358d43ad43d7e9173ed">lslices</a>, <span class="stringliteral">&quot;yellow&quot;</span>);</div>
<div class="line"><span class="lineno"> 1171</span>                svg.draw(enforcers[layer-&gt;id()], <span class="stringliteral">&quot;red&quot;</span>);</div>
<div class="line"><span class="lineno"> 1172</span>            }</div>
<div class="line"><span class="lineno"> 1173</span>        }</div>
<div class="line"><span class="lineno"> 1174</span>        <span class="keywordflow">if</span> (blockers.size() &gt; layer-&gt;id()) {</div>
<div class="line"><span class="lineno"> 1175</span>            <a class="code hl_enumvalue" href="../../df/ddf/namespacelibnest2d.html#af597612c78e3eb318a885f34ddafa180acd15a75c26008696647b31a3f0de43b3">SVG</a> svg(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#ab28c13d286b2d1767d7c63b020ebd042">format</a>(<span class="stringliteral">&quot;SVG/blocker_%s.svg&quot;</span>, layer-&gt;print_z), <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a571b601aadc8d8a24208e933bbd8704c">bounding_box</a>());</div>
<div class="line"><span class="lineno"> 1176</span>            <span class="keywordflow">if</span> (svg.is_opened()) {</div>
<div class="line"><span class="lineno"> 1177</span>                svg.draw_outline(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer-&gt;id())-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a3052da5e28b9b358d43ad43d7e9173ed">lslices</a>, <span class="stringliteral">&quot;yellow&quot;</span>);</div>
<div class="line"><span class="lineno"> 1178</span>                svg.draw(blockers[layer-&gt;id()], <span class="stringliteral">&quot;red&quot;</span>);</div>
<div class="line"><span class="lineno"> 1179</span>            }</div>
<div class="line"><span class="lineno"> 1180</span>        }</div>
<div class="line"><span class="lineno"> 1181</span>    }</div>
<div class="line"><span class="lineno"> 1182</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1183</span>}</div>
<div class="ttc" id="a_orient_8cpp_html_ac3644f84794a8bfdacf39c4b2c2495fc"><div class="ttname"><a href="../../db/d7c/_orient_8cpp.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a></div><div class="ttdeci">#define SQ(x)</div><div class="ttdef"><b>Definition</b> Orient.cpp:21</div></div>
<div class="ttc" id="a_print_object_8cpp_html_a952c572f92c0eee8cc1866011a230243"><div class="ttname"><a href="../../db/d63/_print_object_8cpp.html#a952c572f92c0eee8cc1866011a230243">SUPPORT_SURFACES_OFFSET_PARAMETERS</a></div><div class="ttdeci">#define SUPPORT_SURFACES_OFFSET_PARAMETERS</div><div class="ttdef"><b>Definition</b> PrintObject.cpp:2498</div></div>
<div class="ttc" id="aclass_slic3r_1_1_bounding_box_base_html_a2233d300d197f650b6fefa6ac1607203"><div class="ttname"><a href="../../dc/d28/class_slic3r_1_1_bounding_box_base.html#a2233d300d197f650b6fefa6ac1607203">Slic3r::BoundingBoxBase::size</a></div><div class="ttdeci">PointClass size() const</div><div class="ttdef"><b>Definition</b> BoundingBox.cpp:170</div></div>
<div class="ttc" id="aclass_slic3r_1_1_layer_html_a3052da5e28b9b358d43ad43d7e9173ed"><div class="ttname"><a href="../../d1/d68/class_slic3r_1_1_layer.html#a3052da5e28b9b358d43ad43d7e9173ed">Slic3r::Layer::lslices</a></div><div class="ttdeci">ExPolygons lslices</div><div class="ttdef"><b>Definition</b> Layer.hpp:148</div></div>
<div class="ttc" id="aclass_slic3r_1_1_layer_html_acf046a073310ad9d7868390519bd42a7"><div class="ttname"><a href="../../d1/d68/class_slic3r_1_1_layer.html#acf046a073310ad9d7868390519bd42a7">Slic3r::Layer::sharp_tails</a></div><div class="ttdeci">ExPolygons sharp_tails</div><div class="ttdef"><b>Definition</b> Layer.hpp:136</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_base_html_ab5f6b4781d433373200f5f328ebcb4a8"><div class="ttname"><a href="../../dc/d88/class_slic3r_1_1_print_base.html#ab5f6b4781d433373200f5f328ebcb4a8">Slic3r::PrintBase::canceled</a></div><div class="ttdeci">bool canceled() const</div><div class="ttdef"><b>Definition</b> PrintBase.hpp:496</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_a3b3906b04b6ef3f958b5cc95f4720a30"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#a3b3906b04b6ef3f958b5cc95f4720a30">Slic3r::PrintObject::project_and_append_custom_facets</a></div><div class="ttdeci">void project_and_append_custom_facets(bool seam, EnforcerBlockerType type, std::vector&lt; Polygons &gt; &amp;expolys) const</div><div class="ttdef"><b>Definition</b> PrintObject.cpp:2924</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_a5e5ccd90a04666a6a9525279b49c1908"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#a5e5ccd90a04666a6a9525279b49c1908">Slic3r::PrintObject::clear_support_layers</a></div><div class="ttdeci">void clear_support_layers()</div><div class="ttdef"><b>Definition</b> PrintObject.cpp:635</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_a714cf0166f39d8a016073e91affeeb54"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#a714cf0166f39d8a016073e91affeeb54">Slic3r::PrintObject::clear_tree_support_preview_cache</a></div><div class="ttdeci">void clear_tree_support_preview_cache()</div><div class="ttdef"><b>Definition</b> Print.hpp:377</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_a9d8f15c559b04e238ac1066bc20975ab"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#a9d8f15c559b04e238ac1066bc20975ab">Slic3r::PrintObject::slice_support_enforcers</a></div><div class="ttdeci">std::vector&lt; Polygons &gt; slice_support_enforcers() const</div><div class="ttdef"><b>Definition</b> Print.hpp:419</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_ac551155879c0a33cd1ce835c99d2049e"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#ac551155879c0a33cd1ce835c99d2049e">Slic3r::PrintObject::remove_bridges_from_contacts</a></div><div class="ttdeci">static void remove_bridges_from_contacts(const Layer *lower_layer, const Layer *current_layer, float extrusion_width, PolysType *overhang_regions, float max_bridge_length=scale_(10), bool break_bridge=false)</div><div class="ttdef"><b>Definition</b> PrintObject.cpp:2501</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_ad77e3d2fb551f8261f9298335a9a0ec5"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#ad77e3d2fb551f8261f9298335a9a0ec5">Slic3r::PrintObject::support_layer_count</a></div><div class="ttdeci">size_t support_layer_count() const</div><div class="ttdef"><b>Definition</b> Print.hpp:379</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_ad88e205a24924b8c8f9e3c74a1daf6fc"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#ad88e205a24924b8c8f9e3c74a1daf6fc">Slic3r::PrintObject::size</a></div><div class="ttdeci">const Vec3crd &amp; size() const</div><div class="ttdef"><b>Definition</b> Print.hpp:298</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_ae96af7161a2c596e832879eea8e95f5c"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#ae96af7161a2c596e832879eea8e95f5c">Slic3r::PrintObject::slice_support_blockers</a></div><div class="ttdeci">std::vector&lt; Polygons &gt; slice_support_blockers() const</div><div class="ttdef"><b>Definition</b> Print.hpp:418</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_aea3e7f3fc4b46b4290105f655edcde47"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#aea3e7f3fc4b46b4290105f655edcde47">Slic3r::PrintObject::layer_count</a></div><div class="ttdeci">size_t layer_count() const</div><div class="ttdef"><b>Definition</b> Print.hpp:353</div></div>
<div class="ttc" id="aclass_slic3r_1_1_support_layer_html_aa5243471c16b51ef1ebc7f4b38cabbcca3869353538024929965c3878ebacd6aa"><div class="ttname"><a href="../../de/dad/class_slic3r_1_1_support_layer.html#aa5243471c16b51ef1ebc7f4b38cabbcca3869353538024929965c3878ebacd6aa">Slic3r::SupportLayer::Detected</a></div><div class="ttdeci">@ Detected</div><div class="ttdef"><b>Definition</b> Layer.hpp:311</div></div>
<div class="ttc" id="aclass_slic3r_1_1_support_layer_html_aa5243471c16b51ef1ebc7f4b38cabbccac5444b57223bf206553a8d6cd2b23916"><div class="ttname"><a href="../../de/dad/class_slic3r_1_1_support_layer.html#aa5243471c16b51ef1ebc7f4b38cabbccac5444b57223bf206553a8d6cd2b23916">Slic3r::SupportLayer::Enforced</a></div><div class="ttdeci">@ Enforced</div><div class="ttdef"><b>Definition</b> Layer.hpp:311</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_ab5a8e24116c706a5471484c8ec730ad5"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#ab5a8e24116c706a5471484c8ec730ad5">Slic3r::TreeSupport::create_tree_support_layers</a></div><div class="ttdeci">void create_tree_support_layers()</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:1185</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_ab6ceca30741c916ae61fd99b6e2f000b"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#ab6ceca30741c916ae61fd99b6e2f000b">Slic3r::TreeSupport::has_overhangs</a></div><div class="ttdeci">bool has_overhangs</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:395</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_ac79134cdc391e7219e62f2c69be76ad7"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#ac79134cdc391e7219e62f2c69be76ad7">Slic3r::TreeSupport::has_cantilever</a></div><div class="ttdeci">bool has_cantilever</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:397</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_ad9a79d4d08f9c209973a02bf7293e2e6"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad9a79d4d08f9c209973a02bf7293e2e6">Slic3r::TreeSupport::max_cantilever_dist</a></div><div class="ttdeci">double max_cantilever_dist</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:398</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_aea51639c5c7e46181da9e0f45bbda696"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#aea51639c5c7e46181da9e0f45bbda696">Slic3r::TreeSupport::has_sharp_tails</a></div><div class="ttdeci">bool has_sharp_tails</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:396</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_af4d2760e2fc64fbd954c6fefa926200e"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#af4d2760e2fc64fbd954c6fefa926200e">Slic3r::TreeSupport::SupportParams::thresh_big_overhang</a></div><div class="ttdeci">const double thresh_big_overhang</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:390</div></div>
<div class="ttc" id="alibslic3r_8h_html_a5fbcba443134401cfa23255d3ce72cad"><div class="ttname"><a href="../../dd/d47/libslic3r_8h.html#a5fbcba443134401cfa23255d3ce72cad">g_config_tree_support_collision_resolution</a></div><div class="ttdeci">static constexpr float g_config_tree_support_collision_resolution</div><div class="ttdef"><b>Definition</b> libslic3r.h:93</div></div>
<div class="ttc" id="alibslic3r_8h_html_a7b0d40f9a8619b673f9ceea8de04661a"><div class="ttname"><a href="../../dd/d47/libslic3r_8h.html#a7b0d40f9a8619b673f9ceea8de04661a">g_config_support_sharp_tails</a></div><div class="ttdeci">static constexpr bool g_config_support_sharp_tails</div><div class="ttdef"><b>Definition</b> libslic3r.h:91</div></div>
<div class="ttc" id="alzoconf_8h_html_a809275ccd755fb7b88661d952134b14d"><div class="ttname"><a href="../../de/d38/lzoconf_8h.html#a809275ccd755fb7b88661d952134b14d">size</a></div><div class="ttdeci">lzo_uint size</div><div class="ttdef"><b>Definition</b> lzoconf.h:378</div></div>
<div class="ttc" id="anamespace_slic3r_1_1_geometry_html_a345f6f1e6238a364b20bdabac88a8314"><div class="ttname"><a href="../../d3/dfb/namespace_slic3r_1_1_geometry.html#a345f6f1e6238a364b20bdabac88a8314">Slic3r::Geometry::deg2rad</a></div><div class="ttdeci">constexpr T deg2rad(const T angle)</div><div class="ttdef"><b>Definition</b> Geometry.hpp:295</div></div>
<div class="ttc" id="anamespace_slic3r_1_1arrangement_html_a5b816dd05a95b740ac2194b643ceaacc"><div class="ttname"><a href="../../d0/d25/namespace_slic3r_1_1arrangement.html#a5b816dd05a95b740ac2194b643ceaacc">Slic3r::arrangement::height</a></div><div class="ttdeci">coord_t height(const BoundingBox &amp;box)</div><div class="ttdef"><b>Definition</b> Arrange.cpp:794</div></div>
<div class="ttc" id="anamespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03_html_aba0b164a780a5c2f6082883e9ae47bee"><div class="ttname"><a href="../../d2/d6f/namespace_slic3r_1_1sla_1_1anonymous__namespace_02_clustering_8cpp_03.html#aba0b164a780a5c2f6082883e9ae47bee">Slic3r::sla::anonymous_namespace{Clustering.cpp}::cluster</a></div><div class="ttdeci">ClusteredPoints cluster(Index3D &amp;sindex, unsigned max_points, std::function&lt; std::vector&lt; PointIndexEl &gt;(const Index3D &amp;, const PointIndexEl &amp;)&gt; qfn)</div><div class="ttdef"><b>Definition</b> Clustering.cpp:19</div></div>
<div class="ttc" id="anamespace_slic3r_html_a015388ff0752a25649a975078f7a5431"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a015388ff0752a25649a975078f7a5431">Slic3r::union_</a></div><div class="ttdeci">Slic3r::Polygons union_(const Slic3r::Polygons &amp;subject)</div><div class="ttdef"><b>Definition</b> ClipperUtils.cpp:690</div></div>
<div class="ttc" id="anamespace_slic3r_html_a15f6728115269978cc5e0a44c22479a8"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a15f6728115269978cc5e0a44c22479a8">Slic3r::area_thresh_well_supported</a></div><div class="ttdeci">static const double area_thresh_well_supported</div><div class="ttdef"><b>Definition</b> SupportMaterial.cpp:1525</div></div>
<div class="ttc" id="anamespace_slic3r_html_a2b1bfe9b50e13403d42de533b8a19916"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a2b1bfe9b50e13403d42de533b8a19916">Slic3r::diff_ex</a></div><div class="ttdeci">Slic3r::ExPolygons diff_ex(const Slic3r::Polygons &amp;subject, const Slic3r::Polygons &amp;clip, ApplySafetyOffset do_safety_offset)</div><div class="ttdef"><b>Definition</b> ClipperUtils.cpp:709</div></div>
<div class="ttc" id="anamespace_slic3r_html_a3139b5c30f46b41a991edc50308554f6"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a3139b5c30f46b41a991edc50308554f6">Slic3r::expand</a></div><div class="ttdeci">Slic3r::Polygons expand(const Slic3r::Polygon &amp;polygon, const float delta, ClipperLib::JoinType joinType=DefaultJoinType, double miterLimit=DefaultMiterLimit)</div><div class="ttdef"><b>Definition</b> ClipperUtils.hpp:361</div></div>
<div class="ttc" id="anamespace_slic3r_html_a37166e144522fceee41e6d8ed8245315"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a37166e144522fceee41e6d8ed8245315">Slic3r::union_ex</a></div><div class="ttdeci">Slic3r::ExPolygons union_ex(const Slic3r::Polygons &amp;subject, ClipperLib::PolyFillType fill_type)</div><div class="ttdef"><b>Definition</b> ClipperUtils.cpp:777</div></div>
<div class="ttc" id="anamespace_slic3r_html_a509efc840b8460ee975221330ef6d82f"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a509efc840b8460ee975221330ef6d82f">Slic3r::length_thresh_well_supported</a></div><div class="ttdeci">static const double length_thresh_well_supported</div><div class="ttdef"><b>Definition</b> SupportMaterial.cpp:1524</div></div>
<div class="ttc" id="anamespace_slic3r_html_a517930244d210021577457148f9a49e3"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">Slic3r::ExPolygons</a></div><div class="ttdeci">std::vector&lt; ExPolygon &gt; ExPolygons</div><div class="ttdef"><b>Definition</b> ExPolygon.hpp:13</div></div>
<div class="ttc" id="anamespace_slic3r_html_a51e1ea9708d6434aae1e8394bef8acdc"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a51e1ea9708d6434aae1e8394bef8acdc">Slic3r::range</a></div><div class="ttdeci">auto range(Cont &amp;&amp;cont)</div><div class="ttdef"><b>Definition</b> libslic3r.h:374</div></div>
<div class="ttc" id="anamespace_slic3r_html_a58007b1077539ba492d56398b92fea70"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a58007b1077539ba492d56398b92fea70">Slic3r::area</a></div><div class="ttdeci">double area(const ExPolygon &amp;poly)</div><div class="ttdef"><b>Definition</b> ExPolygon.hpp:470</div></div>
<div class="ttc" id="anamespace_slic3r_html_a5ce80416d9bd655d2fb946edf0f602f0a66623df40a88662bfd8a271edb488841"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a5ce80416d9bd655d2fb946edf0f602f0a66623df40a88662bfd8a271edb488841">Slic3r::EnforcerBlockerType::ENFORCER</a></div><div class="ttdeci">@ ENFORCER</div></div>
<div class="ttc" id="anamespace_slic3r_html_a5ce80416d9bd655d2fb946edf0f602f0a95a95df0c5337385356cd00cbd59a000"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a5ce80416d9bd655d2fb946edf0f602f0a95a95df0c5337385356cd00cbd59a000">Slic3r::EnforcerBlockerType::BLOCKER</a></div><div class="ttdeci">@ BLOCKER</div></div>
<div class="ttc" id="anamespace_slic3r_html_a5e96c84b799b62906e4a46a94eb8916c"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a5e96c84b799b62906e4a46a94eb8916c">Slic3r::offset_ex</a></div><div class="ttdeci">Slic3r::ExPolygons offset_ex(const Slic3r::Polygons &amp;polygons, const float delta, ClipperLib::JoinType joinType, double miterLimit)</div><div class="ttdef"><b>Definition</b> ClipperUtils.cpp:409</div></div>
<div class="ttc" id="anamespace_slic3r_html_a5ec552d076296fd705739c608edc1580"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a5ec552d076296fd705739c608edc1580">Slic3r::offset</a></div><div class="ttdeci">Slic3r::Polygons offset(const Slic3r::Polygon &amp;polygon, const float delta, ClipperLib::JoinType joinType, double miterLimit)</div><div class="ttdef"><b>Definition</b> ClipperUtils.cpp:404</div></div>
<div class="ttc" id="anamespace_slic3r_html_a5f240a84e573ed2d7785a439f4239e1a"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a5f240a84e573ed2d7785a439f4239e1a">Slic3r::append</a></div><div class="ttdeci">void append(std::vector&lt; T &gt; &amp;dest, const std::vector&lt; T &gt; &amp;src)</div><div class="ttdef"><b>Definition</b> libslic3r.h:132</div></div>
<div class="ttc" id="anamespace_slic3r_html_a6025cd9b54824e8bcac090b8f5d29337"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a6025cd9b54824e8bcac090b8f5d29337">Slic3r::is_auto</a></div><div class="ttdeci">bool is_auto(SupportType stype)</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:123</div></div>
<div class="ttc" id="anamespace_slic3r_html_a6e3ba75aef7600dbb0a294a47d88ecb8"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a6e3ba75aef7600dbb0a294a47d88ecb8">Slic3r::get_extents</a></div><div class="ttdeci">BoundingBox get_extents(const ExPolygon &amp;expolygon)</div><div class="ttdef"><b>Definition</b> ExPolygon.cpp:386</div></div>
<div class="ttc" id="anamespace_slic3r_html_a83fc268888773d5c0f886fc2e54b8c64"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a83fc268888773d5c0f886fc2e54b8c64">Slic3r::empty</a></div><div class="ttdeci">bool empty(const BoundingBoxBase&lt; VT &gt; &amp;bb)</div><div class="ttdef"><b>Definition</b> BoundingBox.hpp:241</div></div>
<div class="ttc" id="anamespace_slic3r_html_a843ba2fe16b213f550fb3d55c55a716e"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a843ba2fe16b213f550fb3d55c55a716e">Slic3r::to_polygons</a></div><div class="ttdeci">Polygons to_polygons(const ExPolygon &amp;src)</div><div class="ttdef"><b>Definition</b> ExPolygon.hpp:280</div></div>
<div class="ttc" id="anamespace_slic3r_html_a852e19ab281b44709b3c5a3779c9c4cf"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a852e19ab281b44709b3c5a3779c9c4cf">Slic3r::sharp_tail_max_support_height</a></div><div class="ttdeci">static const double sharp_tail_max_support_height</div><div class="ttdef"><b>Definition</b> SupportMaterial.cpp:1528</div></div>
<div class="ttc" id="anamespace_slic3r_html_a9853756af06b71590c902865926b8e28"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a9853756af06b71590c902865926b8e28">Slic3r::intersection_ex</a></div><div class="ttdeci">Slic3r::ExPolygons intersection_ex(const Slic3r::Polygons &amp;subject, const Slic3r::Polygons &amp;clip, ApplySafetyOffset do_safety_offset)</div><div class="ttdef"><b>Definition</b> ClipperUtils.cpp:752</div></div>
<div class="ttc" id="anamespace_slic3r_html_aaaabcf9acc53536eede4610d1218434c"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#aaaabcf9acc53536eede4610d1218434c">Slic3r::SupportType</a></div><div class="ttdeci">SupportType</div><div class="ttdef"><b>Definition</b> PrintConfig.hpp:112</div></div>
<div class="ttc" id="anamespace_slic3r_html_ab28c13d286b2d1767d7c63b020ebd042"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#ab28c13d286b2d1767d7c63b020ebd042">Slic3r::format</a></div><div class="ttdeci">std::string format(const char *fmt, TArgs &amp;&amp;... args)</div><div class="ttdef"><b>Definition</b> format.hpp:44</div></div>
<div class="ttc" id="anamespace_slic3r_html_ac054ee91b47bfcb7c5e12ff3344c6153"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#ac054ee91b47bfcb7c5e12ff3344c6153">Slic3r::overlaps</a></div><div class="ttdeci">bool overlaps(const ExPolygons &amp;expolys1, const ExPolygons &amp;expolys2)</div><div class="ttdef"><b>Definition</b> ExPolygon.cpp:177</div></div>
<div class="ttc" id="anamespacelibnest2d_1_1shapelike_html_ab29201ea713e88d9d709ae4fa8f2576f"><div class="ttname"><a href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#ab29201ea713e88d9d709ae4fa8f2576f">libnest2d::shapelike::offset</a></div><div class="ttdeci">void offset(Slic3r::ExPolygon &amp;sh, coord_t distance, const PolygonTag &amp;)</div><div class="ttdef"><b>Definition</b> geometries.hpp:132</div></div>
<div class="ttc" id="anamespacelibnest2d_1_1shapelike_html_ae980d1aae4595291ca4eb978e66c4834"><div class="ttname"><a href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#ae980d1aae4595291ca4eb978e66c4834">libnest2d::shapelike::intersects</a></div><div class="ttdeci">bool intersects(const S &amp;, const S &amp;)</div><div class="ttdef"><b>Definition</b> geometry_traits.hpp:677</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l01525">Slic3r::area_thresh_well_supported</a>, <a class="el" href="../../#l00635">Slic3r::PrintObject::clear_support_layers()</a>, <a class="el" href="../../#l00377">Slic3r::PrintObject::clear_tree_support_preview_cache()</a>, <a class="el" href="../../#l00299">Slic3r::PrintObject::config()</a>, <a class="el" href="../../#l00740">Slic3r::Print::config()</a>, <a class="el" href="../../#l01185">create_tree_support_layers()</a>, <a class="el" href="../../#l00295">Slic3r::Geometry::deg2rad()</a>, <a class="el" href="../../#l00052">EPSILON</a>, <a class="el" href="../../#l00093">g_config_tree_support_collision_resolution</a>, <a class="el" href="../../#l00386">Slic3r::get_extents()</a>, <a class="el" href="../../#l00115">Slic3r::is_tree()</a>, <a class="el" href="../../#l00353">Slic3r::PrintObject::layer_count()</a>, <a class="el" href="../../#l01524">Slic3r::length_thresh_well_supported</a>, <a class="el" href="../../#l00412">m_object</a>, <a class="el" href="../../#l00398">max_cantilever_dist</a>, <a class="el" href="../../#l00067">Slic3r::BoundingBoxBase&lt; PointClass &gt;::merge()</a>, <a class="el" href="../../#l00404">Slic3r::offset()</a>, <a class="el" href="../../#l00409">Slic3r::offset_ex()</a>, <a class="el" href="../../#l00069">Slic3r::BoundingBoxBase&lt; PointClass &gt;::overlap()</a>, <a class="el" href="../../#l00177">Slic3r::overlaps()</a>, <a class="el" href="../../#l00625">Slic3r::PrintObjectBaseWithState&lt; PrintType, PrintObjectStepEnum, COUNT &gt;::print()</a>, <a class="el" href="../../#l01047">Slic3r::PrintObjectConfig</a>, <a class="el" href="../../#l00374">Slic3r::range()</a>, <a class="el" href="../../#l00081">scale_</a>, <a class="el" href="../../#l01528">Slic3r::sharp_tail_max_support_height</a>, <a class="el" href="../../#l00298">Slic3r::PrintObject::size()</a>, <a class="el" href="../../#l00021">SQ</a>, <a class="el" href="../../#l00379">Slic3r::PrintObject::support_layer_count()</a>, <a class="el" href="../../#l00399">support_type</a>, and <a class="el" href="../../#l00777">Slic3r::union_ex()</a>.</p>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_abee402a4a54cce95519d410554b75444_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a5bf8f77ce79d4b92e7a2b28d96e2ffea" name="a5bf8f77ce79d4b92e7a2b28d96e2ffea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bf8f77ce79d4b92e7a2b28d96e2ffea">&#9670;&#160;</a></span>draw_circles()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> Slic3r::TreeSupport::draw_circles </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>contact_nodes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Draws circles around each node of the tree into the final support. </p>
<p>This also handles the areas that have to become support roof, support bottom, the Z distances, etc.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">storage[in,out]</td><td>The settings storage to get settings from and to save the resulting support polygons to. </td></tr>
    <tr><td class="paramname">contact_nodes</td><td>The nodes to draw as support. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno"> 2079</span>{</div>
<div class="line"><span class="lineno"> 2080</span>    <span class="keyword">const</span> <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#ad48b86fa8e529e56c6bd00ff2f9839ab">PrintObjectConfig</a> &amp;config = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#abde3ac4f19e1f9d342423a7643e17266">config</a>();</div>
<div class="line"><span class="lineno"> 2081</span>    <span class="keyword">const</span> Print* print = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>();</div>
<div class="line"><span class="lineno"> 2082</span>    <span class="keywordtype">bool</span> has_brim = print-&gt;<a class="code hl_function" href="../../d5/d8f/class_slic3r_1_1_print.html#aa7f10f89d76a1cf3d2d55e4c477a26e6">has_brim</a>();</div>
<div class="line"><span class="lineno"> 2083</span>    <span class="keywordtype">int</span> bottom_gap_layers = <a class="code hl_function" href="../../d4/df0/_array_cwise_unary_ops_8h.html#ac805f9c4e64d7f48898ac876c0a541e7">round</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a6127b2a51f4a1e1a7aefc70d6677f7e7">gap_object_support</a> / <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a4e9e7e96af55db823c04201bee40292e">layer_height</a>);</div>
<div class="line"><span class="lineno"> 2084</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> branch_radius = config.tree_support_branch_diameter.value / 2;</div>
<div class="line"><span class="lineno"> 2085</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> branch_radius_scaled = <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(branch_radius);</div>
<div class="line"><span class="lineno"> 2086</span>    <span class="keywordtype">bool</span> on_buildplate_only = config.support_on_build_plate_only.value;</div>
<div class="line"><span class="lineno"> 2087</span>    <a class="code hl_enumvalue" href="../../d5/dd8/namespace_clipper2_lib.html#ae11c4d64b0c006fdcb85278a8d4a414ea4c0a11247d92f73fb84baa51e37a3263">Polygon</a> branch_circle; <span class="comment">//Pre-generate a circle with correct diameter so that we don&#39;t have to recompute those (co)sines every time.</span></div>
<div class="line"><span class="lineno"> 2088</span> </div>
<div class="line"><span class="lineno"> 2089</span>    <span class="comment">// Use square support if there are too many nodes per layer because circle support needs much longer time to compute</span></div>
<div class="line"><span class="lineno"> 2090</span>    <span class="comment">// Hower circle support can be printed faster, so we prefer circle for fewer nodes case.</span></div>
<div class="line"><span class="lineno"> 2091</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> SQUARE_SUPPORT = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a87bcd1a50c69642adfbd467a7256c23d">avg_node_per_layer</a> &gt; 200;    </div>
<div class="line"><span class="lineno"> 2092</span>    <span class="keyword">const</span> <span class="keywordtype">int</span>  CIRCLE_RESOLUTION = SQUARE_SUPPORT ? 4 : 100; <span class="comment">// The number of vertices in each circle.</span></div>
<div class="line"><span class="lineno"> 2093</span> </div>
<div class="line"><span class="lineno"> 2094</span> </div>
<div class="line"><span class="lineno"> 2095</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; CIRCLE_RESOLUTION; i++)</div>
<div class="line"><span class="lineno"> 2096</span>    {</div>
<div class="line"><span class="lineno"> 2097</span>        <span class="keywordtype">double</span> <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">angle</a>;</div>
<div class="line"><span class="lineno"> 2098</span>        <span class="keywordflow">if</span> (SQUARE_SUPPORT)</div>
<div class="line"><span class="lineno"> 2099</span>            <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">angle</a> = (double) i / CIRCLE_RESOLUTION * <a class="code hl_define" href="../../dd/dff/_tree_support_8cpp.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a> + <a class="code hl_define" href="../../d4/d08/rboxlib_8c.html#a598a3330b3c21701223ee0ca14316eca">PI</a> / 4.0 + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4453aaa97f66b4d66f47d534979ee149">nodes_angle</a>;</div>
<div class="line"><span class="lineno"> 2100</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2101</span>            <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">angle</a> = (double) i / CIRCLE_RESOLUTION * <a class="code hl_define" href="../../dd/dff/_tree_support_8cpp.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a>;</div>
<div class="line"><span class="lineno"> 2102</span>        branch_circle.append(<a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(<a class="code hl_function" href="../../d4/df0/_array_cwise_unary_ops_8h.html#a92b03396990b0e9eea0731aa406e31a4">cos</a>(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">angle</a>) * branch_radius_scaled, <a class="code hl_function" href="../../d4/df0/_array_cwise_unary_ops_8h.html#a9cfb0ea58bd813510a9e2db18a5e49f0">sin</a>(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">angle</a>) * branch_radius_scaled));</div>
<div class="line"><span class="lineno"> 2103</span>    }</div>
<div class="line"><span class="lineno"> 2104</span> </div>
<div class="line"><span class="lineno"> 2105</span>    <span class="comment">// Performance optimization. Only generate lslices for brim and skirt.</span></div>
<div class="line"><span class="lineno"> 2106</span>    <span class="keywordtype">size_t</span> brim_skirt_layers = has_brim ? 1 : 0;</div>
<div class="line"><span class="lineno"> 2107</span>    <span class="keyword">const</span> PrintConfig&amp; print_config = print-&gt;config();</div>
<div class="line"><span class="lineno"> 2108</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> PrintObject* <span class="keywordtype">object</span> : print-&gt;objects())</div>
<div class="line"><span class="lineno"> 2109</span>    {</div>
<div class="line"><span class="lineno"> 2110</span>        <span class="keywordtype">size_t</span> skirt_layers = print-&gt;has_infinite_skirt() ? <span class="keywordtype">object</span>-&gt;layer_count() : std::min(<span class="keywordtype">size_t</span>(print_config.skirt_height.value), <a class="code hl_enumvalue" href="../../dc/df0/namespacenlohmann_1_1detail.html#a1ed8fc6239da25abcaf681d30ace4985aa8cfde6331bd59eb2ac96f8911c4b666">object</a>-&gt;layer_count());</div>
<div class="line"><span class="lineno"> 2111</span>        brim_skirt_layers = std::max(brim_skirt_layers, skirt_layers);</div>
<div class="line"><span class="lineno"> 2112</span>    }</div>
<div class="line"><span class="lineno"> 2113</span> </div>
<div class="line"><span class="lineno"> 2114</span>    <span class="comment">// generate areas</span></div>
<div class="line"><span class="lineno"> 2115</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a> = config.layer_height.value;</div>
<div class="line"><span class="lineno"> 2116</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span>   top_interface_layers = config.support_interface_top_layers.value;</div>
<div class="line"><span class="lineno"> 2117</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span>   bottom_interface_layers = config.support_interface_bottom_layers.value;</div>
<div class="line"><span class="lineno"> 2118</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> diameter_angle_scale_factor = <a class="code hl_function" href="../../d4/df0/_array_cwise_unary_ops_8h.html#a0c32a3874bfc5438d11b75c9f40256d1">tan</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ac2482e1ff17824c9f85615be4188049e">tree_support_branch_diameter_angle</a> * <a class="code hl_define" href="../../de/ddd/_extrusion_simulator_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180.);<span class="comment">// * layer_height / branch_radius; //Scale factor per layer to produce the desired angle.</span></div>
<div class="line"><span class="lineno"> 2119</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> nozzle_diameter = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../d5/d8f/class_slic3r_1_1_print.html#af1937a680d19c7dd8d3c24e5ff7332b8">config</a>().nozzle_diameter.get_at(0);</div>
<div class="line"><span class="lineno"> 2120</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> line_width = config.get_abs_value(<span class="stringliteral">&quot;support_line_width&quot;</span>, nozzle_diameter);</div>
<div class="line"><span class="lineno"> 2121</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> line_width_scaled           = <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(line_width);</div>
<div class="line"><span class="lineno"> 2122</span> </div>
<div class="line"><span class="lineno"> 2123</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> with_lightning_infill = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0b57348bdfe4441d2eae6348b9910789">base_fill_pattern</a> == <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391faed23767b6563b5210ab79edf529e963f">ipLightning</a>;</div>
<div class="line"><span class="lineno"> 2124</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> support_extrusion_width = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa0479aee3f9b52bd26f72c7f94ee4dc0">support_extrusion_width</a>;</div>
<div class="line"><span class="lineno"> 2125</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> wall_count = config.tree_support_wall_count.value;</div>
<div class="line"><span class="lineno"> 2126</span> </div>
<div class="line"><span class="lineno"> 2127</span>    <span class="keyword">const</span> <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#ad48b86fa8e529e56c6bd00ff2f9839ab">PrintObjectConfig</a>&amp; object_config = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#abde3ac4f19e1f9d342423a7643e17266">config</a>();</div>
<div class="line"><span class="lineno"> 2128</span>    BOOST_LOG_TRIVIAL(info) &lt;&lt; <span class="stringliteral">&quot;draw_circles for object: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../dd/d44/class_slic3r_1_1_print_object_base.html#a2bb6df50398e4bff40ea23238264d1ee">model_object</a>()-&gt;<a class="code hl_variable" href="../../d0/d23/class_slic3r_1_1_model_object.html#a3fe28b2958454b2b84f805d458c1d5ca">name</a>;</div>
<div class="line"><span class="lineno"> 2129</span> </div>
<div class="line"><span class="lineno"> 2130</span>    <span class="comment">// coconut: previously std::unordered_map in m_collision_cache is not multi-thread safe which may cause programs stuck, here we change to tbb::concurrent_unordered_map</span></div>
<div class="line"><span class="lineno"> 2131</span>    tbb::parallel_for(</div>
<div class="line"><span class="lineno"> 2132</span>        tbb::blocked_range&lt;size_t&gt;(0, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aea3e7f3fc4b46b4290105f655edcde47">layer_count</a>()),</div>
<div class="line"><span class="lineno"> 2133</span>        [&amp;](<span class="keyword">const</span> tbb::blocked_range&lt;size_t&gt;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a51e1ea9708d6434aae1e8394bef8acdc">range</a>)</div>
<div class="line"><span class="lineno"> 2134</span>        {</div>
<div class="line"><span class="lineno"> 2135</span>            for (size_t layer_nr = range.begin(); layer_nr &lt; range.end(); layer_nr++)</div>
<div class="line"><span class="lineno"> 2136</span>            {</div>
<div class="line"><span class="lineno"> 2137</span>                if (print-&gt;canceled())</div>
<div class="line"><span class="lineno"> 2138</span>                    break;</div>
<div class="line"><span class="lineno"> 2139</span> </div>
<div class="line"><span class="lineno"> 2140</span>                const std::vector&lt;Node*&gt;&amp; curr_layer_nodes = contact_nodes[layer_nr];</div>
<div class="line"><span class="lineno"> 2141</span>                SupportLayer* ts_layer = m_object-&gt;get_support_layer(layer_nr + m_raft_layers);</div>
<div class="line"><span class="lineno"> 2142</span>                assert(ts_layer != nullptr);</div>
<div class="line"><span class="lineno"> 2143</span> </div>
<div class="line"><span class="lineno"> 2144</span>                <span class="comment">// skip if current layer has no points. This fixes potential crash in get_collision (see jira BBL001-355)</span></div>
<div class="line"><span class="lineno"> 2145</span>                if (curr_layer_nodes.empty()) {</div>
<div class="line"><span class="lineno"> 2146</span>                    ts_layer-&gt;print_z = 0.0;</div>
<div class="line"><span class="lineno"> 2147</span>                    ts_layer-&gt;height = 0.0;</div>
<div class="line"><span class="lineno"> 2148</span>                    continue;</div>
<div class="line"><span class="lineno"> 2149</span>                }</div>
<div class="line"><span class="lineno"> 2150</span> </div>
<div class="line"><span class="lineno"> 2151</span>                Node* first_node = curr_layer_nodes.front();</div>
<div class="line"><span class="lineno"> 2152</span>                ts_layer-&gt;print_z = first_node-&gt;print_z;</div>
<div class="line"><span class="lineno"> 2153</span>                ts_layer-&gt;height = first_node-&gt;height;</div>
<div class="line"><span class="lineno"> 2154</span>                if (ts_layer-&gt;height &lt; EPSILON) {</div>
<div class="line"><span class="lineno"> 2155</span>                    continue;</div>
<div class="line"><span class="lineno"> 2156</span>                }</div>
<div class="line"><span class="lineno"> 2157</span> </div>
<div class="line"><span class="lineno"> 2158</span>                ExPolygons&amp; base_areas = ts_layer-&gt;base_areas;</div>
<div class="line"><span class="lineno"> 2159</span>                ExPolygons&amp; roof_areas = ts_layer-&gt;roof_areas;</div>
<div class="line"><span class="lineno"> 2160</span>                ExPolygons&amp; roof_1st_layer = ts_layer-&gt;roof_1st_layer;</div>
<div class="line"><span class="lineno"> 2161</span>                ExPolygons&amp; floor_areas = ts_layer-&gt;floor_areas;</div>
<div class="line"><span class="lineno"> 2162</span>                ExPolygons&amp; roof_gap_areas = ts_layer-&gt;roof_gap_areas;</div>
<div class="line"><span class="lineno"> 2163</span>                coordf_t         max_layers_above_base = 0;</div>
<div class="line"><span class="lineno"> 2164</span>                coordf_t         max_layers_above_roof = 0;</div>
<div class="line"><span class="lineno"> 2165</span>                coordf_t         max_layers_above_roof1 = 0;</div>
<div class="line"><span class="lineno"> 2166</span>                bool has_polygon_node = false;</div>
<div class="line"><span class="lineno"> 2167</span>                bool has_circle_node = false;</div>
<div class="line"><span class="lineno"> 2168</span> </div>
<div class="line"><span class="lineno"> 2169</span>                BOOST_LOG_TRIVIAL(debug) &lt;&lt; <span class="stringliteral">&quot;circles at layer &quot;</span> &lt;&lt; layer_nr &lt;&lt; <span class="stringliteral">&quot; contact nodes size=&quot;</span> &lt;&lt; contact_nodes[layer_nr].size();</div>
<div class="line"><span class="lineno"> 2170</span>                <span class="comment">//Draw the support areas and add the roofs appropriately to the support roof instead of normal areas.</span></div>
<div class="line"><span class="lineno"> 2171</span>                ts_layer-&gt;lslices.reserve(contact_nodes[layer_nr].size());</div>
<div class="line"><span class="lineno"> 2172</span>                for (const Node* p_node : contact_nodes[layer_nr])</div>
<div class="line"><span class="lineno"> 2173</span>                {</div>
<div class="line"><span class="lineno"> 2174</span>                    if (print-&gt;canceled())</div>
<div class="line"><span class="lineno"> 2175</span>                        break;</div>
<div class="line"><span class="lineno"> 2176</span> </div>
<div class="line"><span class="lineno"> 2177</span>                    const Node&amp; node = *p_node;</div>
<div class="line"><span class="lineno"> 2178</span>                    ExPolygons area;</div>
<div class="line"><span class="lineno"> 2179</span>                    <span class="comment">// Generate directly from overhang polygon if one of the following is true:</span></div>
<div class="line"><span class="lineno"> 2180</span>                    <span class="comment">// 1) node is a normal part of hybrid support</span></div>
<div class="line"><span class="lineno"> 2181</span>                    <span class="comment">// 2) node is virtual</span></div>
<div class="line"><span class="lineno"> 2182</span>                    if (node.type == ePolygon || node.distance_to_top&lt;0) {</div>
<div class="line"><span class="lineno"> 2183</span>                        if (node.overhang-&gt;contour.size() &gt; 100 || node.overhang-&gt;holes.size()&gt;1)</div>
<div class="line"><span class="lineno"> 2184</span>                            area.emplace_back(*node.overhang);</div>
<div class="line"><span class="lineno"> 2185</span>                        else {</div>
<div class="line"><span class="lineno"> 2186</span>                            area = offset_ex({ *node.overhang }, scale_(m_ts_data-&gt;m_xy_distance));</div>
<div class="line"><span class="lineno"> 2187</span>                        }</div>
<div class="line"><span class="lineno"> 2188</span>                        if (node.type == ePolygon)</div>
<div class="line"><span class="lineno"> 2189</span>                            has_polygon_node = true;</div>
<div class="line"><span class="lineno"> 2190</span>                    }</div>
<div class="line"><span class="lineno"> 2191</span>                    else {</div>
<div class="line"><span class="lineno"> 2192</span>                        Polygon circle;</div>
<div class="line"><span class="lineno"> 2193</span>                        size_t layers_to_top = node.distance_to_top;</div>
<div class="line"><span class="lineno"> 2194</span>                        double  scale = calc_branch_radius(branch_radius, node.dist_mm_to_top, diameter_angle_scale_factor) / branch_radius;</div>
<div class="line"><span class="lineno"> 2195</span> </div>
<div class="line"><span class="lineno"> 2196</span>                        if (<span class="comment">/*is_slim*/</span>1) { <span class="comment">// draw ellipse along movement direction</span></div>
<div class="line"><span class="lineno"> 2197</span>                            double moveX = node.movement.x() / (scale * branch_radius_scaled);</div>
<div class="line"><span class="lineno"> 2198</span>                            double moveY = node.movement.y() / (scale * branch_radius_scaled);</div>
<div class="line"><span class="lineno"> 2199</span>                            const double vsize_inv = 0.5 / (0.01 + std::sqrt(moveX * moveX + moveY * moveY));</div>
<div class="line"><span class="lineno"> 2200</span>                            double       matrix[2*2]  = {</div>
<div class="line"><span class="lineno"> 2201</span>                                scale * (1 + moveX * moveX * vsize_inv),scale * (0 + moveX * moveY * vsize_inv),</div>
<div class="line"><span class="lineno"> 2202</span>                                scale * (0 + moveX * moveY * vsize_inv),scale * (1 + moveY * moveY * vsize_inv),</div>
<div class="line"><span class="lineno"> 2203</span>                            };</div>
<div class="line"><span class="lineno"> 2204</span>                            for (auto vertex: branch_circle.points) {</div>
<div class="line"><span class="lineno"> 2205</span>                                vertex = Point(matrix[0] * vertex.x() + matrix[1] * vertex.y(), matrix[2] * vertex.x() + matrix[3] * vertex.y());</div>
<div class="line"><span class="lineno"> 2206</span>                                circle.append(node.position + vertex);</div>
<div class="line"><span class="lineno"> 2207</span>                            }</div>
<div class="line"><span class="lineno"> 2208</span>                        } else {</div>
<div class="line"><span class="lineno"> 2209</span>                            for (auto iter = branch_circle.points.begin(); iter != branch_circle.points.end(); iter++) {</div>
<div class="line"><span class="lineno"> 2210</span>                                Point corner = (*iter) * scale;</div>
<div class="line"><span class="lineno"> 2211</span>                                circle.append(node.position + corner);</div>
<div class="line"><span class="lineno"> 2212</span>                            }</div>
<div class="line"><span class="lineno"> 2213</span>                        }</div>
<div class="line"><span class="lineno"> 2214</span>                        if (layer_nr == 0 &amp;&amp; m_raft_layers == 0) {</div>
<div class="line"><span class="lineno"> 2215</span>                            double brim_width =</div>
<div class="line"><span class="lineno"> 2216</span>                                config.tree_support_auto_brim</div>
<div class="line"><span class="lineno"> 2217</span>                                    ? layers_to_top * layer_height /</div>
<div class="line"><span class="lineno"> 2218</span>                                          (scale * branch_radius) * 0.5</div>
<div class="line"><span class="lineno"> 2219</span>                                    : config.tree_support_brim_width;</div>
<div class="line"><span class="lineno"> 2220</span>                            circle = offset(circle, scale_(brim_width))[0];</div>
<div class="line"><span class="lineno"> 2221</span>                        }</div>
<div class="line"><span class="lineno"> 2222</span>                        area.emplace_back(ExPolygon(circle));</div>
<div class="line"><span class="lineno"> 2223</span>                        <span class="comment">// merge overhang to get a smoother interface surface</span></div>
<div class="line"><span class="lineno"> 2224</span>                        <span class="comment">// Do not merge when buildplate_only is on, because some underneath nodes may have been deleted.</span></div>
<div class="line"><span class="lineno"> 2225</span>                        if (top_interface_layers &gt; 0 &amp;&amp; node.support_roof_layers_below &gt; 0 &amp;&amp; !on_buildplate_only) {</div>
<div class="line"><span class="lineno"> 2226</span>                            ExPolygons overhang_expanded;</div>
<div class="line"><span class="lineno"> 2227</span>                            if (node.overhang-&gt;contour.size() &gt; 100 || node.overhang-&gt;holes.size()&gt;1)</div>
<div class="line"><span class="lineno"> 2228</span>                                overhang_expanded.emplace_back(*node.overhang);</div>
<div class="line"><span class="lineno"> 2229</span>                            else {</div>
<div class="line"><span class="lineno"> 2230</span>                                <span class="comment">// 对于有缺陷的模型，overhang膨胀以后可能是空的！</span></div>
<div class="line"><span class="lineno"> 2231</span>                                overhang_expanded = offset_ex({ *node.overhang }, scale_(m_ts_data-&gt;m_xy_distance));</div>
<div class="line"><span class="lineno"> 2232</span>                            }</div>
<div class="line"><span class="lineno"> 2233</span>                            append(area, overhang_expanded);</div>
<div class="line"><span class="lineno"> 2234</span>                        }</div>
<div class="line"><span class="lineno"> 2235</span>                        has_circle_node = true;</div>
<div class="line"><span class="lineno"> 2236</span>                    }</div>
<div class="line"><span class="lineno"> 2237</span> </div>
<div class="line"><span class="lineno"> 2238</span>                    if (node.distance_to_top &lt; 0)</div>
<div class="line"><span class="lineno"> 2239</span>                        append(roof_gap_areas, area);</div>
<div class="line"><span class="lineno"> 2240</span>                    else if (node.support_roof_layers_below == 1)</div>
<div class="line"><span class="lineno"> 2241</span>                    {</div>
<div class="line"><span class="lineno"> 2242</span>                        append(roof_1st_layer, area);</div>
<div class="line"><span class="lineno"> 2243</span>                        max_layers_above_roof1 = std::max(max_layers_above_roof1, node.dist_mm_to_top);</div>
<div class="line"><span class="lineno"> 2244</span>                    }</div>
<div class="line"><span class="lineno"> 2245</span>                    else if (node.support_roof_layers_below &gt; 0)</div>
<div class="line"><span class="lineno"> 2246</span>                    {</div>
<div class="line"><span class="lineno"> 2247</span>                        append(roof_areas, area);</div>
<div class="line"><span class="lineno"> 2248</span>                        max_layers_above_roof = std::max(max_layers_above_roof, node.dist_mm_to_top);</div>
<div class="line"><span class="lineno"> 2249</span>                    }</div>
<div class="line"><span class="lineno"> 2250</span>                    else</div>
<div class="line"><span class="lineno"> 2251</span>                    {</div>
<div class="line"><span class="lineno"> 2252</span>                        append(base_areas, area);</div>
<div class="line"><span class="lineno"> 2253</span>                        max_layers_above_base = std::max(max_layers_above_base, node.dist_mm_to_top);</div>
<div class="line"><span class="lineno"> 2254</span>                    }</div>
<div class="line"><span class="lineno"> 2255</span> </div>
<div class="line"><span class="lineno"> 2256</span>                    if (layer_nr &lt; brim_skirt_layers)</div>
<div class="line"><span class="lineno"> 2257</span>                        append(ts_layer-&gt;lslices, area);</div>
<div class="line"><span class="lineno"> 2258</span>                }</div>
<div class="line"><span class="lineno"> 2259</span> </div>
<div class="line"><span class="lineno"> 2260</span>                ts_layer-&gt;lslices = std::move(union_ex(ts_layer-&gt;lslices));</div>
<div class="line"><span class="lineno"> 2261</span> </div>
<div class="line"><span class="lineno"> 2262</span>                <span class="comment">//Must update bounding box which is used in avoid crossing perimeter</span></div>
<div class="line"><span class="lineno"> 2263</span>                ts_layer-&gt;lslices_bboxes.clear();</div>
<div class="line"><span class="lineno"> 2264</span>                ts_layer-&gt;lslices_bboxes.reserve(ts_layer-&gt;lslices.size());</div>
<div class="line"><span class="lineno"> 2265</span>                for (const ExPolygon &amp;expoly : ts_layer-&gt;lslices)</div>
<div class="line"><span class="lineno"> 2266</span>                    ts_layer-&gt;lslices_bboxes.emplace_back(get_extents(expoly));</div>
<div class="line"><span class="lineno"> 2267</span>                ts_layer-&gt;backup_untyped_slices();</div>
<div class="line"><span class="lineno"> 2268</span> </div>
<div class="line"><span class="lineno"> 2269</span>                m_object-&gt;print()-&gt;set_status(65, (boost::format( _L(<span class="stringliteral">&quot;Support: generate polygons at layer %d&quot;</span>)) % layer_nr).str());</div>
<div class="line"><span class="lineno"> 2270</span> </div>
<div class="line"><span class="lineno"> 2271</span>                <span class="comment">// join roof segments</span></div>
<div class="line"><span class="lineno"> 2272</span>                double contact_dist_scaled = scale_(0.5);<span class="comment">// scale_(m_slicing_params.gap_support_object);</span></div>
<div class="line"><span class="lineno"> 2273</span>                roof_areas = std::move(offset2_ex(roof_areas, contact_dist_scaled, -contact_dist_scaled));</div>
<div class="line"><span class="lineno"> 2274</span>                roof_1st_layer = std::move(offset2_ex(roof_1st_layer, contact_dist_scaled, -contact_dist_scaled));</div>
<div class="line"><span class="lineno"> 2275</span> </div>
<div class="line"><span class="lineno"> 2276</span>                <span class="comment">// avoid object</span></div>
<div class="line"><span class="lineno"> 2277</span>                <span class="comment">//ExPolygons avoid_region_interface = m_ts_data-&gt;get_collision(m_ts_data-&gt;m_xy_distance, layer_nr);</span></div>
<div class="line"><span class="lineno"> 2278</span>                Polygons avoid_region_interface = get_trim_support_regions(*m_object, ts_layer, m_slicing_params.gap_object_support, m_slicing_params.gap_support_object, m_ts_data-&gt;m_xy_distance);</div>
<div class="line"><span class="lineno"> 2279</span>                if (has_circle_node) {</div>
<div class="line"><span class="lineno"> 2280</span>                    roof_areas = avoid_object_remove_extra_small_parts(roof_areas, avoid_region_interface);</div>
<div class="line"><span class="lineno"> 2281</span>                    roof_1st_layer = avoid_object_remove_extra_small_parts(roof_1st_layer, avoid_region_interface);</div>
<div class="line"><span class="lineno"> 2282</span>                }</div>
<div class="line"><span class="lineno"> 2283</span>                else {</div>
<div class="line"><span class="lineno"> 2284</span>                    roof_areas = std::move(diff_ex(roof_areas, avoid_region_interface));</div>
<div class="line"><span class="lineno"> 2285</span>                    roof_1st_layer = std::move(diff_ex(roof_1st_layer, avoid_region_interface));</div>
<div class="line"><span class="lineno"> 2286</span>                }</div>
<div class="line"><span class="lineno"> 2287</span>                roof_areas = intersection_ex(roof_areas, m_machine_border);</div>
<div class="line"><span class="lineno"> 2288</span> </div>
<div class="line"><span class="lineno"> 2289</span>                <span class="comment">// roof_1st_layer and roof_areas may intersect, so need to subtract roof_areas from roof_1st_layer</span></div>
<div class="line"><span class="lineno"> 2290</span>                roof_1st_layer = std::move(diff_ex(roof_1st_layer, roof_areas));</div>
<div class="line"><span class="lineno"> 2291</span>                roof_1st_layer = intersection_ex(roof_1st_layer, m_machine_border);</div>
<div class="line"><span class="lineno"> 2292</span> </div>
<div class="line"><span class="lineno"> 2293</span>                <span class="comment">// let supports touch objects when brim is on</span></div>
<div class="line"><span class="lineno"> 2294</span>                auto avoid_region = m_ts_data-&gt;get_collision((layer_nr == 0 &amp;&amp; has_brim) ? config.brim_object_gap : m_ts_data-&gt;m_xy_distance, layer_nr);</div>
<div class="line"><span class="lineno"> 2295</span>                base_areas = avoid_object_remove_extra_small_parts(base_areas, avoid_region);</div>
<div class="line"><span class="lineno"> 2296</span>                base_areas = std::move(diff_ex(base_areas, roof_areas));</div>
<div class="line"><span class="lineno"> 2297</span>                base_areas = std::move(diff_ex(base_areas, roof_1st_layer));</div>
<div class="line"><span class="lineno"> 2298</span>                base_areas = std::move(diff_ex(base_areas, roof_gap_areas));</div>
<div class="line"><span class="lineno"> 2299</span>                base_areas = intersection_ex(base_areas, m_machine_border);</div>
<div class="line"><span class="lineno"> 2300</span> </div>
<div class="line"><span class="lineno"> 2301</span>                if (SQUARE_SUPPORT) {</div>
<div class="line"><span class="lineno"> 2302</span>                    <span class="comment">// simplify support contours</span></div>
<div class="line"><span class="lineno"> 2303</span>                    ExPolygons base_areas_simplified;</div>
<div class="line"><span class="lineno"> 2304</span>                    for (auto &amp;area : base_areas) { area.simplify(scale_(line_width / 2), &amp;base_areas_simplified); }</div>
<div class="line"><span class="lineno"> 2305</span>                    base_areas = std::move(base_areas_simplified);</div>
<div class="line"><span class="lineno"> 2306</span>                }</div>
<div class="line"><span class="lineno"> 2307</span>                <span class="comment">//Subtract support floors. We can only compute floor_areas here instead of with roof_areas,</span></div>
<div class="line"><span class="lineno"> 2308</span>                <span class="comment">// or we&#39;ll get much wider floor than necessary.</span></div>
<div class="line"><span class="lineno"> 2309</span>                if (bottom_interface_layers + bottom_gap_layers &gt; 0)</div>
<div class="line"><span class="lineno"> 2310</span>                {</div>
<div class="line"><span class="lineno"> 2311</span>                    if (layer_nr &gt;= bottom_interface_layers + bottom_gap_layers)</div>
<div class="line"><span class="lineno"> 2312</span>                    {</div>
<div class="line"><span class="lineno"> 2313</span>                        for (size_t i = 0; i &lt;= bottom_gap_layers; i++)</div>
<div class="line"><span class="lineno"> 2314</span>                        {</div>
<div class="line"><span class="lineno"> 2315</span>                            const Layer* below_layer = m_object-&gt;get_layer(layer_nr - bottom_interface_layers - i);</div>
<div class="line"><span class="lineno"> 2316</span>                            ExPolygons bottom_interface = std::move(intersection_ex(base_areas, below_layer-&gt;lslices));</div>
<div class="line"><span class="lineno"> 2317</span>                            floor_areas.insert(floor_areas.end(), bottom_interface.begin(), bottom_interface.end());</div>
<div class="line"><span class="lineno"> 2318</span>                        }</div>
<div class="line"><span class="lineno"> 2319</span>                    }</div>
<div class="line"><span class="lineno"> 2320</span>                    if (floor_areas.empty() == false) {</div>
<div class="line"><span class="lineno"> 2321</span>                        floor_areas = std::move(diff_ex(floor_areas, avoid_region_interface));</div>
<div class="line"><span class="lineno"> 2322</span>                        floor_areas = std::move(offset2_ex(floor_areas, contact_dist_scaled, -contact_dist_scaled));</div>
<div class="line"><span class="lineno"> 2323</span>                        base_areas = std::move(diff_ex(base_areas, offset_ex(floor_areas, 10)));</div>
<div class="line"><span class="lineno"> 2324</span>                    }</div>
<div class="line"><span class="lineno"> 2325</span>                }</div>
<div class="line"><span class="lineno"> 2326</span>                if (bottom_gap_layers &gt; 0 &amp;&amp; layer_nr &gt; bottom_gap_layers) {</div>
<div class="line"><span class="lineno"> 2327</span>                    const Layer* below_layer = m_object-&gt;get_layer(layer_nr - bottom_gap_layers);</div>
<div class="line"><span class="lineno"> 2328</span>                    ExPolygons bottom_gap_area = std::move(intersection_ex(floor_areas, below_layer-&gt;lslices));</div>
<div class="line"><span class="lineno"> 2329</span>                    if (!bottom_gap_area.empty()) {</div>
<div class="line"><span class="lineno"> 2330</span>                        floor_areas = std::move(diff_ex(floor_areas, bottom_gap_area));</div>
<div class="line"><span class="lineno"> 2331</span>                    }</div>
<div class="line"><span class="lineno"> 2332</span>                }</div>
<div class="line"><span class="lineno"> 2333</span>                auto &amp;area_groups = ts_layer-&gt;area_groups;</div>
<div class="line"><span class="lineno"> 2334</span>                for (auto&amp; area : ts_layer-&gt;base_areas) {</div>
<div class="line"><span class="lineno"> 2335</span>                    area_groups.emplace_back(&amp;area, SupportLayer::BaseType, max_layers_above_base);</div>
<div class="line"><span class="lineno"> 2336</span>                    area_groups.back().need_infill = has_polygon_node;</div>
<div class="line"><span class="lineno"> 2337</span>                }</div>
<div class="line"><span class="lineno"> 2338</span>                for (auto &amp;area : ts_layer-&gt;roof_areas) area_groups.emplace_back(&amp;area, SupportLayer::RoofType, max_layers_above_roof);</div>
<div class="line"><span class="lineno"> 2339</span>                for (auto &amp;area : ts_layer-&gt;floor_areas) area_groups.emplace_back(&amp;area, SupportLayer::FloorType, 10000);</div>
<div class="line"><span class="lineno"> 2340</span>                for (auto &amp;area : ts_layer-&gt;roof_1st_layer) area_groups.emplace_back(&amp;area, SupportLayer::Roof1stLayer, max_layers_above_roof1);</div>
<div class="line"><span class="lineno"> 2341</span> </div>
<div class="line"><span class="lineno"> 2342</span>                for (auto &amp;area_group : area_groups) {</div>
<div class="line"><span class="lineno"> 2343</span>                    auto&amp; expoly = area_group.area;</div>
<div class="line"><span class="lineno"> 2344</span>                    expoly-&gt;holes.erase(std::remove_if(expoly-&gt;holes.begin(), expoly-&gt;holes.end(),</div>
<div class="line"><span class="lineno"> 2345</span>                                                       [](auto &amp;hole) {</div>
<div class="line"><span class="lineno"> 2346</span>                                                           auto bbox_size = get_extents(hole).size();</div>
<div class="line"><span class="lineno"> 2347</span>                                                           return bbox_size[0] &lt; scale_(2) &amp;&amp; bbox_size[1] &lt; scale_(2);</div>
<div class="line"><span class="lineno"> 2348</span>                                                       }),</div>
<div class="line"><span class="lineno"> 2349</span>                                        expoly-&gt;holes.end());</div>
<div class="line"><span class="lineno"> 2350</span>                }</div>
<div class="line"><span class="lineno"> 2351</span> </div>
<div class="line"><span class="lineno"> 2352</span>            }</div>
<div class="line"><span class="lineno"> 2353</span>        });</div>
<div class="line"><span class="lineno"> 2354</span> </div>
<div class="line"><span class="lineno"> 2355</span> </div>
<div class="line"><span class="lineno"> 2356</span>        <span class="keywordflow">if</span> (with_lightning_infill)</div>
<div class="line"><span class="lineno"> 2357</span>        {</div>
<div class="line"><span class="lineno"> 2358</span>            <span class="keyword">const</span> <span class="keywordtype">bool</span> global_lightning_infill = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2359</span> </div>
<div class="line"><span class="lineno"> 2360</span>            std::vector&lt;Polygons&gt; contours;</div>
<div class="line"><span class="lineno"> 2361</span>            std::vector&lt;Polygons&gt; overhangs;</div>
<div class="line"><span class="lineno"> 2362</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = 1; layer_nr &lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aea3e7f3fc4b46b4290105f655edcde47">layer_count</a>(); layer_nr++) {</div>
<div class="line"><span class="lineno"> 2363</span>                <span class="keywordflow">if</span> (print-&gt;canceled()) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2364</span>                <span class="keyword">const</span> std::vector&lt;Node*&gt;&amp; curr_layer_nodes = contact_nodes[layer_nr];</div>
<div class="line"><span class="lineno"> 2365</span>                SupportLayer* ts_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>);</div>
<div class="line"><span class="lineno"> 2366</span>                assert(ts_layer != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 2367</span> </div>
<div class="line"><span class="lineno"> 2368</span>                <span class="comment">// skip if current layer has no points. This fixes potential crash in get_collision (see jira BBL001-355)</span></div>
<div class="line"><span class="lineno"> 2369</span>                <span class="keywordflow">if</span> (curr_layer_nodes.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2370</span>                <span class="keywordflow">if</span> (ts_layer-&gt;height &lt; <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2371</span>                <span class="keywordflow">if</span> (ts_layer-&gt;area_groups.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2372</span> </div>
<div class="line"><span class="lineno"> 2373</span>                <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a>&amp; base_areas = ts_layer-&gt;base_areas;</div>
<div class="line"><span class="lineno"> 2374</span> </div>
<div class="line"><span class="lineno"> 2375</span>                <span class="keywordtype">int</span> layer_nr_lower = layer_nr - 1;</div>
<div class="line"><span class="lineno"> 2376</span>                <span class="keywordflow">for</span> (layer_nr_lower; layer_nr_lower &gt;= 0; layer_nr_lower--) {</div>
<div class="line"><span class="lineno"> 2377</span>                    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr_lower + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>)-&gt;<a class="code hl_variable" href="../../de/dad/class_slic3r_1_1_support_layer.html#a4a26771f0e3dd7766988eaa7de6afdf1">area_groups</a>.empty()) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2378</span>                }</div>
<div class="line"><span class="lineno"> 2379</span>                <span class="keywordflow">if</span> (layer_nr_lower &lt;= 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2380</span> </div>
<div class="line"><span class="lineno"> 2381</span>                SupportLayer* lower_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr_lower + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>);</div>
<div class="line"><span class="lineno"> 2382</span>                <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a>&amp; base_areas_lower = lower_layer-&gt;base_areas;</div>
<div class="line"><span class="lineno"> 2383</span> </div>
<div class="line"><span class="lineno"> 2384</span>                <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a> overhang;</div>
<div class="line"><span class="lineno"> 2385</span>                <span class="keywordflow">if</span> (global_lightning_infill)</div>
<div class="line"><span class="lineno"> 2386</span>                {</div>
<div class="line"><span class="lineno"> 2387</span>                    <span class="comment">//search overhangs globally</span></div>
<div class="line"><span class="lineno"> 2388</span>                    overhang = std::move(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a2b1bfe9b50e13403d42de533b8a19916">diff_ex</a>(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5e96c84b799b62906e4a46a94eb8916c">offset_ex</a>(base_areas_lower, -2.0 * <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(support_extrusion_width)), base_areas));</div>
<div class="line"><span class="lineno"> 2389</span>                }</div>
<div class="line"><span class="lineno"> 2390</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2391</span>                {</div>
<div class="line"><span class="lineno"> 2392</span>                    <span class="comment">//search overhangs only on floating islands</span></div>
<div class="line"><span class="lineno"> 2393</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; base_area : base_areas)</div>
<div class="line"><span class="lineno"> 2394</span>                        for (auto&amp; <a class="code hl_function" href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#acb23a1d84cf6852c07fe080ec7513306">hole</a> : base_area.<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#afb8c6d188cef5e372d935568fd9bc1ca">holes</a>)</div>
<div class="line"><span class="lineno"> 2395</span>                        {</div>
<div class="line"><span class="lineno"> 2396</span>                            <a class="code hl_enumvalue" href="../../d5/dd8/namespace_clipper2_lib.html#ae11c4d64b0c006fdcb85278a8d4a414ea4c0a11247d92f73fb84baa51e37a3263">Polygon</a> rev_hole = <a class="code hl_function" href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#acb23a1d84cf6852c07fe080ec7513306">hole</a>;</div>
<div class="line"><span class="lineno"> 2397</span>                            rev_hole.<a class="code hl_function" href="../../d8/d90/class_slic3r_1_1_polygon.html#a8cf62d2794105686bbf129659c548d46">make_counter_clockwise</a>();</div>
<div class="line"><span class="lineno"> 2398</span>                            <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a> ex_hole;</div>
<div class="line"><span class="lineno"> 2399</span>                            ex_hole.emplace_back(std::move(ExPolygon(rev_hole)));</div>
<div class="line"><span class="lineno"> 2400</span>                            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; other_area : base_areas)</div>
<div class="line"><span class="lineno"> 2401</span>                                <span class="comment">//if (&amp;other_area != &amp;base_area)</span></div>
<div class="line"><span class="lineno"> 2402</span>                                    ex_hole = <a class="code hl_namespace" href="../../d8/dcc/namespacestd.html">std</a>::move(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a2b1bfe9b50e13403d42de533b8a19916">diff_ex</a>(ex_hole, other_area));</div>
<div class="line"><span class="lineno"> 2403</span>                            overhang = std::move(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a37166e144522fceee41e6d8ed8245315">union_ex</a>(overhang, ex_hole));</div>
<div class="line"><span class="lineno"> 2404</span>                        }</div>
<div class="line"><span class="lineno"> 2405</span>                    overhang = std::move(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a9853756af06b71590c902865926b8e28">intersection_ex</a>(overhang, <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5e96c84b799b62906e4a46a94eb8916c">offset_ex</a>(base_areas_lower, -0.5 * <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(support_extrusion_width))));</div>
<div class="line"><span class="lineno"> 2406</span>                }</div>
<div class="line"><span class="lineno"> 2407</span> </div>
<div class="line"><span class="lineno"> 2408</span>                overhangs.emplace_back(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a843ba2fe16b213f550fb3d55c55a716e">to_polygons</a>(overhang));</div>
<div class="line"><span class="lineno"> 2409</span>                contours.emplace_back(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a843ba2fe16b213f550fb3d55c55a716e">to_polygons</a>(base_areas_lower));</div>
<div class="line"><span class="lineno"> 2410</span>                <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a99db4fd5f893221ceec871fec5d28af2">printZ_to_lightninglayer</a>[lower_layer-&gt;print_z] = overhangs.size() - 1;</div>
<div class="line"><span class="lineno"> 2411</span> </div>
<div class="line"><span class="lineno"> 2412</span><span class="preprocessor">#ifdef SUPPORT_TREE_DEBUG_TO_SVG</span></div>
<div class="line"><span class="lineno"> 2413</span>                <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79cc4e08a870aca014e89e855beb7eaa">draw_two_overhangs_to_svg</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr_lower + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>), base_areas_lower, <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a62142c5b77ff1d5c5f5d857b5a33b352">to_expolygons</a>(overhangs.back()));</div>
<div class="line"><span class="lineno"> 2414</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2415</span>            }</div>
<div class="line"><span class="lineno"> 2416</span> </div>
<div class="line"><span class="lineno"> 2417</span> </div>
<div class="line"><span class="lineno"> 2418</span>            <span class="keyword">auto</span> m_support_material_flow = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7a84976eeb16c9a039b46f731199bd58">support_material_flow</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a4e9e7e96af55db823c04201bee40292e">layer_height</a>);</div>
<div class="line"><span class="lineno"> 2419</span>            <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> support_spacing = object_config.support_base_pattern_spacing.value + m_support_material_flow.spacing();</div>
<div class="line"><span class="lineno"> 2420</span>            <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> support_density = std::min(1., m_support_material_flow.spacing() / support_spacing * 2); <span class="comment">// for lightning infill the density is defined differently, so need to double it</span></div>
<div class="line"><span class="lineno"> 2421</span>            <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aae0dd8cf9cd59f50841b17a85b3ed4d1">generator</a> = std::make_unique&lt;FillLightning::Generator&gt;(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>, contours, overhangs, []() {}, support_density);</div>
<div class="line"><span class="lineno"> 2422</span>        }</div>
<div class="line"><span class="lineno"> 2423</span> </div>
<div class="line"><span class="lineno"> 2424</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8272b9400f42356243f0973d0f2cb0c0">with_infill</a>) {</div>
<div class="line"><span class="lineno"> 2425</span>            <span class="comment">// move the holes to contour so they can be well supported</span></div>
<div class="line"><span class="lineno"> 2426</span> </div>
<div class="line"><span class="lineno"> 2427</span>            <span class="comment">// check if poly&#39;s contour intersects with expoly&#39;s contour</span></div>
<div class="line"><span class="lineno"> 2428</span>            <span class="keyword">auto</span> intersects_contour = [](<a class="code hl_enumvalue" href="../../d5/dd8/namespace_clipper2_lib.html#ae11c4d64b0c006fdcb85278a8d4a414ea4c0a11247d92f73fb84baa51e37a3263">Polygon</a> poly, ExPolygon expoly, <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>&amp; pt_on_poly, <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>&amp; pt_on_expoly, <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>&amp; pt_far_on_poly, <span class="keywordtype">float</span> dist_thresh = 0.01) {</div>
<div class="line"><span class="lineno"> 2429</span>                <span class="keywordtype">float</span> min_dist = std::numeric_limits&lt;float&gt;::max();</div>
<div class="line"><span class="lineno"> 2430</span>                <span class="keywordtype">float</span> max_dist = 0;</div>
<div class="line"><span class="lineno"> 2431</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> from : poly.points) {</div>
<div class="line"><span class="lineno"> 2432</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; expoly.num_contours(); i++) {</div>
<div class="line"><span class="lineno"> 2433</span>                        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>* candidate = expoly.contour_or_hole(i).closest_point(from);</div>
<div class="line"><span class="lineno"> 2434</span>                        <span class="keywordtype">double</span>       dist2 = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a513afc9a9ff0d9199826dffec9c83a3a">vsize2_with_unscale</a>(*candidate - from);</div>
<div class="line"><span class="lineno"> 2435</span>                        <span class="keywordflow">if</span> (dist2 &lt; min_dist) {</div>
<div class="line"><span class="lineno"> 2436</span>                            min_dist = dist2;</div>
<div class="line"><span class="lineno"> 2437</span>                            pt_on_poly = from;</div>
<div class="line"><span class="lineno"> 2438</span>                            pt_on_expoly = *candidate;</div>
<div class="line"><span class="lineno"> 2439</span>                            }</div>
<div class="line"><span class="lineno"> 2440</span>                        <span class="keywordflow">if</span> (dist2 &gt; max_dist) {</div>
<div class="line"><span class="lineno"> 2441</span>                            max_dist = dist2;</div>
<div class="line"><span class="lineno"> 2442</span>                            pt_far_on_poly = from;</div>
<div class="line"><span class="lineno"> 2443</span>                            }</div>
<div class="line"><span class="lineno"> 2444</span>                        <span class="keywordflow">if</span> (dist2 &lt; dist_thresh) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><span class="lineno"> 2445</span>                        }</div>
<div class="line"><span class="lineno"> 2446</span>                    }</div>
<div class="line"><span class="lineno"> 2447</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2448</span>                };</div>
<div class="line"><span class="lineno"> 2449</span> </div>
<div class="line"><span class="lineno"> 2450</span>            <span class="comment">// polygon pointer: depth, direction, farPoint</span></div>
<div class="line"><span class="lineno"> 2451</span>            std::map&lt;const Polygon*, std::tuple&lt;int, Point, Point&gt;&gt; holePropagationInfos;</div>
<div class="line"><span class="lineno"> 2452</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aea3e7f3fc4b46b4290105f655edcde47">layer_count</a>() - 1; layer_nr &gt; 0; layer_nr--) {</div>
<div class="line"><span class="lineno"> 2453</span>                <span class="keywordflow">if</span> (print-&gt;canceled()) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2454</span>                <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../dc/d88/class_slic3r_1_1_print_base.html#a5715024e4ace4cdc0d1feb0be6e48ae2">set_status</a>(66, (boost::format(<a class="code hl_define" href="../../da/d6e/_o_b_j_8cpp.html#a7a5970404f762cc8fada02d3018fb45a">_L</a>(<span class="stringliteral">&quot;Support: fix holes at layer %d&quot;</span>)) % layer_nr).str());</div>
<div class="line"><span class="lineno"> 2455</span> </div>
<div class="line"><span class="lineno"> 2456</span>                <span class="keyword">const</span> std::vector&lt;Node*&gt;&amp; curr_layer_nodes = contact_nodes[layer_nr];</div>
<div class="line"><span class="lineno"> 2457</span>                SupportLayer* ts_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>);</div>
<div class="line"><span class="lineno"> 2458</span>                assert(ts_layer != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 2459</span> </div>
<div class="line"><span class="lineno"> 2460</span>                <span class="comment">// skip if current layer has no points. This fixes potential crash in get_collision (see jira BBL001-355)</span></div>
<div class="line"><span class="lineno"> 2461</span>                <span class="keywordflow">if</span> (curr_layer_nodes.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2462</span>                <span class="keywordflow">if</span> (ts_layer-&gt;height &lt; <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2463</span>                <span class="keywordflow">if</span> (ts_layer-&gt;area_groups.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2464</span> </div>
<div class="line"><span class="lineno"> 2465</span>                <span class="keywordtype">int</span> layer_nr_lower = layer_nr - 1;</div>
<div class="line"><span class="lineno"> 2466</span>                <span class="keywordflow">for</span> (layer_nr_lower; layer_nr_lower &gt;= 0; layer_nr_lower--) {</div>
<div class="line"><span class="lineno"> 2467</span>                    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr_lower + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>)-&gt;<a class="code hl_variable" href="../../de/dad/class_slic3r_1_1_support_layer.html#a4a26771f0e3dd7766988eaa7de6afdf1">area_groups</a>.empty()) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2468</span>                }</div>
<div class="line"><span class="lineno"> 2469</span>                <span class="keywordflow">if</span> (layer_nr_lower &lt; 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2470</span>                <span class="keyword">auto</span>&amp; area_groups_lower = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr_lower + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>)-&gt;<a class="code hl_variable" href="../../de/dad/class_slic3r_1_1_support_layer.html#a4a26771f0e3dd7766988eaa7de6afdf1">area_groups</a>;</div>
<div class="line"><span class="lineno"> 2471</span> </div>
<div class="line"><span class="lineno"> 2472</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; area_group : ts_layer-&gt;area_groups) {</div>
<div class="line"><span class="lineno"> 2473</span>                    <span class="keywordflow">if</span> (area_group.type != <a class="code hl_enumvalue" href="../../de/dad/class_slic3r_1_1_support_layer.html#a34e0d4709abc1093eb14ca66139f1097ab4914aeed413774173be398c655131de">SupportLayer::BaseType</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2474</span>                    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a58007b1077539ba492d56398b92fea70">area</a> = area_group.area;</div>
<div class="line"><span class="lineno"> 2475</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; hole : <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a58007b1077539ba492d56398b92fea70">area</a>-&gt;<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#afb8c6d188cef5e372d935568fd9bc1ca">holes</a>) {</div>
<div class="line"><span class="lineno"> 2476</span>                        <span class="comment">// auto hole_bbox = get_extents(hole).polygon();</span></div>
<div class="line"><span class="lineno"> 2477</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; area_group_lower : area_groups_lower) {</div>
<div class="line"><span class="lineno"> 2478</span>                            <span class="keywordflow">if</span> (area_group.type != <a class="code hl_enumvalue" href="../../de/dad/class_slic3r_1_1_support_layer.html#a34e0d4709abc1093eb14ca66139f1097ab4914aeed413774173be398c655131de">SupportLayer::BaseType</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2479</span>                            <span class="keyword">auto</span>&amp; base_area_lower = *area_group_lower.area;</div>
<div class="line"><span class="lineno"> 2480</span>                            <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> pt_on_poly, pt_on_expoly, pt_far_on_poly;</div>
<div class="line"><span class="lineno"> 2481</span>                            <span class="comment">// if a hole doesn&#39;t intersect with lower layer&#39;s contours, add a hole to lower layer and move it slightly to the contour</span></div>
<div class="line"><span class="lineno"> 2482</span>                            <span class="keywordflow">if</span> (base_area_lower.contour.contains(<a class="code hl_function" href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#acb23a1d84cf6852c07fe080ec7513306">hole</a>.<a class="code hl_variable" href="../../d7/dd1/class_slic3r_1_1_multi_point.html#a5f33254e616268f728969886c4ed5d85">points</a>.front()) &amp;&amp; !intersects_contour(hole, base_area_lower, pt_on_poly, pt_on_expoly, pt_far_on_poly)) {</div>
<div class="line"><span class="lineno"> 2483</span>                                <a class="code hl_enumvalue" href="../../d5/dd8/namespace_clipper2_lib.html#ae11c4d64b0c006fdcb85278a8d4a414ea4c0a11247d92f73fb84baa51e37a3263">Polygon</a> hole_lower = <a class="code hl_function" href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#acb23a1d84cf6852c07fe080ec7513306">hole</a>;</div>
<div class="line"><span class="lineno"> 2484</span>                                <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>   direction = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#aa3fa458858b2d5a3b0bfb1108f9f781f">normal</a>(pt_on_expoly - pt_on_poly, line_width_scaled / 2);</div>
<div class="line"><span class="lineno"> 2485</span>                                hole_lower.translate(direction);</div>
<div class="line"><span class="lineno"> 2486</span>                                <span class="comment">// note to expand a hole, we need to do negative offset</span></div>
<div class="line"><span class="lineno"> 2487</span>                                <span class="keyword">auto</span> hole_expanded = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5ec552d076296fd705739c608edc1580">offset</a>(hole_lower, -line_width_scaled / 4, <a class="code hl_enumvalue" href="../../de/d37/namespace_clipper_lib.html#ab3880a3ca1b45df3ce93ac315a74c06ea1e73eb6e6192fffb13033a0f4d4ac87f">ClipperLib::JoinType::jtSquare</a>);</div>
<div class="line"><span class="lineno"> 2488</span>                                <span class="keywordflow">if</span> (!hole_expanded.empty()) {</div>
<div class="line"><span class="lineno"> 2489</span>                                    base_area_lower.holes.push_back(std::move(hole_expanded[0]));</div>
<div class="line"><span class="lineno"> 2490</span>                                    holePropagationInfos.insert({ &amp;base_area_lower.holes.back(), {25, direction, pt_far_on_poly} });</div>
<div class="line"><span class="lineno"> 2491</span>                                    }</div>
<div class="line"><span class="lineno"> 2492</span>                                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2493</span>                                }</div>
<div class="line"><span class="lineno"> 2494</span>                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (holePropagationInfos.find(&amp;hole) != holePropagationInfos.end() &amp;&amp; std::get&lt;0&gt;(holePropagationInfos[&amp;hole]) &gt; 0 &amp;&amp;</div>
<div class="line"><span class="lineno"> 2495</span>                                base_area_lower.contour.contains(std::get&lt;2&gt;(holePropagationInfos[&amp;hole]))) {</div>
<div class="line"><span class="lineno"> 2496</span>                                <a class="code hl_enumvalue" href="../../d5/dd8/namespace_clipper2_lib.html#ae11c4d64b0c006fdcb85278a8d4a414ea4c0a11247d92f73fb84baa51e37a3263">Polygon</a> hole_lower = <a class="code hl_function" href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#acb23a1d84cf6852c07fe080ec7513306">hole</a>;</div>
<div class="line"><span class="lineno"> 2497</span>                                <span class="keyword">auto</span>&amp;&amp; direction = std::get&lt;1&gt;(holePropagationInfos[&amp;hole]);</div>
<div class="line"><span class="lineno"> 2498</span>                                hole_lower.translate(direction);</div>
<div class="line"><span class="lineno"> 2499</span>                                <span class="comment">// note to shrink a hole, we need to do positive offset</span></div>
<div class="line"><span class="lineno"> 2500</span>                                <span class="keyword">auto</span>  hole_expanded = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5ec552d076296fd705739c608edc1580">offset</a>(hole_lower, line_width_scaled / 2, <a class="code hl_enumvalue" href="../../de/d37/namespace_clipper_lib.html#ab3880a3ca1b45df3ce93ac315a74c06ea1e73eb6e6192fffb13033a0f4d4ac87f">ClipperLib::JoinType::jtSquare</a>);</div>
<div class="line"><span class="lineno"> 2501</span>                                <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> farPoint = std::get&lt;2&gt;(holePropagationInfos[&amp;hole]) + direction * 2;</div>
<div class="line"><span class="lineno"> 2502</span>                                <span class="keywordflow">if</span> (!hole_expanded.empty()) {</div>
<div class="line"><span class="lineno"> 2503</span>                                    base_area_lower.holes.push_back(std::move(hole_expanded[0]));</div>
<div class="line"><span class="lineno"> 2504</span>                                    holePropagationInfos.insert({ &amp;base_area_lower.holes.back(), {std::get&lt;0&gt;(holePropagationInfos[&amp;hole]) - 1, direction, farPoint} });</div>
<div class="line"><span class="lineno"> 2505</span>                                    }</div>
<div class="line"><span class="lineno"> 2506</span>                                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2507</span>                                }</div>
<div class="line"><span class="lineno"> 2508</span>                            }</div>
<div class="line"><span class="lineno"> 2509</span>                        {</div>
<div class="line"><span class="lineno"> 2510</span>                        <span class="comment">// if roof1 interface is inside a hole, need to expand the interface</span></div>
<div class="line"><span class="lineno"> 2511</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; roof1 : ts_layer-&gt;roof_1st_layer) {</div>
<div class="line"><span class="lineno"> 2512</span>                            <span class="comment">//if (hole.contains(roof1.contour.points.front()) &amp;&amp; hole.contains(roof1.contour.bounding_box().center())) </span></div>
<div class="line"><span class="lineno"> 2513</span>                            <span class="keywordtype">bool</span> is_inside_hole = std::all_of(roof1.contour.points.begin(), roof1.contour.points.end(), [&amp;hole](<a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>&amp; pt) { return hole.contains(pt); });</div>
<div class="line"><span class="lineno"> 2514</span>                            <span class="keywordflow">if</span> (is_inside_hole) {</div>
<div class="line"><span class="lineno"> 2515</span>                                <a class="code hl_enumvalue" href="../../d5/dd8/namespace_clipper2_lib.html#ae11c4d64b0c006fdcb85278a8d4a414ea4c0a11247d92f73fb84baa51e37a3263">Polygon</a> hole_reoriented = <a class="code hl_function" href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#acb23a1d84cf6852c07fe080ec7513306">hole</a>;</div>
<div class="line"><span class="lineno"> 2516</span>                                <span class="keywordflow">if</span> (roof1.contour.is_counter_clockwise())</div>
<div class="line"><span class="lineno"> 2517</span>                                    hole_reoriented.<a class="code hl_function" href="../../d8/d90/class_slic3r_1_1_polygon.html#a8cf62d2794105686bbf129659c548d46">make_counter_clockwise</a>();</div>
<div class="line"><span class="lineno"> 2518</span>                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (roof1.contour.is_clockwise())</div>
<div class="line"><span class="lineno"> 2519</span>                                    hole_reoriented.make_clockwise();</div>
<div class="line"><span class="lineno"> 2520</span>                                <span class="keyword">auto</span> tmp = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a015388ff0752a25649a975078f7a5431">union_</a>({ roof1.contour }, { hole_reoriented });</div>
<div class="line"><span class="lineno"> 2521</span>                                <span class="keywordflow">if</span> (!tmp.empty()) roof1.contour = tmp[0];</div>
<div class="line"><span class="lineno"> 2522</span> </div>
<div class="line"><span class="lineno"> 2523</span>                                <span class="comment">// make sure 1) roof1 and object 2) roof1 and roof, won&#39;t intersect</span></div>
<div class="line"><span class="lineno"> 2524</span>                                <span class="comment">// Note: We can&#39;t replace roof1 directly, as we have recorded its address.</span></div>
<div class="line"><span class="lineno"> 2525</span>                                <span class="comment">//       So instead we need to replace its members one by one.</span></div>
<div class="line"><span class="lineno"> 2526</span>                                <span class="keyword">auto</span> tmp1 = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a2b1bfe9b50e13403d42de533b8a19916">diff_ex</a>(roof1, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;get_collision((layer_nr == 0 &amp;&amp; has_brim) ? config.brim_object_gap : <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;m_xy_distance, layer_nr));</div>
<div class="line"><span class="lineno"> 2527</span>                                tmp1 = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a2b1bfe9b50e13403d42de533b8a19916">diff_ex</a>(tmp1, ts_layer-&gt;roof_areas);</div>
<div class="line"><span class="lineno"> 2528</span>                                <span class="keywordflow">if</span> (!tmp1.empty()) {</div>
<div class="line"><span class="lineno"> 2529</span>                                    roof1.contour = std::move(tmp1[0].<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#af61cef4113ccd6c7b65581bcfb25e340">contour</a>);</div>
<div class="line"><span class="lineno"> 2530</span>                                    roof1.holes = std::move(tmp1[0].<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#afb8c6d188cef5e372d935568fd9bc1ca">holes</a>);</div>
<div class="line"><span class="lineno"> 2531</span>                                    }</div>
<div class="line"><span class="lineno"> 2532</span>                                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2533</span>                                }</div>
<div class="line"><span class="lineno"> 2534</span>                            }</div>
<div class="line"><span class="lineno"> 2535</span>                        }</div>
<div class="line"><span class="lineno"> 2536</span>                        }</div>
<div class="line"><span class="lineno"> 2537</span>                    }</div>
<div class="line"><span class="lineno"> 2538</span>                }</div>
<div class="line"><span class="lineno"> 2539</span>            }</div>
<div class="line"><span class="lineno"> 2540</span> </div>
<div class="line"><span class="lineno"> 2541</span> </div>
<div class="line"><span class="lineno"> 2542</span><span class="preprocessor">#ifdef SUPPORT_TREE_DEBUG_TO_SVG</span></div>
<div class="line"><span class="lineno"> 2543</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aea3e7f3fc4b46b4290105f655edcde47">layer_count</a>() - 1; layer_nr &gt;= 0; layer_nr--) {</div>
<div class="line"><span class="lineno"> 2544</span>        SupportLayer* ts_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>);</div>
<div class="line"><span class="lineno"> 2545</span>        <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a>&amp; base_areas = ts_layer-&gt;base_areas;</div>
<div class="line"><span class="lineno"> 2546</span>        <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a>&amp; roof_areas = ts_layer-&gt;roof_areas;</div>
<div class="line"><span class="lineno"> 2547</span>        <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a>&amp; roof_1st_layer = ts_layer-&gt;roof_1st_layer;</div>
<div class="line"><span class="lineno"> 2548</span>        <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a>&amp; floor_areas = ts_layer-&gt;floor_areas;</div>
<div class="line"><span class="lineno"> 2549</span>        <span class="keywordflow">if</span> (base_areas.empty() &amp;&amp; roof_areas.empty() &amp;&amp; roof_1st_layer.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2550</span>        <span class="keywordtype">char</span> fname[10]; sprintf(fname, <span class="stringliteral">&quot;%d_%.2f&quot;</span>, layer_nr, ts_layer-&gt;print_z);</div>
<div class="line"><span class="lineno"> 2551</span>        draw_contours_and_nodes_to_svg(<span class="stringliteral">&quot;&quot;</span>, base_areas, roof_areas, roof_1st_layer, {}, {}, <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#ab8637587074b8b8f2fdcbb2a84d7d399">get_svg_filename</a>(fname, <span class="stringliteral">&quot;circles&quot;</span>), {<span class="stringliteral">&quot;base&quot;</span>, <span class="stringliteral">&quot;roof&quot;</span>, <span class="stringliteral">&quot;roof1st&quot;</span>});</div>
<div class="line"><span class="lineno"> 2552</span>    }</div>
<div class="line"><span class="lineno"> 2553</span><span class="preprocessor">#endif  </span><span class="comment">// SUPPORT_TREE_DEBUG_TO_SVG</span></div>
<div class="line"><span class="lineno"> 2554</span> </div>
<div class="line"><span class="lineno"> 2555</span>    <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a8136847c9a01e9549ec65c3e4334da96">SupportLayerPtrs</a>&amp; ts_layers = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a5dbc527ceb07d109234242201e8439c1">support_layers</a>();</div>
<div class="line"><span class="lineno"> 2556</span>    <span class="keyword">auto</span> iter = std::remove_if(ts_layers.begin(), ts_layers.end(), [](SupportLayer* ts_layer) { return ts_layer-&gt;height &lt; EPSILON; });</div>
<div class="line"><span class="lineno"> 2557</span>    ts_layers.erase(iter, ts_layers.end());</div>
<div class="line"><span class="lineno"> 2558</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = 0; layer_nr &lt; ts_layers.size(); layer_nr++) {</div>
<div class="line"><span class="lineno"> 2559</span>        ts_layers[layer_nr]-&gt;upper_layer = layer_nr != ts_layers.size() - 1 ? ts_layers[layer_nr + 1] : <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2560</span>        ts_layers[layer_nr]-&gt;lower_layer = layer_nr &gt; 0 ? ts_layers[layer_nr - 1] : <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2561</span>    }</div>
<div class="line"><span class="lineno"> 2562</span>}</div>
<div class="ttc" id="a_array_cwise_unary_ops_8h_html_a0c32a3874bfc5438d11b75c9f40256d1"><div class="ttname"><a href="../../d4/df0/_array_cwise_unary_ops_8h.html#a0c32a3874bfc5438d11b75c9f40256d1">tan</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC const TanReturnType tan() const</div><div class="ttdef"><b>Definition</b> ArrayCwiseUnaryOps.h:234</div></div>
<div class="ttc" id="a_array_cwise_unary_ops_8h_html_a92b03396990b0e9eea0731aa406e31a4"><div class="ttname"><a href="../../d4/df0/_array_cwise_unary_ops_8h.html#a92b03396990b0e9eea0731aa406e31a4">cos</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC const CosReturnType cos() const</div><div class="ttdef"><b>Definition</b> ArrayCwiseUnaryOps.h:202</div></div>
<div class="ttc" id="a_array_cwise_unary_ops_8h_html_a9cfb0ea58bd813510a9e2db18a5e49f0"><div class="ttname"><a href="../../d4/df0/_array_cwise_unary_ops_8h.html#a9cfb0ea58bd813510a9e2db18a5e49f0">sin</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC const SinReturnType sin() const</div><div class="ttdef"><b>Definition</b> ArrayCwiseUnaryOps.h:220</div></div>
<div class="ttc" id="a_array_cwise_unary_ops_8h_html_ac805f9c4e64d7f48898ac876c0a541e7"><div class="ttname"><a href="../../d4/df0/_array_cwise_unary_ops_8h.html#ac805f9c4e64d7f48898ac876c0a541e7">round</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC const RoundReturnType round() const</div><div class="ttdef"><b>Definition</b> ArrayCwiseUnaryOps.h:374</div></div>
<div class="ttc" id="a_extrusion_simulator_8cpp_html_ae71449b1cc6e6250b91f539153a7a0d3"><div class="ttname"><a href="../../de/ddd/_extrusion_simulator_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a></div><div class="ttdeci">#define M_PI</div><div class="ttdef"><b>Definition</b> ExtrusionSimulator.cpp:20</div></div>
<div class="ttc" id="a_o_b_j_8cpp_html_a7a5970404f762cc8fada02d3018fb45a"><div class="ttname"><a href="../../da/d6e/_o_b_j_8cpp.html#a7a5970404f762cc8fada02d3018fb45a">_L</a></div><div class="ttdeci">#define _L(s)</div><div class="ttdef"><b>Definition</b> OBJ.cpp:20</div></div>
<div class="ttc" id="a_tree_support_8cpp_html_a3d8c9c145887af5174ba4cc6789862ad"><div class="ttname"><a href="../../dd/dff/_tree_support_8cpp.html#a3d8c9c145887af5174ba4cc6789862ad">TAU</a></div><div class="ttdeci">#define TAU</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:25</div></div>
<div class="ttc" id="aclass_slic3r_1_1_model_object_html_a3fe28b2958454b2b84f805d458c1d5ca"><div class="ttname"><a href="../../d0/d23/class_slic3r_1_1_model_object.html#a3fe28b2958454b2b84f805d458c1d5ca">Slic3r::ModelObject::name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition</b> Model.hpp:331</div></div>
<div class="ttc" id="aclass_slic3r_1_1_multi_point_html_a5f33254e616268f728969886c4ed5d85"><div class="ttname"><a href="../../d7/dd1/class_slic3r_1_1_multi_point.html#a5f33254e616268f728969886c4ed5d85">Slic3r::MultiPoint::points</a></div><div class="ttdeci">Points points</div><div class="ttdef"><b>Definition</b> MultiPoint.hpp:18</div></div>
<div class="ttc" id="aclass_slic3r_1_1_polygon_html_a8cf62d2794105686bbf129659c548d46"><div class="ttname"><a href="../../d8/d90/class_slic3r_1_1_polygon.html#a8cf62d2794105686bbf129659c548d46">Slic3r::Polygon::make_counter_clockwise</a></div><div class="ttdeci">bool make_counter_clockwise()</div><div class="ttdef"><b>Definition</b> Polygon.cpp:76</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_base_html_a5715024e4ace4cdc0d1feb0be6e48ae2"><div class="ttname"><a href="../../dc/d88/class_slic3r_1_1_print_base.html#a5715024e4ace4cdc0d1feb0be6e48ae2">Slic3r::PrintBase::set_status</a></div><div class="ttdeci">void set_status(int percent, const std::string &amp;message, unsigned int flags=SlicingStatus::DEFAULT, int warning_step=-1) const</div><div class="ttdef"><b>Definition</b> PrintBase.cpp:105</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_html_aa7f10f89d76a1cf3d2d55e4c477a26e6"><div class="ttname"><a href="../../d5/d8f/class_slic3r_1_1_print.html#aa7f10f89d76a1cf3d2d55e4c477a26e6">Slic3r::Print::has_brim</a></div><div class="ttdeci">bool has_brim() const</div><div class="ttdef"><b>Definition</b> Print.cpp:446</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_base_html_a2bb6df50398e4bff40ea23238264d1ee"><div class="ttname"><a href="../../dd/d44/class_slic3r_1_1_print_object_base.html#a2bb6df50398e4bff40ea23238264d1ee">Slic3r::PrintObjectBase::model_object</a></div><div class="ttdeci">const ModelObject * model_object() const</div><div class="ttdef"><b>Definition</b> PrintBase.hpp:335</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_a5dbc527ceb07d109234242201e8439c1"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#a5dbc527ceb07d109234242201e8439c1">Slic3r::PrintObject::support_layers</a></div><div class="ttdeci">ConstSupportLayerPtrsAdaptor support_layers() const</div><div class="ttdef"><b>Definition</b> Print.hpp:302</div></div>
<div class="ttc" id="aclass_slic3r_1_1_support_layer_html_a34e0d4709abc1093eb14ca66139f1097ab4914aeed413774173be398c655131de"><div class="ttname"><a href="../../de/dad/class_slic3r_1_1_support_layer.html#a34e0d4709abc1093eb14ca66139f1097ab4914aeed413774173be398c655131de">Slic3r::SupportLayer::BaseType</a></div><div class="ttdeci">@ BaseType</div><div class="ttdef"><b>Definition</b> Layer.hpp:302</div></div>
<div class="ttc" id="aclass_slic3r_1_1_support_layer_html_a4a26771f0e3dd7766988eaa7de6afdf1"><div class="ttname"><a href="../../de/dad/class_slic3r_1_1_support_layer.html#a4a26771f0e3dd7766988eaa7de6afdf1">Slic3r::SupportLayer::area_groups</a></div><div class="ttdeci">std::vector&lt; AreaGroup &gt; area_groups</div><div class="ttdef"><b>Definition</b> Layer.hpp:312</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a4453aaa97f66b4d66f47d534979ee149"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4453aaa97f66b4d66f47d534979ee149">Slic3r::TreeSupport::nodes_angle</a></div><div class="ttdeci">float nodes_angle</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:394</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a87bcd1a50c69642adfbd467a7256c23d"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a87bcd1a50c69642adfbd467a7256c23d">Slic3r::TreeSupport::avg_node_per_layer</a></div><div class="ttdeci">int avg_node_per_layer</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:393</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a99db4fd5f893221ceec871fec5d28af2"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a99db4fd5f893221ceec871fec5d28af2">Slic3r::TreeSupport::printZ_to_lightninglayer</a></div><div class="ttdeci">std::unordered_map&lt; double, size_t &gt; printZ_to_lightninglayer</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:403</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_aa683ac2cae76bf3adfde9333039016db"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">Slic3r::TreeSupport::m_ts_data</a></div><div class="ttdeci">std::shared_ptr&lt; TreeSupportData &gt; m_ts_data</div><div class="ttdoc">Generator for model collision, avoidance and internal guide volumes.</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:411</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_aae0dd8cf9cd59f50841b17a85b3ed4d1"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#aae0dd8cf9cd59f50841b17a85b3ed4d1">Slic3r::TreeSupport::generator</a></div><div class="ttdeci">std::unique_ptr&lt; FillLightning::Generator &gt; generator</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:402</div></div>
<div class="ttc" id="anamespace_clipper_lib_html_ab3880a3ca1b45df3ce93ac315a74c06ea1e73eb6e6192fffb13033a0f4d4ac87f"><div class="ttname"><a href="../../de/d37/namespace_clipper_lib.html#ab3880a3ca1b45df3ce93ac315a74c06ea1e73eb6e6192fffb13033a0f4d4ac87f">ClipperLib::jtSquare</a></div><div class="ttdeci">@ jtSquare</div><div class="ttdef"><b>Definition</b> clipper.hpp:130</div></div>
<div class="ttc" id="anamespace_slic3r_html_a513afc9a9ff0d9199826dffec9c83a3a"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a513afc9a9ff0d9199826dffec9c83a3a">Slic3r::vsize2_with_unscale</a></div><div class="ttdeci">double vsize2_with_unscale(const Point pt)</div><div class="ttdef"><b>Definition</b> MinimumSpanningTree.cpp:17</div></div>
<div class="ttc" id="anamespace_slic3r_html_a62142c5b77ff1d5c5f5d857b5a33b352"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a62142c5b77ff1d5c5f5d857b5a33b352">Slic3r::to_expolygons</a></div><div class="ttdeci">ExPolygons to_expolygons(const Polygons &amp;polys)</div><div class="ttdef"><b>Definition</b> ExPolygon.hpp:346</div></div>
<div class="ttc" id="anamespace_slic3r_html_a7927d0ca1b31b8f9284ea268b11d27d5"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">Slic3r::angle</a></div><div class="ttdeci">double angle(const Eigen::MatrixBase&lt; Derived &gt; &amp;v1, const Eigen::MatrixBase&lt; Derived2 &gt; &amp;v2)</div><div class="ttdef"><b>Definition</b> Point.hpp:101</div></div>
<div class="ttc" id="anamespace_slic3r_html_a79cc4e08a870aca014e89e855beb7eaa"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a79cc4e08a870aca014e89e855beb7eaa">Slic3r::draw_two_overhangs_to_svg</a></div><div class="ttdeci">Slic3r::SVG draw_two_overhangs_to_svg(size_t ts_layer, const ExPolygons &amp;overhangs1, const ExPolygons &amp;overhangs2)</div><div class="ttdef"><b>Definition</b> Generator.cpp:45</div></div>
<div class="ttc" id="anamespace_slic3r_html_a7a84976eeb16c9a039b46f731199bd58"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a7a84976eeb16c9a039b46f731199bd58">Slic3r::support_material_flow</a></div><div class="ttdeci">Flow support_material_flow(const PrintObject *object, float layer_height)</div><div class="ttdef"><b>Definition</b> Flow.cpp:214</div></div>
<div class="ttc" id="anamespace_slic3r_html_a8136847c9a01e9549ec65c3e4334da96"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a8136847c9a01e9549ec65c3e4334da96">Slic3r::SupportLayerPtrs</a></div><div class="ttdeci">std::vector&lt; SupportLayer * &gt; SupportLayerPtrs</div><div class="ttdef"><b>Definition</b> Print.hpp:177</div></div>
<div class="ttc" id="anamespace_slic3r_html_aa3fa458858b2d5a3b0bfb1108f9f781f"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#aa3fa458858b2d5a3b0bfb1108f9f781f">Slic3r::normal</a></div><div class="ttdeci">Point normal(Point pt, double scale)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:65</div></div>
<div class="ttc" id="anamespace_slic3r_html_ab8637587074b8b8f2fdcbb2a84d7d399"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#ab8637587074b8b8f2fdcbb2a84d7d399">Slic3r::get_svg_filename</a></div><div class="ttdeci">static std::string get_svg_filename(std::string layer_nr_or_z, std::string tag=&quot;bbl_ts&quot;)</div><div class="ttdef"><b>Definition</b> Generator.cpp:29</div></div>
<div class="ttc" id="anamespace_slic3r_html_af61cef4113ccd6c7b65581bcfb25e340"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#af61cef4113ccd6c7b65581bcfb25e340">Slic3r::contour</a></div><div class="ttdeci">const Polygon &amp; contour(const ExPolygon &amp;p)</div><div class="ttdef"><b>Definition</b> AGGRaster.hpp:22</div></div>
<div class="ttc" id="anamespace_slic3r_html_afb8c6d188cef5e372d935568fd9bc1ca"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#afb8c6d188cef5e372d935568fd9bc1ca">Slic3r::holes</a></div><div class="ttdeci">const Polygons &amp; holes(const ExPolygon &amp;p)</div><div class="ttdef"><b>Definition</b> AGGRaster.hpp:23</div></div>
<div class="ttc" id="anamespacelibnest2d_1_1shapelike_html_acb23a1d84cf6852c07fe080ec7513306"><div class="ttname"><a href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#acb23a1d84cf6852c07fe080ec7513306">libnest2d::shapelike::hole</a></div><div class="ttdeci">Slic3r::Polygon &amp; hole(Slic3r::ExPolygon &amp;sh, unsigned long idx)</div><div class="ttdef"><b>Definition</b> geometries.hpp:200</div></div>
<div class="ttc" id="anamespacenlohmann_1_1detail_html_a1ed8fc6239da25abcaf681d30ace4985aa8cfde6331bd59eb2ac96f8911c4b666"><div class="ttname"><a href="../../dc/df0/namespacenlohmann_1_1detail.html#a1ed8fc6239da25abcaf681d30ace4985aa8cfde6331bd59eb2ac96f8911c4b666">nlohmann::detail::value_t::object</a></div><div class="ttdeci">@ object</div><div class="ttdoc">object (unordered set of name/value pairs)</div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="../../d8/dcc/namespacestd.html">std</a></div><div class="ttdoc">STL namespace.</div></div>
<div class="ttc" id="arboxlib_8c_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="../../d4/d08/rboxlib_8c.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition</b> rboxlib.c:33</div></div>
<div class="ttc" id="astruct_slic3r_1_1_slicing_parameters_html_a4e9e7e96af55db823c04201bee40292e"><div class="ttname"><a href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a4e9e7e96af55db823c04201bee40292e">Slic3r::SlicingParameters::layer_height</a></div><div class="ttdeci">coordf_t layer_height</div><div class="ttdef"><b>Definition</b> Slicing.hpp:61</div></div>
<div class="ttc" id="astruct_slic3r_1_1_slicing_parameters_html_a6127b2a51f4a1e1a7aefc70d6677f7e7"><div class="ttname"><a href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a6127b2a51f4a1e1a7aefc70d6677f7e7">Slic3r::SlicingParameters::gap_object_support</a></div><div class="ttdeci">coordf_t gap_object_support</div><div class="ttdef"><b>Definition</b> Slicing.hpp:86</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00101">Slic3r::angle()</a>, <a class="el" href="../../#l00081">Slic3r::MultiPoint::append()</a>, <a class="el" href="../../#l00740">Slic3r::Print::config()</a>, <a class="el" href="../../#l00202">cos()</a>, <a class="el" href="../../#l00446">Slic3r::Print::has_brim()</a>, <a class="el" href="../../#l00436">Slic3r::Print::has_infinite_skirt()</a>, <a class="el" href="../../#l00057">Slic3r::ipLightning</a>, <a class="el" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">Slic3r::layer_height()</a>, <a class="el" href="../../#l00020">M_PI</a>, <a class="el" href="../../#l00743">Slic3r::Print::objects()</a>, <a class="el" href="../../#l00033">PI</a>, <a class="el" href="../../#l01047">Slic3r::PrintObjectConfig</a>, <a class="el" href="../../#l00374">Slic3r::range()</a>, <a class="el" href="../../#l00374">round()</a>, <a class="el" href="../../#l00081">scale_</a>, <a class="el" href="../../#l00220">sin()</a>, <a class="el" href="../../#l00234">tan()</a>, and <a class="el" href="../../#l00025">TAU</a>.</p>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_a5bf8f77ce79d4b92e7a2b28d96e2ffea_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ad5e4f597762d95dd808dbd053aeac6ba" name="ad5e4f597762d95dd808dbd053aeac6ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5e4f597762d95dd808dbd053aeac6ba">&#9670;&#160;</a></span>drop_nodes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> Slic3r::TreeSupport::drop_nodes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>contact_nodes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Drops down the nodes of the tree support towards the build plate. </p>
<p>This is where the cleverness of tree support comes in: The nodes stay on their 2D layers but on the next layer they are slightly shifted. This causes them to move towards each other as they are copied to lower layers which ultimately results in a 3D tree.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">contact_nodes[in,out]</td><td>The nodes in the space that need to be dropped down. The nodes are dropped to lower layers inside the same vector of layers. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno"> 2565</span>{</div>
<div class="line"><span class="lineno"> 2566</span>    <span class="keyword">const</span> <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#ad48b86fa8e529e56c6bd00ff2f9839ab">PrintObjectConfig</a> &amp;config = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#abde3ac4f19e1f9d342423a7643e17266">config</a>();</div>
<div class="line"><span class="lineno"> 2567</span>    <span class="comment">// Use Minimum Spanning Tree to connect the points on each layer and move them while dropping them down.</span></div>
<div class="line"><span class="lineno"> 2568</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> support_extrusion_width = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa0479aee3f9b52bd26f72c7f94ee4dc0">support_extrusion_width</a>;</div>
<div class="line"><span class="lineno"> 2569</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a> = config.layer_height.value;</div>
<div class="line"><span class="lineno"> 2570</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">angle</a> = config.tree_support_branch_angle.value * <a class="code hl_define" href="../../de/ddd/_extrusion_simulator_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180.;</div>
<div class="line"><span class="lineno"> 2571</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> wall_count = std::max(1, config.tree_support_wall_count.value);</div>
<div class="line"><span class="lineno"> 2572</span>    <span class="keywordtype">double</span> tan_angle = <a class="code hl_function" href="../../d4/df0/_array_cwise_unary_ops_8h.html#a0c32a3874bfc5438d11b75c9f40256d1">tan</a>(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">angle</a>); <span class="comment">// when nodes are thick, they can move further. this is the max angle</span></div>
<div class="line"><span class="lineno"> 2573</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> max_move_distance = (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">angle</a> &lt; <a class="code hl_define" href="../../de/ddd/_extrusion_simulator_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 2) ? (<a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a>)(tan_angle * <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a>)*wall_count : <a class="code hl_namespace" href="../../d8/dcc/namespacestd.html">std</a>::numeric_limits&lt;<a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a>&gt;::<a class="code hl_function" href="../../df/db1/math_8h.html#a5083c48fbfb60dd70808789479f4db53">max</a>();</div>
<div class="line"><span class="lineno"> 2574</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> max_move_distance2 = max_move_distance * max_move_distance;</div>
<div class="line"><span class="lineno"> 2575</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> branch_radius = config.tree_support_branch_diameter.value / 2;</div>
<div class="line"><span class="lineno"> 2576</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> tip_layers = branch_radius / <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a>; <span class="comment">//The number of layers to be shrinking the circle to create a tip. This produces a 45 degree angle.</span></div>
<div class="line"><span class="lineno"> 2577</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> diameter_angle_scale_factor = <a class="code hl_function" href="../../d4/df0/_array_cwise_unary_ops_8h.html#a0c32a3874bfc5438d11b75c9f40256d1">tan</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ac2482e1ff17824c9f85615be4188049e">tree_support_branch_diameter_angle</a> * <a class="code hl_define" href="../../de/ddd/_extrusion_simulator_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180.);<span class="comment">//*layer_height / branch_radius; // Scale factor per layer to produce the desired angle.</span></div>
<div class="line"><span class="lineno"> 2578</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> radius_sample_resolution = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;m_radius_sample_resolution;</div>
<div class="line"><span class="lineno"> 2579</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> support_on_buildplate_only = config.support_on_build_plate_only.value;</div>
<div class="line"><span class="lineno"> 2580</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> bottom_interface_layers = config.support_interface_bottom_layers.value;</div>
<div class="line"><span class="lineno"> 2581</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> top_interface_layers = config.support_interface_top_layers.value;</div>
<div class="line"><span class="lineno"> 2582</span>    <span class="keywordtype">float</span>        DO_NOT_MOVER_UNDER_MM       = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8697e59f9029b0ce83867137111180e1">is_slim</a> ? 0 : 5;                     <span class="comment">// do not move contact points under 5mm</span></div>
<div class="line"><span class="lineno"> 2583</span>    <span class="keyword">const</span> <span class="keyword">auto</span> nozzle_diameter = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../d5/d8f/class_slic3r_1_1_print.html#af1937a680d19c7dd8d3c24e5ff7332b8">config</a>().nozzle_diameter.get_at(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#abde3ac4f19e1f9d342423a7643e17266">config</a>().support_interface_filament-1);</div>
<div class="line"><span class="lineno"> 2584</span>    <span class="keyword">const</span> <span class="keyword">auto</span> support_line_width = config.support_line_width.get_abs_value(nozzle_diameter);</div>
<div class="line"><span class="lineno"> 2585</span> </div>
<div class="line"><span class="lineno"> 2586</span>    <span class="keyword">auto</span> get_branch_angle = [<span class="keyword">this</span>,&amp;config](<a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> radius) {</div>
<div class="line"><span class="lineno"> 2587</span>        <span class="keywordflow">if</span> (config.tree_support_branch_angle.value &lt; 30.0) <span class="keywordflow">return</span> config.tree_support_branch_angle.value;</div>
<div class="line"><span class="lineno"> 2588</span>        <span class="keywordflow">return</span> (radius - <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8a49148abbffe316cb0548cbc48d0603">MIN_BRANCH_RADIUS</a>) / (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a161d05526fd75928c2dc1d04e4c0c49a">MAX_BRANCH_RADIUS</a> - <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8a49148abbffe316cb0548cbc48d0603">MIN_BRANCH_RADIUS</a>) * (config.tree_support_branch_angle.value - 30.0) + 30.0;</div>
<div class="line"><span class="lineno"> 2589</span>    };</div>
<div class="line"><span class="lineno"> 2590</span>    <span class="keyword">auto</span> get_max_move_dist = [<span class="keyword">this</span>, &amp;config, branch_radius, tip_layers, diameter_angle_scale_factor, wall_count, support_extrusion_width, support_line_width](<span class="keyword">const</span> Node *node, <span class="keywordtype">int</span> <a class="code hl_function" href="../../d0/dd2/namespacefast__float_1_1detail.html#af1bac4dff87eae126e46ad8f47e0ca44">power</a> = 1) {</div>
<div class="line"><span class="lineno"> 2591</span>        <span class="keywordtype">double</span> move_dist = node-&gt;max_move_dist;</div>
<div class="line"><span class="lineno"> 2592</span>        <span class="keywordflow">if</span> (node-&gt;max_move_dist == 0) {</div>
<div class="line"><span class="lineno"> 2593</span>            <span class="keywordflow">if</span> (node-&gt;radius == 0) node-&gt;radius = <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a5b7aa7b2d91917c6952d77796d4584c2">calc_branch_radius</a>(branch_radius, node-&gt;dist_mm_to_top, diameter_angle_scale_factor);</div>
<div class="line"><span class="lineno"> 2594</span>            <span class="keywordtype">double</span> <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">angle</a> = config.tree_support_branch_angle.value;</div>
<div class="line"><span class="lineno"> 2595</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">angle</a> &gt; 30.0 &amp;&amp; node-&gt;radius &gt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8a49148abbffe316cb0548cbc48d0603">MIN_BRANCH_RADIUS</a>)</div>
<div class="line"><span class="lineno"> 2596</span>                <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">angle</a> = (node-&gt;radius - <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8a49148abbffe316cb0548cbc48d0603">MIN_BRANCH_RADIUS</a>) / (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a161d05526fd75928c2dc1d04e4c0c49a">MAX_BRANCH_RADIUS</a> - <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8a49148abbffe316cb0548cbc48d0603">MIN_BRANCH_RADIUS</a>) * (config.tree_support_branch_angle.value - 30.0) + 30.0;</div>
<div class="line"><span class="lineno"> 2597</span>            <span class="keywordtype">double</span> tan_angle           = <a class="code hl_function" href="../../d4/df0/_array_cwise_unary_ops_8h.html#a0c32a3874bfc5438d11b75c9f40256d1">tan</a>(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">angle</a> * <a class="code hl_define" href="../../de/ddd/_extrusion_simulator_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180);</div>
<div class="line"><span class="lineno"> 2598</span>            <span class="keywordtype">int</span> wall_count_     = node-&gt;radius &gt; 2 * support_line_width ? wall_count : 1;</div>
<div class="line"><span class="lineno"> 2599</span>            node-&gt;max_move_dist = (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a7927d0ca1b31b8f9284ea268b11d27d5">angle</a> &lt; 90) ? (<a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a>) (tan_angle * node-&gt;height) * wall_count_ : <a class="code hl_namespace" href="../../d8/dcc/namespacestd.html">std</a>::numeric_limits&lt;<a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a>&gt;::<a class="code hl_function" href="../../df/db1/math_8h.html#a5083c48fbfb60dd70808789479f4db53">max</a>();</div>
<div class="line"><span class="lineno"> 2600</span>            node-&gt;max_move_dist        = std::min(node-&gt;max_move_dist, support_extrusion_width);</div>
<div class="line"><span class="lineno"> 2601</span>            move_dist           = node-&gt;max_move_dist;</div>
<div class="line"><span class="lineno"> 2602</span>        }</div>
<div class="line"><span class="lineno"> 2603</span>        <span class="keywordflow">if</span> (power == 2) move_dist = <a class="code hl_define" href="../../db/d7c/_orient_8cpp.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(move_dist);</div>
<div class="line"><span class="lineno"> 2604</span>        <span class="keywordflow">return</span> move_dist;</div>
<div class="line"><span class="lineno"> 2605</span>    };</div>
<div class="line"><span class="lineno"> 2606</span> </div>
<div class="line"><span class="lineno"> 2607</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;layer_heights = <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a819f86c9e3f1aef6f1c99d66a4c19725">plan_layer_heights</a>(contact_nodes);</div>
<div class="line"><span class="lineno"> 2608</span>    std::vector&lt;LayerHeightData&gt; &amp;layer_heights = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;layer_heights;</div>
<div class="line"><span class="lineno"> 2609</span>    <span class="keywordflow">if</span> (layer_heights.empty()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2610</span> </div>
<div class="line"><span class="lineno"> 2611</span>    std::unordered_set&lt;Node*&gt; to_free_node_set;</div>
<div class="line"><span class="lineno"> 2612</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8e234c218b1adc33974bc22796876ed2">m_spanning_trees</a>.resize(contact_nodes.size());</div>
<div class="line"><span class="lineno"> 2613</span>    <span class="comment">//m_mst_line_x_layer_contour_caches.resize(contact_nodes.size());</span></div>
<div class="line"><span class="lineno"> 2614</span> </div>
<div class="line"><span class="lineno"> 2615</span>    <span class="keywordflow">if</span> (0)</div>
<div class="line"><span class="lineno"> 2616</span>    {<span class="comment">// get outlines below and avoidance area using tbb</span></div>
<div class="line"><span class="lineno"> 2617</span>     <span class="comment">// This part only takes very little time, so we disable it.</span></div>
<div class="line"><span class="lineno"> 2618</span>        <span class="keyword">typedef</span> std::chrono::high_resolution_clock clock_;</div>
<div class="line"><span class="lineno"> 2619</span>        <span class="keyword">typedef</span> std::chrono::duration&lt;double, std::ratio&lt;1&gt; &gt; second_;</div>
<div class="line"><span class="lineno"> 2620</span>        std::chrono::time_point&lt;clock_&gt; t0{ clock_::now() };</div>
<div class="line"><span class="lineno"> 2621</span> </div>
<div class="line"><span class="lineno"> 2622</span>        <span class="comment">// get all the possible radiis</span></div>
<div class="line"><span class="lineno"> 2623</span>        std::vector&lt;std::set&lt;coordf_t&gt; &gt; all_layer_radius(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a39b142c27d4da545d49307bf5569d3ab">m_highest_overhang_layer</a>+1);</div>
<div class="line"><span class="lineno"> 2624</span>        std::vector&lt;std::set&lt;coordf_t&gt;&gt; all_layer_node_dist(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a39b142c27d4da545d49307bf5569d3ab">m_highest_overhang_layer</a> + 1);</div>
<div class="line"><span class="lineno"> 2625</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> layer_nr = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a39b142c27d4da545d49307bf5569d3ab">m_highest_overhang_layer</a>; layer_nr &gt; 0; layer_nr--)</div>
<div class="line"><span class="lineno"> 2626</span>        {</div>
<div class="line"><span class="lineno"> 2627</span>            <span class="keywordflow">if</span> (layer_heights[layer_nr].height &lt; <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2628</span>            <span class="keyword">auto</span>&amp; layer_radius = all_layer_radius[layer_nr];</div>
<div class="line"><span class="lineno"> 2629</span>            <span class="keyword">auto</span>&amp; layer_node_dist = all_layer_node_dist[layer_nr];</div>
<div class="line"><span class="lineno"> 2630</span>            <span class="keywordflow">for</span> (Node *p_node : contact_nodes[layer_nr]) {</div>
<div class="line"><span class="lineno"> 2631</span>                layer_node_dist.emplace(p_node-&gt;dist_mm_to_top);</div>
<div class="line"><span class="lineno"> 2632</span>            }</div>
<div class="line"><span class="lineno"> 2633</span>            <span class="keywordtype">size_t</span> layer_nr_next = layer_heights[layer_nr].next_layer_nr;</div>
<div class="line"><span class="lineno"> 2634</span>            <span class="keywordflow">if</span> (layer_nr_next &lt;= m_highest_overhang_layer &amp;&amp; layer_nr_next&gt;0) {</div>
<div class="line"><span class="lineno"> 2635</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> node_dist : layer_node_dist)</div>
<div class="line"><span class="lineno"> 2636</span>                    all_layer_node_dist[layer_nr_next].emplace(node_dist + layer_heights[layer_nr].<a class="code hl_function" href="../../d0/d25/namespace_slic3r_1_1arrangement.html#a5b816dd05a95b740ac2194b643ceaacc">height</a>);</div>
<div class="line"><span class="lineno"> 2637</span>            }</div>
<div class="line"><span class="lineno"> 2638</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> node_dist : layer_node_dist) {</div>
<div class="line"><span class="lineno"> 2639</span>                layer_radius.emplace(<a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a5b7aa7b2d91917c6952d77796d4584c2">calc_branch_radius</a>(branch_radius, node_dist, diameter_angle_scale_factor));</div>
<div class="line"><span class="lineno"> 2640</span>            }</div>
<div class="line"><span class="lineno"> 2641</span>        }</div>
<div class="line"><span class="lineno"> 2642</span>        <span class="comment">// parallel pre-compute avoidance</span></div>
<div class="line"><span class="lineno"> 2643</span>        <span class="comment">//tbb::parallel_for(tbb::blocked_range&lt;size_t&gt;(1, m_highest_overhang_layer), [&amp;](const tbb::blocked_range&lt;size_t&gt; &amp;range) {</span></div>
<div class="line"><span class="lineno"> 2644</span>            <span class="comment">//for (size_t layer_nr = range.begin(); layer_nr &lt; range.end(); layer_nr++) {</span></div>
<div class="line"><span class="lineno"> 2645</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> layer_nr = 0; layer_nr &lt; all_layer_radius.size(); layer_nr++) {</div>
<div class="line"><span class="lineno"> 2646</span>                BOOST_LOG_TRIVIAL(debug) &lt;&lt; <span class="stringliteral">&quot;pre calculate_avoidance layer=&quot;</span> &lt;&lt; layer_nr;</div>
<div class="line"><span class="lineno"> 2647</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> node_radius : all_layer_radius[layer_nr]) {</div>
<div class="line"><span class="lineno"> 2648</span>                    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;get_avoidance(0, layer_nr);</div>
<div class="line"><span class="lineno"> 2649</span>                    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;get_avoidance(node_radius, layer_nr);</div>
<div class="line"><span class="lineno"> 2650</span>                }</div>
<div class="line"><span class="lineno"> 2651</span>            }</div>
<div class="line"><span class="lineno"> 2652</span>        <span class="comment">//});</span></div>
<div class="line"><span class="lineno"> 2653</span> </div>
<div class="line"><span class="lineno"> 2654</span>        <span class="keywordtype">double</span> duration{ std::chrono::duration_cast&lt;second_&gt;(clock_::now() - t0).count() };</div>
<div class="line"><span class="lineno"> 2655</span>        BOOST_LOG_TRIVIAL(debug) &lt;&lt; <span class="stringliteral">&quot;before m_avoidance_cache.size()=&quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;m_avoidance_cache.size()</div>
<div class="line"><span class="lineno"> 2656</span>            &lt;&lt; <span class="stringliteral">&quot;, takes &quot;</span> &lt;&lt; duration &lt;&lt; <span class="stringliteral">&quot; secs.&quot;</span>;</div>
<div class="line"><span class="lineno"> 2657</span>    }</div>
<div class="line"><span class="lineno"> 2658</span> </div>
<div class="line"><span class="lineno"> 2659</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> layer_nr = contact_nodes.size() - 1; layer_nr &gt; 0; layer_nr--) <span class="comment">// Skip layer 0, since we can&#39;t drop down the vertices there.</span></div>
<div class="line"><span class="lineno"> 2660</span>    {</div>
<div class="line"><span class="lineno"> 2661</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../dc/d88/class_slic3r_1_1_print_base.html#ab5f6b4781d433373200f5f328ebcb4a8">canceled</a>())</div>
<div class="line"><span class="lineno"> 2662</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2663</span> </div>
<div class="line"><span class="lineno"> 2664</span>        <span class="keyword">auto</span>&amp; layer_contact_nodes = contact_nodes[layer_nr];</div>
<div class="line"><span class="lineno"> 2665</span>        <span class="keywordflow">if</span> (layer_contact_nodes.empty())</div>
<div class="line"><span class="lineno"> 2666</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2667</span>        </div>
<div class="line"><span class="lineno"> 2668</span>        <span class="keywordtype">int</span>      layer_nr_next = layer_heights[layer_nr].next_layer_nr;</div>
<div class="line"><span class="lineno"> 2669</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> print_z_next = layer_heights[layer_nr_next].print_z;</div>
<div class="line"><span class="lineno"> 2670</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> height_next = layer_heights[layer_nr_next].height;</div>
<div class="line"><span class="lineno"> 2671</span> </div>
<div class="line"><span class="lineno"> 2672</span>        std::deque&lt;std::pair&lt;size_t, Node*&gt;&gt; unsupported_branch_leaves; <span class="comment">// All nodes that are leaves on this layer that would result in unsupported (&#39;mid-air&#39;) branches.</span></div>
<div class="line"><span class="lineno"> 2673</span>        <span class="keyword">const</span> Layer* ts_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr);</div>
<div class="line"><span class="lineno"> 2674</span> </div>
<div class="line"><span class="lineno"> 2675</span>        <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../dc/d88/class_slic3r_1_1_print_base.html#a5715024e4ace4cdc0d1feb0be6e48ae2">set_status</a>(60, (boost::format(<a class="code hl_define" href="../../da/d6e/_o_b_j_8cpp.html#a7a5970404f762cc8fada02d3018fb45a">_L</a>(<span class="stringliteral">&quot;Support: propagate branches at layer %d&quot;</span>)) % layer_nr).str());</div>
<div class="line"><span class="lineno"> 2676</span> </div>
<div class="line"><span class="lineno"> 2677</span>        <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a> layer_contours = std::move(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;get_contours_with_holes(layer_nr));</div>
<div class="line"><span class="lineno"> 2678</span>        <span class="comment">//std::unordered_map&lt;Line, bool, LineHash&gt;&amp; mst_line_x_layer_contour_cache = m_mst_line_x_layer_contour_caches[layer_nr];</span></div>
<div class="line"><span class="lineno"> 2679</span>        std::unordered_map&lt;Line, bool, LineHash&gt; mst_line_x_layer_contour_cache;</div>
<div class="line"><span class="lineno"> 2680</span>        <span class="keyword">auto</span> is_line_cut_by_contour = [&amp;mst_line_x_layer_contour_cache,&amp;layer_contours](<a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> <a class="code hl_enumvalue" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a5c3960032271d7907677d3507c909780a0cc175b9c0f1b6a831c399e269772661">a</a>, <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> <a class="code hl_enumvalue" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a5c3960032271d7907677d3507c909780a92eb5ffee6ae2fec3ad71c777531578f">b</a>)</div>
<div class="line"><span class="lineno"> 2681</span>        {</div>
<div class="line"><span class="lineno"> 2682</span>            <span class="keyword">auto</span> iter = mst_line_x_layer_contour_cache.find({ <a class="code hl_enumvalue" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a5c3960032271d7907677d3507c909780a0cc175b9c0f1b6a831c399e269772661">a</a>, <a class="code hl_enumvalue" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a5c3960032271d7907677d3507c909780a92eb5ffee6ae2fec3ad71c777531578f">b</a> });</div>
<div class="line"><span class="lineno"> 2683</span>            <span class="keywordflow">if</span> (iter != mst_line_x_layer_contour_cache.end()) {</div>
<div class="line"><span class="lineno"> 2684</span>                <span class="keywordflow">if</span> (iter-&gt;second)</div>
<div class="line"><span class="lineno"> 2685</span>                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2686</span>            }</div>
<div class="line"><span class="lineno"> 2687</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2688</span>                <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#ac4c1ac0e831a8c190d77ca6be05ee881">tic</a>();</div>
<div class="line"><span class="lineno"> 2689</span>                Line ln(b, a);</div>
<div class="line"><span class="lineno"> 2690</span>                <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a0913e2e6b7d28032c33cfee03f145fba">Lines</a> pls_intersect = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a0d1dc28c0b564a1adbfbefbc89ae9664">intersection_ln</a>(ln, layer_contours);</div>
<div class="line"><span class="lineno"> 2691</span>                mst_line_x_layer_contour_cache.insert({ {<a class="code hl_enumvalue" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a5c3960032271d7907677d3507c909780a0cc175b9c0f1b6a831c399e269772661">a</a>, <a class="code hl_enumvalue" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a5c3960032271d7907677d3507c909780a92eb5ffee6ae2fec3ad71c777531578f">b</a>}, !pls_intersect.empty() });</div>
<div class="line"><span class="lineno"> 2692</span>                mst_line_x_layer_contour_cache.insert({ ln, !pls_intersect.empty() });</div>
<div class="line"><span class="lineno"> 2693</span>                <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#ad3b9254cd8fead7271fb147a63623eef">stage_add</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a3772b58ee643ecf081c69d7850adc791">STAGE_intersection_ln</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2694</span>                <span class="keywordflow">if</span> (!pls_intersect.empty())</div>
<div class="line"><span class="lineno"> 2695</span>                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2696</span>            }</div>
<div class="line"><span class="lineno"> 2697</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2698</span>        };</div>
<div class="line"><span class="lineno"> 2699</span> </div>
<div class="line"><span class="lineno"> 2700</span>        <span class="comment">//Group together all nodes for each part.</span></div>
<div class="line"><span class="lineno"> 2701</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a>&amp; parts = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;get_avoidance(0, layer_nr);</div>
<div class="line"><span class="lineno"> 2702</span>        std::vector&lt;std::unordered_map&lt;Point, Node*, PointHash&gt;&gt; nodes_per_part(1 + parts.size()); <span class="comment">//All nodes that aren&#39;t inside a part get grouped together in the 0th part.</span></div>
<div class="line"><span class="lineno"> 2703</span>        <span class="keywordflow">for</span> (Node* p_node : layer_contact_nodes)</div>
<div class="line"><span class="lineno"> 2704</span>        {</div>
<div class="line"><span class="lineno"> 2705</span>            <span class="keyword">const</span> Node&amp; node = *p_node;</div>
<div class="line"><span class="lineno"> 2706</span> </div>
<div class="line"><span class="lineno"> 2707</span>            <span class="keywordflow">if</span> (node.distance_to_top &lt; 0) {</div>
<div class="line"><span class="lineno"> 2708</span>                <span class="comment">// gap nodes do not merge or move</span></div>
<div class="line"><span class="lineno"> 2709</span>                Node* next_node = <span class="keyword">new</span> Node(p_node-&gt;position, p_node-&gt;distance_to_top + 1, layer_nr_next, p_node-&gt;support_roof_layers_below - 1, p_node-&gt;to_buildplate, p_node,</div>
<div class="line"><span class="lineno"> 2710</span>                    print_z_next, height_next);</div>
<div class="line"><span class="lineno"> 2711</span>                get_max_move_dist(next_node);</div>
<div class="line"><span class="lineno"> 2712</span>                next_node-&gt;is_merged = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2713</span>                contact_nodes[layer_nr_next].emplace_back(next_node);</div>
<div class="line"><span class="lineno"> 2714</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2715</span>            }</div>
<div class="line"><span class="lineno"> 2716</span>            <span class="keywordflow">if</span> (support_on_buildplate_only &amp;&amp; !node.to_buildplate) <span class="comment">//Can&#39;t rest on model and unable to reach the build plate. Then we must drop the node and leave parts unsupported.</span></div>
<div class="line"><span class="lineno"> 2717</span>            {</div>
<div class="line"><span class="lineno"> 2718</span>                unsupported_branch_leaves.push_front({ layer_nr, p_node });</div>
<div class="line"><span class="lineno"> 2719</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2720</span>            }</div>
<div class="line"><span class="lineno"> 2721</span>            <span class="keywordflow">if</span> (node.to_buildplate || parts.empty()) <span class="comment">//It&#39;s outside, so make it go towards the build plate.</span></div>
<div class="line"><span class="lineno"> 2722</span>            {</div>
<div class="line"><span class="lineno"> 2723</span>                nodes_per_part[0][node.position] = p_node;</div>
<div class="line"><span class="lineno"> 2724</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2725</span>            }</div>
<div class="line"><span class="lineno"> 2726</span> </div>
<div class="line"><span class="lineno"> 2727</span>            <span class="comment">/* Find which part this node is located in and group the nodes in</span></div>
<div class="line"><span class="lineno"> 2728</span><span class="comment">             * the same part together. Since nodes have a radius and the</span></div>
<div class="line"><span class="lineno"> 2729</span><span class="comment">             * avoidance areas are offset by that radius, the set of parts may</span></div>
<div class="line"><span class="lineno"> 2730</span><span class="comment">             * be different per node. Here we consider a node to be inside the</span></div>
<div class="line"><span class="lineno"> 2731</span><span class="comment">             * part that is closest. The node may be inside a bigger part that</span></div>
<div class="line"><span class="lineno"> 2732</span><span class="comment">             * is actually two parts merged together due to an offset. In that</span></div>
<div class="line"><span class="lineno"> 2733</span><span class="comment">             * case we may incorrectly keep two nodes separate, but at least</span></div>
<div class="line"><span class="lineno"> 2734</span><span class="comment">             * every node falls into some group.</span></div>
<div class="line"><span class="lineno"> 2735</span><span class="comment">             */</span></div>
<div class="line"><span class="lineno"> 2736</span>            <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> closest_part_distance2 = std::numeric_limits&lt;coordf_t&gt;::max();</div>
<div class="line"><span class="lineno"> 2737</span>            <span class="keywordtype">size_t</span> closest_part = -1;</div>
<div class="line"><span class="lineno"> 2738</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> part_index = 0; part_index &lt; parts.size(); part_index++)</div>
<div class="line"><span class="lineno"> 2739</span>            {</div>
<div class="line"><span class="lineno"> 2740</span>                <span class="comment">//constexpr bool border_result = true;</span></div>
<div class="line"><span class="lineno"> 2741</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(parts[part_index], node.position)) <span class="comment">//If it&#39;s inside, the distance is 0 and this part is considered the best.</span></div>
<div class="line"><span class="lineno"> 2742</span>                {</div>
<div class="line"><span class="lineno"> 2743</span>                    closest_part = part_index;</div>
<div class="line"><span class="lineno"> 2744</span>                    closest_part_distance2 = 0;</div>
<div class="line"><span class="lineno"> 2745</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2746</span>                }</div>
<div class="line"><span class="lineno"> 2747</span> </div>
<div class="line"><span class="lineno"> 2748</span>                <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> closest_point = *parts[part_index].contour.closest_point(node.position);</div>
<div class="line"><span class="lineno"> 2749</span>                <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> distance2 = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a513afc9a9ff0d9199826dffec9c83a3a">vsize2_with_unscale</a>(node.position - closest_point);</div>
<div class="line"><span class="lineno"> 2750</span>                <span class="keywordflow">if</span> (distance2 &lt; closest_part_distance2)</div>
<div class="line"><span class="lineno"> 2751</span>                {</div>
<div class="line"><span class="lineno"> 2752</span>                    closest_part_distance2 = distance2;</div>
<div class="line"><span class="lineno"> 2753</span>                    closest_part = part_index;</div>
<div class="line"><span class="lineno"> 2754</span>                }</div>
<div class="line"><span class="lineno"> 2755</span>            }</div>
<div class="line"><span class="lineno"> 2756</span>            <span class="comment">//Put it in the best one.</span></div>
<div class="line"><span class="lineno"> 2757</span>            nodes_per_part[closest_part + 1][node.position] = p_node; <span class="comment">//Index + 1 because the 0th index is the outside part.</span></div>
<div class="line"><span class="lineno"> 2758</span>        }</div>
<div class="line"><span class="lineno"> 2759</span> </div>
<div class="line"><span class="lineno"> 2760</span>        <span class="comment">//Create a MST for every part.</span></div>
<div class="line"><span class="lineno"> 2761</span>        <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#ac4c1ac0e831a8c190d77ca6be05ee881">tic</a>();</div>
<div class="line"><span class="lineno"> 2762</span>        <span class="comment">//std::vector&lt;MinimumSpanningTree&gt;&amp; spanning_trees = m_spanning_trees[layer_nr];</span></div>
<div class="line"><span class="lineno"> 2763</span>        std::vector&lt;MinimumSpanningTree&gt; spanning_trees;</div>
<div class="line"><span class="lineno"> 2764</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> std::unordered_map&lt;Point, Node*, PointHash&gt;&amp; group : nodes_per_part)</div>
<div class="line"><span class="lineno"> 2765</span>        {</div>
<div class="line"><span class="lineno"> 2766</span>            std::vector&lt;Point&gt; points_to_buildplate;</div>
<div class="line"><span class="lineno"> 2767</span>            <span class="keywordflow">for</span> (<span class="keyword">const</span> std::pair&lt;const Point, Node*&gt;&amp; entry : group)</div>
<div class="line"><span class="lineno"> 2768</span>            {</div>
<div class="line"><span class="lineno"> 2769</span>                points_to_buildplate.emplace_back(entry.first); <span class="comment">//Just the position of the node.</span></div>
<div class="line"><span class="lineno"> 2770</span>            }</div>
<div class="line"><span class="lineno"> 2771</span>            spanning_trees.emplace_back(points_to_buildplate);</div>
<div class="line"><span class="lineno"> 2772</span>        }</div>
<div class="line"><span class="lineno"> 2773</span>        <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#ad3b9254cd8fead7271fb147a63623eef">stage_add</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a844f6accf8c46297280874903347798c">STAGE_MinimumSpanningTree</a>,<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2774</span> </div>
<div class="line"><span class="lineno"> 2775</span><span class="preprocessor">#ifdef SUPPORT_TREE_DEBUG_TO_SVG</span></div>
<div class="line"><span class="lineno"> 2776</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> branch_radius_temp = 0;</div>
<div class="line"><span class="lineno"> 2777</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> max_y = std::numeric_limits&lt;coordf_t&gt;::min();</div>
<div class="line"><span class="lineno"> 2778</span>        draw_layer_mst(std::to_string(ts_layer-&gt;print_z), spanning_trees, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a3052da5e28b9b358d43ad43d7e9173ed">lslices</a>);</div>
<div class="line"><span class="lineno"> 2779</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2780</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> group_index = 0; group_index &lt; nodes_per_part.size(); group_index++)</div>
<div class="line"><span class="lineno"> 2781</span>        {</div>
<div class="line"><span class="lineno"> 2782</span>            <span class="keyword">const</span> MinimumSpanningTree&amp; mst = spanning_trees[group_index];</div>
<div class="line"><span class="lineno"> 2783</span>            <span class="comment">//In the first pass, merge all nodes that are close together.</span></div>
<div class="line"><span class="lineno"> 2784</span>            std::unordered_set&lt;Node*&gt; to_delete;</div>
<div class="line"><span class="lineno"> 2785</span>            <span class="keywordflow">for</span> (<span class="keyword">const</span> std::pair&lt;const Point, Node*&gt;&amp; entry : nodes_per_part[group_index])</div>
<div class="line"><span class="lineno"> 2786</span>            {</div>
<div class="line"><span class="lineno"> 2787</span>                Node* p_node = entry.second;</div>
<div class="line"><span class="lineno"> 2788</span>                Node&amp; node = *p_node;</div>
<div class="line"><span class="lineno"> 2789</span>                <span class="keywordflow">if</span> (to_delete.find(p_node) != to_delete.end())</div>
<div class="line"><span class="lineno"> 2790</span>                {</div>
<div class="line"><span class="lineno"> 2791</span>                    <span class="keywordflow">continue</span>; <span class="comment">//Delete this node (don&#39;t create a new node for it on the next layer).</span></div>
<div class="line"><span class="lineno"> 2792</span>                }</div>
<div class="line"><span class="lineno"> 2793</span>                <span class="keyword">const</span> std::vector&lt;Point&gt;&amp; neighbours = mst.adjacent_nodes(node.position);</div>
<div class="line"><span class="lineno"> 2794</span>                <span class="keywordflow">if</span> (node.type == <a class="code hl_enumvalue" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a80f9da0a91828bd383c02077dfa419f2">ePolygon</a>) {</div>
<div class="line"><span class="lineno"> 2795</span>                    <span class="comment">// Remove all neighbours that are completely inside the polygon and merge them into this node.</span></div>
<div class="line"><span class="lineno"> 2796</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> &amp;neighbour : neighbours) {</div>
<div class="line"><span class="lineno"> 2797</span>                        Node *    neighbour_node          = nodes_per_part[group_index][neighbour];</div>
<div class="line"><span class="lineno"> 2798</span>                        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a8a7f69c27280e7542b2d1fd979af4545">coord_t</a>    neighbour_radius = <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(<a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a5b7aa7b2d91917c6952d77796d4584c2">calc_branch_radius</a>(branch_radius, neighbour_node-&gt;dist_mm_to_top, diameter_angle_scale_factor));</div>
<div class="line"><span class="lineno"> 2799</span>                        <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>     pt_north = neighbour + <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(0, neighbour_radius), pt_south = neighbour - <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(0, neighbour_radius),</div>
<div class="line"><span class="lineno"> 2800</span>                              pt_west = neighbour - <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(neighbour_radius, 0), pt_east = neighbour + <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(neighbour_radius, 0);</div>
<div class="line"><span class="lineno"> 2801</span>                        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(*node.overhang, neighbour) &amp;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(*node.overhang, pt_north) &amp;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(*node.overhang, pt_south)</div>
<div class="line"><span class="lineno"> 2802</span>                            &amp;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(*node.overhang, pt_west) &amp;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(*node.overhang, pt_east)){</div>
<div class="line"><span class="lineno"> 2803</span>                            node.distance_to_top           = std::max(node.distance_to_top, neighbour_node-&gt;distance_to_top);</div>
<div class="line"><span class="lineno"> 2804</span>                            node.support_roof_layers_below = std::max(node.support_roof_layers_below, neighbour_node-&gt;support_roof_layers_below);</div>
<div class="line"><span class="lineno"> 2805</span>                            node.dist_mm_to_top            = std::max(node.dist_mm_to_top, neighbour_node-&gt;dist_mm_to_top);</div>
<div class="line"><span class="lineno"> 2806</span>                            node.merged_neighbours.push_front(neighbour_node);</div>
<div class="line"><span class="lineno"> 2807</span>                            node.merged_neighbours.insert(node.merged_neighbours.end(), neighbour_node-&gt;merged_neighbours.begin(), neighbour_node-&gt;merged_neighbours.end());</div>
<div class="line"><span class="lineno"> 2808</span>                            node.is_merged = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2809</span>                            to_delete.insert(neighbour_node);</div>
<div class="line"><span class="lineno"> 2810</span>                        }</div>
<div class="line"><span class="lineno"> 2811</span>                    }</div>
<div class="line"><span class="lineno"> 2812</span>                }</div>
<div class="line"><span class="lineno"> 2813</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (neighbours.size() == 1 &amp;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a513afc9a9ff0d9199826dffec9c83a3a">vsize2_with_unscale</a>(neighbours[0] - node.position) &lt; max_move_distance2 &amp;&amp; mst.adjacent_nodes(neighbours[0]).size() == 1 &amp;&amp;</div>
<div class="line"><span class="lineno"> 2814</span>                           nodes_per_part[group_index][neighbours[0]]-&gt;type!=<a class="code hl_enumvalue" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a80f9da0a91828bd383c02077dfa419f2">ePolygon</a>) <span class="comment">// We have just two nodes left, and they&#39;re very close, and the only neighbor is not ePolygon</span></div>
<div class="line"><span class="lineno"> 2815</span>                {</div>
<div class="line"><span class="lineno"> 2816</span>                    <span class="comment">//Insert a completely new node and let both original nodes fade.</span></div>
<div class="line"><span class="lineno"> 2817</span>                    <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> next_position = (node.position + neighbours[0]) / 2; <span class="comment">//Average position of the two nodes.</span></div>
<div class="line"><span class="lineno"> 2818</span> </div>
<div class="line"><span class="lineno"> 2819</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> branch_radius_node = <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a5b7aa7b2d91917c6952d77796d4584c2">calc_branch_radius</a>(branch_radius, node.dist_mm_to_top, diameter_angle_scale_factor);</div>
<div class="line"><span class="lineno"> 2820</span> </div>
<div class="line"><span class="lineno"> 2821</span>                    <span class="keyword">auto</span> avoid_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;get_avoidance(branch_radius_node, layer_nr_next);</div>
<div class="line"><span class="lineno"> 2822</span>                    <span class="keywordflow">if</span> (group_index == 0)</div>
<div class="line"><span class="lineno"> 2823</span>                    {</div>
<div class="line"><span class="lineno"> 2824</span>                        <span class="comment">//Avoid collisions.</span></div>
<div class="line"><span class="lineno"> 2825</span>                        <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> max_move_between_samples = max_move_distance + radius_sample_resolution + <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>; <span class="comment">//100 micron extra for rounding errors.</span></div>
<div class="line"><span class="lineno"> 2826</span>                        <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#abc56d807a8ea5fb67d17f565ddb82d7f">move_out_expolys</a>(avoid_layer, next_position, radius_sample_resolution + <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>, max_move_between_samples);</div>
<div class="line"><span class="lineno"> 2827</span>                    }</div>
<div class="line"><span class="lineno"> 2828</span> </div>
<div class="line"><span class="lineno"> 2829</span>                    Node* neighbour = nodes_per_part[group_index][neighbours[0]];</div>
<div class="line"><span class="lineno"> 2830</span>                    Node* node_;</div>
<div class="line"><span class="lineno"> 2831</span>                    <span class="keywordflow">if</span> (p_node-&gt;parent &amp;&amp; neighbour-&gt;parent)</div>
<div class="line"><span class="lineno"> 2832</span>                        node_ = (node.dist_mm_to_top &gt;= neighbour-&gt;dist_mm_to_top &amp;&amp; p_node-&gt;parent) ? p_node : neighbour;</div>
<div class="line"><span class="lineno"> 2833</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2834</span>                        node_ = p_node-&gt;parent ? p_node : neighbour;</div>
<div class="line"><span class="lineno"> 2835</span>                    <span class="comment">// Make sure the next pass doesn&#39;t drop down either of these (since that already happened).</span></div>
<div class="line"><span class="lineno"> 2836</span>                    node_-&gt;merged_neighbours.push_front(node_ == p_node ? neighbour : p_node);</div>
<div class="line"><span class="lineno"> 2837</span>                    <span class="keyword">const</span> <span class="keywordtype">bool</span> to_buildplate = !<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;get_avoidance(0, layer_nr_next), next_position);</div>
<div class="line"><span class="lineno"> 2838</span>                    Node *     next_node     = <span class="keyword">new</span> Node(next_position, node_-&gt;distance_to_top + 1, layer_nr_next, node_-&gt;support_roof_layers_below-1, to_buildplate, node_,</div>
<div class="line"><span class="lineno"> 2839</span>                                               print_z_next, height_next);</div>
<div class="line"><span class="lineno"> 2840</span>                    next_node-&gt;movement = next_position - node.position;</div>
<div class="line"><span class="lineno"> 2841</span>                    get_max_move_dist(next_node);</div>
<div class="line"><span class="lineno"> 2842</span>                    next_node-&gt;is_merged     = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2843</span>                    contact_nodes[layer_nr_next].push_back(next_node);</div>
<div class="line"><span class="lineno"> 2844</span> </div>
<div class="line"><span class="lineno"> 2845</span> </div>
<div class="line"><span class="lineno"> 2846</span>                    to_delete.insert(neighbour);</div>
<div class="line"><span class="lineno"> 2847</span>                    to_delete.insert(p_node);</div>
<div class="line"><span class="lineno"> 2848</span>                }</div>
<div class="line"><span class="lineno"> 2849</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (neighbours.size() &gt; 1) <span class="comment">//Don&#39;t merge leaf nodes because we would then incur movement greater than the maximum move distance.</span></div>
<div class="line"><span class="lineno"> 2850</span>                {</div>
<div class="line"><span class="lineno"> 2851</span>                    <span class="comment">//Remove all neighbours that are too close and merge them into this node.</span></div>
<div class="line"><span class="lineno"> 2852</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>&amp; neighbour : neighbours)</div>
<div class="line"><span class="lineno"> 2853</span>                    {</div>
<div class="line"><span class="lineno"> 2854</span>                        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a513afc9a9ff0d9199826dffec9c83a3a">vsize2_with_unscale</a>(neighbour - node.position) &lt; <span class="comment">/*max_move_distance2*/</span>get_max_move_dist(&amp;node,2))</div>
<div class="line"><span class="lineno"> 2855</span>                        {</div>
<div class="line"><span class="lineno"> 2856</span>                            Node* neighbour_node = nodes_per_part[group_index][neighbour];</div>
<div class="line"><span class="lineno"> 2857</span>                            <span class="keywordflow">if</span> (neighbour_node-&gt;type == <a class="code hl_enumvalue" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a80f9da0a91828bd383c02077dfa419f2">ePolygon</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2858</span> </div>
<div class="line"><span class="lineno"> 2859</span>                            node.distance_to_top = std::max(node.distance_to_top, neighbour_node-&gt;distance_to_top);</div>
<div class="line"><span class="lineno"> 2860</span>                            node.support_roof_layers_below = std::max(node.support_roof_layers_below, neighbour_node-&gt;support_roof_layers_below);</div>
<div class="line"><span class="lineno"> 2861</span>                            node.dist_mm_to_top            = std::max(node.dist_mm_to_top, neighbour_node-&gt;dist_mm_to_top);</div>
<div class="line"><span class="lineno"> 2862</span>                            node.merged_neighbours.push_front(neighbour_node);</div>
<div class="line"><span class="lineno"> 2863</span>                            node.merged_neighbours.insert(node.merged_neighbours.end(), neighbour_node-&gt;merged_neighbours.begin(), neighbour_node-&gt;merged_neighbours.end());</div>
<div class="line"><span class="lineno"> 2864</span>                            node.is_merged = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2865</span>                            to_delete.insert(neighbour_node);</div>
<div class="line"><span class="lineno"> 2866</span>                        }</div>
<div class="line"><span class="lineno"> 2867</span>                    }</div>
<div class="line"><span class="lineno"> 2868</span>                }</div>
<div class="line"><span class="lineno"> 2869</span>            }</div>
<div class="line"><span class="lineno"> 2870</span> </div>
<div class="line"><span class="lineno"> 2871</span>            <span class="comment">//In the second pass, move all middle nodes.</span></div>
<div class="line"><span class="lineno"> 2872</span>            <span class="keywordflow">for</span> (<span class="keyword">const</span> std::pair&lt;const Point, Node*&gt;&amp; entry : nodes_per_part[group_index])</div>
<div class="line"><span class="lineno"> 2873</span>            {</div>
<div class="line"><span class="lineno"> 2874</span>                Node* p_node = entry.second;</div>
<div class="line"><span class="lineno"> 2875</span>                <span class="keyword">const</span> Node&amp; node = *p_node;</div>
<div class="line"><span class="lineno"> 2876</span>                <span class="keywordflow">if</span> (to_delete.find(p_node) != to_delete.end())</div>
<div class="line"><span class="lineno"> 2877</span>                {</div>
<div class="line"><span class="lineno"> 2878</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2879</span>                }</div>
<div class="line"><span class="lineno"> 2880</span>                <span class="keywordflow">if</span> (node.type == <a class="code hl_enumvalue" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a80f9da0a91828bd383c02077dfa419f2">ePolygon</a>) {</div>
<div class="line"><span class="lineno"> 2881</span>                    <span class="comment">// polygon node do not merge or move</span></div>
<div class="line"><span class="lineno"> 2882</span>                    <span class="keyword">const</span> <span class="keywordtype">bool</span> to_buildplate = !<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;m_layer_outlines[layer_nr], p_node-&gt;position);</div>
<div class="line"><span class="lineno"> 2883</span>                    Node *     next_node = <span class="keyword">new</span> Node(p_node-&gt;position, p_node-&gt;distance_to_top + 1, layer_nr_next, p_node-&gt;support_roof_layers_below - 1, to_buildplate,</div>
<div class="line"><span class="lineno"> 2884</span>                                               p_node, print_z_next, height_next);</div>
<div class="line"><span class="lineno"> 2885</span>                    next_node-&gt;max_move_dist = 0;</div>
<div class="line"><span class="lineno"> 2886</span>                    next_node-&gt;is_merged     = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2887</span>                    contact_nodes[layer_nr_next].emplace_back(next_node);</div>
<div class="line"><span class="lineno"> 2888</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2889</span>                }</div>
<div class="line"><span class="lineno"> 2890</span> </div>
<div class="line"><span class="lineno"> 2891</span>                <span class="comment">//If the branch falls completely inside a collision area (the entire branch would be removed by the X/Y offset), delete it.</span></div>
<div class="line"><span class="lineno"> 2892</span>                <span class="keywordflow">if</span> (group_index &gt; 0 &amp;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;get_collision(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;m_xy_distance, layer_nr), node.position))</div>
<div class="line"><span class="lineno"> 2893</span>                {</div>
<div class="line"><span class="lineno"> 2894</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> branch_radius_node = <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a5b7aa7b2d91917c6952d77796d4584c2">calc_branch_radius</a>(branch_radius, node.dist_mm_to_top, diameter_angle_scale_factor);</div>
<div class="line"><span class="lineno"> 2895</span>                    <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> to_outside = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a823e21c7e9a69135fb0f18394fb6617c">projection_onto</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;get_collision(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;m_xy_distance, layer_nr), node.position);</div>
<div class="line"><span class="lineno"> 2896</span>                    <span class="keywordtype">double</span> dist2_to_outside = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a513afc9a9ff0d9199826dffec9c83a3a">vsize2_with_unscale</a>(node.position - to_outside);</div>
<div class="line"><span class="lineno"> 2897</span>                    <span class="keywordflow">if</span> (dist2_to_outside &gt;= branch_radius_node * branch_radius_node) <span class="comment">//Too far inside.</span></div>
<div class="line"><span class="lineno"> 2898</span>                    {</div>
<div class="line"><span class="lineno"> 2899</span>                        <span class="keywordflow">if</span> (support_on_buildplate_only)</div>
<div class="line"><span class="lineno"> 2900</span>                        {</div>
<div class="line"><span class="lineno"> 2901</span>                            unsupported_branch_leaves.push_front({ layer_nr, p_node });</div>
<div class="line"><span class="lineno"> 2902</span>                        }</div>
<div class="line"><span class="lineno"> 2903</span>                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2904</span>                            Node* pn = p_node;</div>
<div class="line"><span class="lineno"> 2905</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= bottom_interface_layers &amp;&amp; pn; i++, pn = pn-&gt;parent)</div>
<div class="line"><span class="lineno"> 2906</span>                                pn-&gt;support_floor_layers_above = bottom_interface_layers - i + 1; <span class="comment">// +1 so the parent node has support_floor_layers_above=2</span></div>
<div class="line"><span class="lineno"> 2907</span>                            to_delete.insert(p_node);</div>
<div class="line"><span class="lineno"> 2908</span>                        }</div>
<div class="line"><span class="lineno"> 2909</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2910</span>                    }</div>
<div class="line"><span class="lineno"> 2911</span>                    <span class="comment">// if the link between parent and current is cut by contours, mark current as bottom contact node</span></div>
<div class="line"><span class="lineno"> 2912</span>                    <span class="keywordflow">if</span> (p_node-&gt;parent &amp;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a0d1dc28c0b564a1adbfbefbc89ae9664">intersection_ln</a>({p_node-&gt;position, p_node-&gt;parent-&gt;position}, layer_contours).<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a83fc268888773d5c0f886fc2e54b8c64">empty</a>()==<span class="keyword">false</span>)</div>
<div class="line"><span class="lineno"> 2913</span>                    {</div>
<div class="line"><span class="lineno"> 2914</span>                        Node* pn = p_node-&gt;parent;</div>
<div class="line"><span class="lineno"> 2915</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= bottom_interface_layers &amp;&amp; pn; i++, pn = pn-&gt;parent)</div>
<div class="line"><span class="lineno"> 2916</span>                            pn-&gt;support_floor_layers_above = bottom_interface_layers - i + 1;</div>
<div class="line"><span class="lineno"> 2917</span>                        to_delete.insert(p_node);</div>
<div class="line"><span class="lineno"> 2918</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2919</span>                    }</div>
<div class="line"><span class="lineno"> 2920</span>                }</div>
<div class="line"><span class="lineno"> 2921</span>                <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> next_layer_vertex = node.position;</div>
<div class="line"><span class="lineno"> 2922</span>                <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> move_to_neighbor_center;</div>
<div class="line"><span class="lineno"> 2923</span>                std::vector&lt;Point&gt;       moves;</div>
<div class="line"><span class="lineno"> 2924</span>                std::vector&lt;float&gt;       weights;</div>
<div class="line"><span class="lineno"> 2925</span>                <span class="keyword">const</span> std::vector&lt;Point&gt; neighbours = mst.adjacent_nodes(node.position);</div>
<div class="line"><span class="lineno"> 2926</span>                <span class="comment">// 1. do not merge neighbors under 5mm</span></div>
<div class="line"><span class="lineno"> 2927</span>                <span class="comment">// 2. Only merge node with single neighbor in distance between [max_move_distance, 10mm/layer_height]</span></div>
<div class="line"><span class="lineno"> 2928</span>                <span class="keywordtype">float</span> dist2_to_first_neighbor = neighbours.empty() ? 0 : <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a513afc9a9ff0d9199826dffec9c83a3a">vsize2_with_unscale</a>(neighbours[0] - node.position);</div>
<div class="line"><span class="lineno"> 2929</span>                <span class="keywordflow">if</span> (ts_layer-&gt;print_z &gt; DO_NOT_MOVER_UNDER_MM &amp;&amp;</div>
<div class="line"><span class="lineno"> 2930</span>                    (neighbours.size() &gt; 1 || (neighbours.size() == 1 &amp;&amp; dist2_to_first_neighbor &gt;= max_move_distance2))) <span class="comment">// Only nodes that aren&#39;t about to collapse.</span></div>
<div class="line"><span class="lineno"> 2931</span>                {</div>
<div class="line"><span class="lineno"> 2932</span>                    <span class="comment">// Move towards the average position of all neighbours.</span></div>
<div class="line"><span class="lineno"> 2933</span>                    <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> sum_direction(0, 0);</div>
<div class="line"><span class="lineno"> 2934</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> &amp;neighbour : neighbours) {</div>
<div class="line"><span class="lineno"> 2935</span>                        <span class="comment">// do not move to the neighbor to be deleted</span></div>
<div class="line"><span class="lineno"> 2936</span>                        Node *neighbour_node = nodes_per_part[group_index][neighbour];</div>
<div class="line"><span class="lineno"> 2937</span>                        <span class="keywordflow">if</span> (to_delete.find(neighbour_node) != to_delete.end()) <span class="keywordflow">continue</span>; </div>
<div class="line"><span class="lineno"> 2938</span> </div>
<div class="line"><span class="lineno"> 2939</span>                        <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> direction = neighbour - node.position;</div>
<div class="line"><span class="lineno"> 2940</span>                        <span class="comment">// do not move to neighbor that&#39;s too far away (即使以最大速度移动，在接触热床之前都无法汇聚)</span></div>
<div class="line"><span class="lineno"> 2941</span>                        <span class="keywordtype">float</span> dist2_to_neighbor = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a513afc9a9ff0d9199826dffec9c83a3a">vsize2_with_unscale</a>(direction);</div>
<div class="line"><span class="lineno"> 2942</span> </div>
<div class="line"><span class="lineno"> 2943</span>                        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> branch_bottom_radius = <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a5b7aa7b2d91917c6952d77796d4584c2">calc_branch_radius</a>(branch_radius, node.dist_mm_to_top + node.print_z, diameter_angle_scale_factor);</div>
<div class="line"><span class="lineno"> 2944</span>                        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> neighbour_bottom_radius = <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a5b7aa7b2d91917c6952d77796d4584c2">calc_branch_radius</a>(branch_radius, neighbour_node-&gt;dist_mm_to_top + neighbour_node-&gt;print_z, diameter_angle_scale_factor);</div>
<div class="line"><span class="lineno"> 2945</span>                        <span class="keywordtype">double</span> max_converge_distance = tan_angle * (ts_layer-&gt;print_z - DO_NOT_MOVER_UNDER_MM) + std::max(branch_bottom_radius, neighbour_bottom_radius);</div>
<div class="line"><span class="lineno"> 2946</span>                        <span class="keywordflow">if</span> (dist2_to_neighbor &gt; max_converge_distance * max_converge_distance) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2947</span> </div>
<div class="line"><span class="lineno"> 2948</span>                        <span class="keywordflow">if</span> (is_line_cut_by_contour(node.position, neighbour)) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2949</span> </div>
<div class="line"><span class="lineno"> 2950</span>                        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0fe17d4240db49835485cfc72af0fd1b">is_strong</a>)</div>
<div class="line"><span class="lineno"> 2951</span>                            sum_direction += direction * (1 / dist2_to_neighbor);</div>
<div class="line"><span class="lineno"> 2952</span>                        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2953</span>                            sum_direction += direction;                        </div>
<div class="line"><span class="lineno"> 2954</span>                    }</div>
<div class="line"><span class="lineno"> 2955</span> </div>
<div class="line"><span class="lineno"> 2956</span>                    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0fe17d4240db49835485cfc72af0fd1b">is_strong</a>)</div>
<div class="line"><span class="lineno"> 2957</span>                        move_to_neighbor_center = sum_direction;</div>
<div class="line"><span class="lineno"> 2958</span>                    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2959</span>                        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a513afc9a9ff0d9199826dffec9c83a3a">vsize2_with_unscale</a>(sum_direction) &lt;= max_move_distance2) {</div>
<div class="line"><span class="lineno"> 2960</span>                            move_to_neighbor_center = sum_direction;</div>
<div class="line"><span class="lineno"> 2961</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2962</span>                            move_to_neighbor_center = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#aa3fa458858b2d5a3b0bfb1108f9f781f">normal</a>(sum_direction, <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(get_max_move_dist(&amp;node)));</div>
<div class="line"><span class="lineno"> 2963</span>                        }</div>
<div class="line"><span class="lineno"> 2964</span>                    }</div>
<div class="line"><span class="lineno"> 2965</span>                }</div>
<div class="line"><span class="lineno"> 2966</span> </div>
<div class="line"><span class="lineno"> 2967</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> branch_radius_node = <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a5b7aa7b2d91917c6952d77796d4584c2">calc_branch_radius</a>(branch_radius, node.dist_mm_to_top<span class="comment">/*+node.print_z*/</span>, diameter_angle_scale_factor);</div>
<div class="line"><span class="lineno"> 2968</span><span class="preprocessor">#ifdef SUPPORT_TREE_DEBUG_TO_SVG</span></div>
<div class="line"><span class="lineno"> 2969</span>                <span class="keywordflow">if</span> (node.position(1) &gt; max_y) {</div>
<div class="line"><span class="lineno"> 2970</span>                    max_y              = node.position(1);</div>
<div class="line"><span class="lineno"> 2971</span>                    branch_radius_temp = branch_radius_node;</div>
<div class="line"><span class="lineno"> 2972</span>                }</div>
<div class="line"><span class="lineno"> 2973</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2974</span>                <span class="keyword">auto</span> avoid_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;get_avoidance(branch_radius_node, layer_nr_next);</div>
<div class="line"><span class="lineno"> 2975</span> </div>
<div class="line"><span class="lineno"> 2976</span>                <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>  to_outside         = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a823e21c7e9a69135fb0f18394fb6617c">projection_onto</a>(avoid_layer, node.position);</div>
<div class="line"><span class="lineno"> 2977</span>                <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>  direction_to_outer = to_outside - node.position;</div>
<div class="line"><span class="lineno"> 2978</span>                <span class="keywordtype">double</span> dist2_to_outer     = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a513afc9a9ff0d9199826dffec9c83a3a">vsize2_with_unscale</a>(direction_to_outer);</div>
<div class="line"><span class="lineno"> 2979</span>                <span class="comment">// don&#39;t move if</span></div>
<div class="line"><span class="lineno"> 2980</span>                <span class="comment">// 1) line of node and to_outside is cut by contour (means supports may intersect with object)</span></div>
<div class="line"><span class="lineno"> 2981</span>                <span class="comment">// 2) it&#39;s impossible to move to build plate</span></div>
<div class="line"><span class="lineno"> 2982</span>                <span class="keywordflow">if</span> (is_line_cut_by_contour(node.position, to_outside) || dist2_to_outer &gt; max_move_distance2 * <a class="code hl_define" href="../../db/d7c/_orient_8cpp.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(layer_nr) ||</div>
<div class="line"><span class="lineno"> 2983</span>                    !<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(avoid_layer, node.position)) {</div>
<div class="line"><span class="lineno"> 2984</span>                    <span class="comment">// try move to outside of lower layer instead</span></div>
<div class="line"><span class="lineno"> 2985</span>                    <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> candidate_vertex = node.position;</div>
<div class="line"><span class="lineno"> 2986</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> max_move_between_samples = max_move_distance + radius_sample_resolution + <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>; <span class="comment">// 100 micron extra for rounding errors.</span></div>
<div class="line"><span class="lineno"> 2987</span>                    <span class="keywordtype">bool</span>           is_outside               = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#abc56d807a8ea5fb67d17f565ddb82d7f">move_out_expolys</a>(avoid_layer, candidate_vertex, max_move_between_samples, max_move_between_samples);</div>
<div class="line"><span class="lineno"> 2988</span>                    <span class="keywordflow">if</span> (is_outside) {</div>
<div class="line"><span class="lineno"> 2989</span>                        direction_to_outer = candidate_vertex - node.position;</div>
<div class="line"><span class="lineno"> 2990</span>                        dist2_to_outer    = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a513afc9a9ff0d9199826dffec9c83a3a">vsize2_with_unscale</a>(direction_to_outer);</div>
<div class="line"><span class="lineno"> 2991</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2992</span>                        direction_to_outer = <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(0, 0);</div>
<div class="line"><span class="lineno"> 2993</span>                        dist2_to_outer     = 0;</div>
<div class="line"><span class="lineno"> 2994</span>                    }</div>
<div class="line"><span class="lineno"> 2995</span>                }</div>
<div class="line"><span class="lineno"> 2996</span>                <span class="comment">// move to the averaged direction of neighbor center and contour edge if they are roughly same direction</span></div>
<div class="line"><span class="lineno"> 2997</span>                <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> movement;</div>
<div class="line"><span class="lineno"> 2998</span>                <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0fe17d4240db49835485cfc72af0fd1b">is_strong</a>)</div>
<div class="line"><span class="lineno"> 2999</span>                    movement = move_to_neighbor_center*2 + (dist2_to_outer &gt; <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a> ? direction_to_outer * (1 / dist2_to_outer) : <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(0, 0));</div>
<div class="line"><span class="lineno"> 3000</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3001</span>                    <span class="keywordflow">if</span> (movement.dot(move_to_neighbor_center) &gt;= 0.2 || move_to_neighbor_center == <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(0, 0))</div>
<div class="line"><span class="lineno"> 3002</span>                        movement = direction_to_outer + move_to_neighbor_center;</div>
<div class="line"><span class="lineno"> 3003</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3004</span>                        movement = move_to_neighbor_center; <span class="comment">// otherwise move to neighbor center first</span></div>
<div class="line"><span class="lineno"> 3005</span>                }</div>
<div class="line"><span class="lineno"> 3006</span> </div>
<div class="line"><span class="lineno"> 3007</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a513afc9a9ff0d9199826dffec9c83a3a">vsize2_with_unscale</a>(movement) &gt; get_max_move_dist(&amp;node,2))</div>
<div class="line"><span class="lineno"> 3008</span>                    movement = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#aa3fa458858b2d5a3b0bfb1108f9f781f">normal</a>(movement, <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(get_max_move_dist(&amp;node)));</div>
<div class="line"><span class="lineno"> 3009</span> </div>
<div class="line"><span class="lineno"> 3010</span>                <span class="comment">// add momentum to force smooth movement</span></div>
<div class="line"><span class="lineno"> 3011</span>                <span class="comment">//movement = movement * 0.5 + p_node-&gt;movement * 0.5;</span></div>
<div class="line"><span class="lineno"> 3012</span> </div>
<div class="line"><span class="lineno"> 3013</span>                next_layer_vertex += movement;</div>
<div class="line"><span class="lineno"> 3014</span> </div>
<div class="line"><span class="lineno"> 3015</span>                <span class="keywordflow">if</span> (group_index == 0) {</div>
<div class="line"><span class="lineno"> 3016</span>                    <span class="comment">// Avoid collisions.</span></div>
<div class="line"><span class="lineno"> 3017</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> max_move_between_samples = get_max_move_dist(&amp;node, 1) + radius_sample_resolution + <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>; <span class="comment">// 100 micron extra for rounding errors.</span></div>
<div class="line"><span class="lineno"> 3018</span>                    <span class="keywordtype">bool</span>           is_outside               = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#abc56d807a8ea5fb67d17f565ddb82d7f">move_out_expolys</a>(avoid_layer, next_layer_vertex, radius_sample_resolution + <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>, max_move_between_samples);</div>
<div class="line"><span class="lineno"> 3019</span>                    <span class="keywordflow">if</span> (!is_outside) {</div>
<div class="line"><span class="lineno"> 3020</span>                        <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> candidate_vertex = node.position;</div>
<div class="line"><span class="lineno"> 3021</span>                        is_outside             = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#abc56d807a8ea5fb67d17f565ddb82d7f">move_out_expolys</a>(avoid_layer, candidate_vertex, radius_sample_resolution + <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>, max_move_between_samples);</div>
<div class="line"><span class="lineno"> 3022</span>                        <span class="keywordflow">if</span> (is_outside) { next_layer_vertex = candidate_vertex; }</div>
<div class="line"><span class="lineno"> 3023</span>                    }</div>
<div class="line"><span class="lineno"> 3024</span>                }</div>
<div class="line"><span class="lineno"> 3025</span> </div>
<div class="line"><span class="lineno"> 3026</span>                <span class="keyword">const</span> <span class="keywordtype">bool</span> to_buildplate = !<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;m_layer_outlines[layer_nr], next_layer_vertex);<span class="comment">// !is_inside_ex(m_ts_data-&gt;get_avoidance(m_ts_data-&gt;m_xy_distance, layer_nr - 1), next_layer_vertex);</span></div>
<div class="line"><span class="lineno"> 3027</span>                Node *     next_node     = <span class="keyword">new</span> Node(next_layer_vertex, node.distance_to_top + 1, layer_nr_next, node.support_roof_layers_below - 1, to_buildplate, p_node,</div>
<div class="line"><span class="lineno"> 3028</span>                    print_z_next, height_next);</div>
<div class="line"><span class="lineno"> 3029</span>                next_node-&gt;movement  = movement;</div>
<div class="line"><span class="lineno"> 3030</span>                get_max_move_dist(next_node);</div>
<div class="line"><span class="lineno"> 3031</span>                next_node-&gt;is_merged     = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3032</span>                contact_nodes[layer_nr_next].push_back(next_node);</div>
<div class="line"><span class="lineno"> 3033</span>            }</div>
<div class="line"><span class="lineno"> 3034</span>        }</div>
<div class="line"><span class="lineno"> 3035</span> </div>
<div class="line"><span class="lineno"> 3036</span><span class="preprocessor">#ifdef SUPPORT_TREE_DEBUG_TO_SVG</span></div>
<div class="line"><span class="lineno"> 3037</span>        <span class="keywordflow">if</span> (contact_nodes[layer_nr].<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a83fc268888773d5c0f886fc2e54b8c64">empty</a>() == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 3038</span>            draw_contours_and_nodes_to_svg((boost::format(<span class="stringliteral">&quot;%.2f&quot;</span>) % contact_nodes[layer_nr][0]-&gt;print_z).str(), <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;get_avoidance(0, layer_nr),</div>
<div class="line"><span class="lineno"> 3039</span>                                           <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;get_avoidance(branch_radius_temp, layer_nr),</div>
<div class="line"><span class="lineno"> 3040</span>                                           <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;m_layer_outlines_below[layer_nr],</div>
<div class="line"><span class="lineno"> 3041</span>            contact_nodes[layer_nr], contact_nodes[layer_nr_next], <span class="stringliteral">&quot;contact_points&quot;</span>, { <span class="stringliteral">&quot;overhang&quot;</span>,<span class="stringliteral">&quot;avoid&quot;</span>,<span class="stringliteral">&quot;outline&quot;</span> }, { <span class="stringliteral">&quot;blue&quot;</span>,<span class="stringliteral">&quot;red&quot;</span>,<span class="stringliteral">&quot;yellow&quot;</span> });</div>
<div class="line"><span class="lineno"> 3042</span> </div>
<div class="line"><span class="lineno"> 3043</span>            BOOST_LOG_TRIVIAL(debug) &lt;&lt; <span class="stringliteral">&quot;drop_nodes layer &quot;</span> &lt;&lt; layer_nr &lt;&lt; <span class="stringliteral">&quot;, print_z=&quot;</span> &lt;&lt; ts_layer-&gt;print_z;</div>
<div class="line"><span class="lineno"> 3044</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; std::min(<span class="keywordtype">size_t</span>(5), contact_nodes[layer_nr].<a class="code hl_variable" href="../../de/d38/lzoconf_8h.html#a809275ccd755fb7b88661d952134b14d">size</a>()); i++) {</div>
<div class="line"><span class="lineno"> 3045</span>                <span class="keyword">auto</span> &amp;node = contact_nodes[layer_nr][i];</div>
<div class="line"><span class="lineno"> 3046</span>                BOOST_LOG_TRIVIAL(debug) &lt;&lt; <span class="stringliteral">&quot;\t node &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, pos=&quot;</span> &lt;&lt; node-&gt;position &lt;&lt; <span class="stringliteral">&quot;, move = &quot;</span> &lt;&lt; node-&gt;movement &lt;&lt; <span class="stringliteral">&quot;, is_merged=&quot;</span> &lt;&lt; node-&gt;is_merged;</div>
<div class="line"><span class="lineno"> 3047</span>            }</div>
<div class="line"><span class="lineno"> 3048</span>        }</div>
<div class="line"><span class="lineno"> 3049</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3050</span> </div>
<div class="line"><span class="lineno"> 3051</span>        <span class="comment">// Prune all branches that couldn&#39;t find support on either the model or the buildplate (resulting in &#39;mid-air&#39; branches).</span></div>
<div class="line"><span class="lineno"> 3052</span>        <span class="keywordflow">for</span> (;! unsupported_branch_leaves.empty(); unsupported_branch_leaves.pop_back())</div>
<div class="line"><span class="lineno"> 3053</span>        {</div>
<div class="line"><span class="lineno"> 3054</span>            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; entry = unsupported_branch_leaves.back();</div>
<div class="line"><span class="lineno"> 3055</span>            Node* i_node = entry.second;</div>
<div class="line"><span class="lineno"> 3056</span>            <span class="keywordflow">for</span> (; i_node != <span class="keyword">nullptr</span>; i_node = i_node-&gt;parent)</div>
<div class="line"><span class="lineno"> 3057</span>            {</div>
<div class="line"><span class="lineno"> 3058</span>                <span class="keywordtype">size_t</span> i_layer = i_node-&gt;obj_layer_nr;</div>
<div class="line"><span class="lineno"> 3059</span>                std::vector&lt;Node*&gt;::iterator to_erase = std::find(contact_nodes[i_layer].<a class="code hl_function" href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#a2aeb0374bbb83d0a6452bca14e1bbbda">begin</a>(), contact_nodes[i_layer].<a class="code hl_variable" href="../../d2/d86/xmltok__impl_8inc.html#ade76451eec04fdb3da08ae68f8afee41">end</a>(), i_node);</div>
<div class="line"><span class="lineno"> 3060</span>                <span class="keywordflow">if</span> (to_erase != contact_nodes[i_layer].<a class="code hl_variable" href="../../d2/d86/xmltok__impl_8inc.html#ade76451eec04fdb3da08ae68f8afee41">end</a>())</div>
<div class="line"><span class="lineno"> 3061</span>                {</div>
<div class="line"><span class="lineno"> 3062</span>                    <span class="comment">// update the parent-child chain</span></div>
<div class="line"><span class="lineno"> 3063</span>                    <span class="keywordflow">if</span>(i_node-&gt;parent)</div>
<div class="line"><span class="lineno"> 3064</span>                        i_node-&gt;parent-&gt;child = i_node-&gt;child;</div>
<div class="line"><span class="lineno"> 3065</span>                    <span class="keywordflow">if</span>(i_node-&gt;child)</div>
<div class="line"><span class="lineno"> 3066</span>                        i_node-&gt;child-&gt;parent = i_node-&gt;parent;</div>
<div class="line"><span class="lineno"> 3067</span>                    contact_nodes[i_layer].erase(to_erase);</div>
<div class="line"><span class="lineno"> 3068</span>                    to_free_node_set.insert(i_node);</div>
<div class="line"><span class="lineno"> 3069</span> </div>
<div class="line"><span class="lineno"> 3070</span>                    <span class="keywordflow">for</span> (Node* neighbour : i_node-&gt;merged_neighbours)</div>
<div class="line"><span class="lineno"> 3071</span>                    {</div>
<div class="line"><span class="lineno"> 3072</span>                        unsupported_branch_leaves.push_front({ i_layer, neighbour });</div>
<div class="line"><span class="lineno"> 3073</span>                    }</div>
<div class="line"><span class="lineno"> 3074</span>                }</div>
<div class="line"><span class="lineno"> 3075</span>            }</div>
<div class="line"><span class="lineno"> 3076</span>        }</div>
<div class="line"><span class="lineno"> 3077</span>    }</div>
<div class="line"><span class="lineno"> 3078</span><span class="preprocessor">    #if 1</span></div>
<div class="line"><span class="lineno"> 3079</span>    <span class="comment">// delete nodes with no children (means either it&#39;s a single layer nodes, or the branch has been deleted but not completely)</span></div>
<div class="line"><span class="lineno"> 3080</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> layer_nr = contact_nodes.size() - 1; layer_nr &gt; 0; layer_nr--){</div>
<div class="line"><span class="lineno"> 3081</span>        <span class="keyword">auto</span> layer_contact_nodes = contact_nodes[layer_nr];</div>
<div class="line"><span class="lineno"> 3082</span>        <span class="keywordflow">for</span> (Node *p_node : layer_contact_nodes) {</div>
<div class="line"><span class="lineno"> 3083</span>            <span class="keywordflow">if</span> (p_node-&gt;child==<span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno"> 3084</span>                std::vector&lt;Node *&gt;::iterator to_erase = std::find(contact_nodes[layer_nr].<a class="code hl_function" href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#a2aeb0374bbb83d0a6452bca14e1bbbda">begin</a>(), contact_nodes[layer_nr].<a class="code hl_variable" href="../../d2/d86/xmltok__impl_8inc.html#ade76451eec04fdb3da08ae68f8afee41">end</a>(), p_node);</div>
<div class="line"><span class="lineno"> 3085</span>                <span class="keywordflow">if</span> (to_erase != contact_nodes[layer_nr].<a class="code hl_variable" href="../../d2/d86/xmltok__impl_8inc.html#ade76451eec04fdb3da08ae68f8afee41">end</a>()) {</div>
<div class="line"><span class="lineno"> 3086</span>                    to_free_node_set.insert(*to_erase);</div>
<div class="line"><span class="lineno"> 3087</span>                    contact_nodes[layer_nr].erase(to_erase);</div>
<div class="line"><span class="lineno"> 3088</span>                }</div>
<div class="line"><span class="lineno"> 3089</span>            }</div>
<div class="line"><span class="lineno"> 3090</span>        }</div>
<div class="line"><span class="lineno"> 3091</span>    }</div>
<div class="line"><span class="lineno"> 3092</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 3093</span>    BOOST_LOG_TRIVIAL(debug) &lt;&lt; <span class="stringliteral">&quot;after m_avoidance_cache.size()=&quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;m_avoidance_cache.size();</div>
<div class="line"><span class="lineno"> 3094</span> </div>
<div class="line"><span class="lineno"> 3095</span>    <span class="keywordflow">for</span> (Node *node : to_free_node_set)</div>
<div class="line"><span class="lineno"> 3096</span>    {</div>
<div class="line"><span class="lineno"> 3097</span>        <span class="keyword">delete</span> node;</div>
<div class="line"><span class="lineno"> 3098</span>    }</div>
<div class="line"><span class="lineno"> 3099</span>    to_free_node_set.clear();</div>
<div class="line"><span class="lineno"> 3100</span>}</div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a39b142c27d4da545d49307bf5569d3ab"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a39b142c27d4da545d49307bf5569d3ab">Slic3r::TreeSupport::m_highest_overhang_layer</a></div><div class="ttdeci">size_t m_highest_overhang_layer</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:418</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a5b7aa7b2d91917c6952d77796d4584c2"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a5b7aa7b2d91917c6952d77796d4584c2">Slic3r::TreeSupport::calc_branch_radius</a></div><div class="ttdeci">coordf_t calc_branch_radius(coordf_t base_radius, size_t layers_to_top, size_t tip_layers, double diameter_angle_scale_factor)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:1941</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a819f86c9e3f1aef6f1c99d66a4c19725"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a819f86c9e3f1aef6f1c99d66a4c19725">Slic3r::TreeSupport::plan_layer_heights</a></div><div class="ttdeci">std::vector&lt; LayerHeightData &gt; plan_layer_heights(std::vector&lt; std::vector&lt; Node * &gt; &gt; &amp;contact_nodes)</div><div class="ttdoc">Optimize the generation of tree support by pre-planning the layer_heights.</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:3282</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a8e234c218b1adc33974bc22796876ed2"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8e234c218b1adc33974bc22796876ed2">Slic3r::TreeSupport::m_spanning_trees</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; MinimumSpanningTree &gt; &gt; m_spanning_trees</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:419</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_profiler_html_ac4c1ac0e831a8c190d77ca6be05ee881"><div class="ttname"><a href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#ac4c1ac0e831a8c190d77ca6be05ee881">Slic3r::TreeSupportProfiler::tic</a></div><div class="ttdeci">void tic()</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:119</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_profiler_html_ad3b9254cd8fead7271fb147a63623eef"><div class="ttname"><a href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#ad3b9254cd8fead7271fb147a63623eef">Slic3r::TreeSupportProfiler::stage_add</a></div><div class="ttdeci">void stage_add(TreeSupportStage stage, bool do_toc=false)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:121</div></div>
<div class="ttc" id="alibslic3r_8h_html_a8a7f69c27280e7542b2d1fd979af4545"><div class="ttname"><a href="../../dd/d47/libslic3r_8h.html#a8a7f69c27280e7542b2d1fd979af4545">coord_t</a></div><div class="ttdeci">int32_t coord_t</div><div class="ttdef"><b>Definition</b> libslic3r.h:40</div></div>
<div class="ttc" id="amath_8h_html_a5083c48fbfb60dd70808789479f4db53"><div class="ttname"><a href="../../df/db1/math_8h.html#a5083c48fbfb60dd70808789479f4db53">max</a></div><div class="ttdeci">const T &amp; max(const T &amp;a, const T &amp;b)</div><div class="ttdef"><b>Definition</b> math.h:391</div></div>
<div class="ttc" id="anamespace_slic3r_html_a0913e2e6b7d28032c33cfee03f145fba"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a0913e2e6b7d28032c33cfee03f145fba">Slic3r::Lines</a></div><div class="ttdeci">std::vector&lt; Line &gt; Lines</div><div class="ttdef"><b>Definition</b> Line.hpp:17</div></div>
<div class="ttc" id="anamespace_slic3r_html_a0d1dc28c0b564a1adbfbefbc89ae9664"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a0d1dc28c0b564a1adbfbefbc89ae9664">Slic3r::intersection_ln</a></div><div class="ttdeci">Slic3r::Lines intersection_ln(const Slic3r::Lines &amp;subject, const Slic3r::Polygons &amp;clip)</div><div class="ttdef"><b>Definition</b> ClipperUtils.hpp:504</div></div>
<div class="ttc" id="anamespace_slic3r_html_a79210e483e07aa861d3500cef5f27e26"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">Slic3r::is_inside_ex</a></div><div class="ttdeci">static bool is_inside_ex(const ExPolygon &amp;polygon, const Point &amp;pt)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:611</div></div>
<div class="ttc" id="anamespace_slic3r_html_a823e21c7e9a69135fb0f18394fb6617c"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a823e21c7e9a69135fb0f18394fb6617c">Slic3r::projection_onto</a></div><div class="ttdeci">Point projection_onto(const ExPolygons &amp;polygons, const Point &amp;from)</div><div class="ttdef"><b>Definition</b> ExPolygon.cpp:188</div></div>
<div class="ttc" id="anamespace_slic3r_html_a91566ffe92f166afecd32120a251ff8d"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">Slic3r::profiler</a></div><div class="ttdeci">TreeSupportProfiler profiler</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:150</div></div>
<div class="ttc" id="anamespace_slic3r_html_abc56d807a8ea5fb67d17f565ddb82d7f"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#abc56d807a8ea5fb67d17f565ddb82d7f">Slic3r::move_out_expolys</a></div><div class="ttdeci">static bool move_out_expolys(const ExPolygons &amp;polygons, Point &amp;from, double distance, double max_move_distance)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:629</div></div>
<div class="ttc" id="anamespace_slic3r_html_abd4a1f06bd96d1a25c71bbeb32439db3a3772b58ee643ecf081c69d7850adc791"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a3772b58ee643ecf081c69d7850adc791">Slic3r::STAGE_intersection_ln</a></div><div class="ttdeci">@ STAGE_intersection_ln</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:82</div></div>
<div class="ttc" id="anamespace_slic3r_html_abd4a1f06bd96d1a25c71bbeb32439db3a844f6accf8c46297280874903347798c"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a844f6accf8c46297280874903347798c">Slic3r::STAGE_MinimumSpanningTree</a></div><div class="ttdeci">@ STAGE_MinimumSpanningTree</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:78</div></div>
<div class="ttc" id="anamespacefast__float_1_1detail_html_af1bac4dff87eae126e46ad8f47e0ca44"><div class="ttname"><a href="../../d0/dd2/namespacefast__float_1_1detail.html#af1bac4dff87eae126e46ad8f47e0ca44">fast_float::detail::power</a></div><div class="ttdeci">fastfloat_really_inline int power(int q) noexcept</div><div class="ttdef"><b>Definition</b> fast_float.h:1518</div></div>
<div class="ttc" id="anamespacelibnest2d_1_1shapelike_html_a2aeb0374bbb83d0a6452bca14e1bbbda"><div class="ttname"><a href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#a2aeb0374bbb83d0a6452bca14e1bbbda">libnest2d::shapelike::begin</a></div><div class="ttdeci">S::iterator begin(S &amp;sh, const PathTag &amp;)</div><div class="ttdef"><b>Definition</b> geometry_traits.hpp:627</div></div>
<div class="ttc" id="anamespacemarchsq_1_1____impl_html_a5c3960032271d7907677d3507c909780a0cc175b9c0f1b6a831c399e269772661"><div class="ttname"><a href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a5c3960032271d7907677d3507c909780a0cc175b9c0f1b6a831c399e269772661">marchsq::__impl::SquareTag::a</a></div><div class="ttdeci">@ a</div></div>
<div class="ttc" id="anamespacemarchsq_1_1____impl_html_a5c3960032271d7907677d3507c909780a92eb5ffee6ae2fec3ad71c777531578f"><div class="ttname"><a href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a5c3960032271d7907677d3507c909780a92eb5ffee6ae2fec3ad71c777531578f">marchsq::__impl::SquareTag::b</a></div><div class="ttdeci">@ b</div></div>
<div class="ttc" id="axmltok__impl_8inc_html_ade76451eec04fdb3da08ae68f8afee41"><div class="ttname"><a href="../../d2/d86/xmltok__impl_8inc.html#ade76451eec04fdb3da08ae68f8afee41">end</a></div><div class="ttdeci">static int PTRCALL PREFIX(scanPercent)(const ENCODING *enc const char const char * end</div><div class="ttdef"><b>Definition</b> xmltok_impl.inc:881</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00015">_L</a>, <a class="el" href="../../#l00101">Slic3r::MinimumSpanningTree::adjacent_nodes()</a>, <a class="el" href="../../#l00101">Slic3r::angle()</a>, <a class="el" href="../../#l00344">Slic3r::TreeSupport::Node::child</a>, <a class="el" href="../../#l00292">Slic3r::TreeSupport::Node::dist_mm_to_top</a>, <a class="el" href="../../#l00291">Slic3r::TreeSupport::Node::distance_to_top</a>, <a class="el" href="../../#l00241">Slic3r::empty()</a>, <a class="el" href="../../#l00881">end</a>, <a class="el" href="../../#l00052">EPSILON</a>, <a class="el" href="../../#l00504">Slic3r::intersection_ln()</a>, <a class="el" href="../../#l00611">Slic3r::is_inside_ex()</a>, <a class="el" href="../../#l00302">Slic3r::TreeSupport::Node::is_merged</a>, <a class="el" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">Slic3r::layer_height()</a>, <a class="el" href="../../#l00020">M_PI</a>, <a class="el" href="../../#l00300">Slic3r::TreeSupport::Node::max_move_dist</a>, <a class="el" href="../../#l00353">Slic3r::TreeSupport::Node::merged_neighbours</a>, <a class="el" href="../../#l00629">Slic3r::move_out_expolys()</a>, <a class="el" href="../../#l00298">Slic3r::TreeSupport::Node::movement</a>, <a class="el" href="../../#l00325">Slic3r::TreeSupport::Node::obj_layer_nr</a>, <a class="el" href="../../#l00305">Slic3r::TreeSupport::Node::overhang</a>, <a class="el" href="../../#l00343">Slic3r::TreeSupport::Node::parent</a>, <a class="el" href="../../#l00297">Slic3r::TreeSupport::Node::position</a>, <a class="el" href="../../#l00131">Slic3r::Layer::print_z</a>, <a class="el" href="../../#l00355">Slic3r::TreeSupport::Node::print_z</a>, <a class="el" href="../../#l01047">Slic3r::PrintObjectConfig</a>, <a class="el" href="../../#l00150">Slic3r::profiler</a>, <a class="el" href="../../#l00188">Slic3r::projection_onto()</a>, <a class="el" href="../../#l00081">scale_</a>, <a class="el" href="../../#l00378">size</a>, <a class="el" href="../../#l00021">SQ</a>, <a class="el" href="../../#l00121">Slic3r::TreeSupportProfiler::stage_add()</a>, <a class="el" href="../../#l00082">Slic3r::STAGE_intersection_ln</a>, <a class="el" href="../../#l00078">Slic3r::STAGE_MinimumSpanningTree</a>, <a class="el" href="../../#l00324">Slic3r::TreeSupport::Node::support_floor_layers_above</a>, <a class="el" href="../../#l00323">Slic3r::TreeSupport::Node::support_roof_layers_below</a>, <a class="el" href="../../#l00234">tan()</a>, <a class="el" href="../../#l00119">Slic3r::TreeSupportProfiler::tic()</a>, <a class="el" href="../../#l00334">Slic3r::TreeSupport::Node::to_buildplate</a>, <a class="el" href="../../#l00301">Slic3r::TreeSupport::Node::type</a>, and <a class="el" href="../../#l00017">Slic3r::vsize2_with_unscale()</a>.</p>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_ad5e4f597762d95dd808dbd053aeac6ba_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="acd2ed9a998b6d77058c209ca8884b1bf" name="acd2ed9a998b6d77058c209ca8884b1bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd2ed9a998b6d77058c209ca8884b1bf">&#9670;&#160;</a></span>generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> Slic3r::TreeSupport::generate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create the areas that need support. </p>
<p>These areas are stored inside the given SliceDataStorage object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">storage</td><td>The data storage where the mesh data is gotten from and where the resulting support areas are stored. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno"> 1877</span>{</div>
<div class="line"><span class="lineno"> 1878</span>    <span class="keywordtype">bool</span> tree_support_enable = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;enable_support.value &amp;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a61b97e6f6260d750b0110a6b0d0ebc88">is_tree</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;support_type.value);</div>
<div class="line"><span class="lineno"> 1879</span>    <span class="keywordflow">if</span> (!tree_support_enable)</div>
<div class="line"><span class="lineno"> 1880</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1881</span> </div>
<div class="line"><span class="lineno"> 1882</span>    std::vector&lt;std::vector&lt;Node*&gt;&gt; contact_nodes(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a4d0b4aca78fffa73137e8791e6b9065b">layers</a>().<a class="code hl_function" href="../../d4/dab/class_slic3r_1_1_const_vector_of_ptrs_adaptor.html#ab7a98b52825dd69a8e82b43ba1197270">size</a>());</div>
<div class="line"><span class="lineno"> 1883</span> </div>
<div class="line"><span class="lineno"> 1884</span>    <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#aac7a357adec6c78003f48bc435e89da4">stage_start</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3aae92fabc18e86fa4db152a4614ba9178">STAGE_total</a>);</div>
<div class="line"><span class="lineno"> 1885</span> </div>
<div class="line"><span class="lineno"> 1886</span>    <span class="comment">// Generate overhang areas</span></div>
<div class="line"><span class="lineno"> 1887</span>    <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#aac7a357adec6c78003f48bc435e89da4">stage_start</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a14a38c573873e355a6ad519e0b3ae4eb">STAGE_DETECT_OVERHANGS</a>);</div>
<div class="line"><span class="lineno"> 1888</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../dc/d88/class_slic3r_1_1_print_base.html#a5715024e4ace4cdc0d1feb0be6e48ae2">set_status</a>(55, <a class="code hl_define" href="../../da/d6e/_o_b_j_8cpp.html#a7a5970404f762cc8fada02d3018fb45a">_L</a>(<span class="stringliteral">&quot;Support: detect overhangs&quot;</span>));</div>
<div class="line"><span class="lineno"> 1889</span>    <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#abee402a4a54cce95519d410554b75444">detect_overhangs</a>();</div>
<div class="line"><span class="lineno"> 1890</span>    <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#a89c0d9ffd31f1b90e566f4cdc8bfcdfa">stage_finish</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a14a38c573873e355a6ad519e0b3ae4eb">STAGE_DETECT_OVERHANGS</a>);</div>
<div class="line"><span class="lineno"> 1891</span> </div>
<div class="line"><span class="lineno"> 1892</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ab6ceca30741c916ae61fd99b6e2f000b">has_overhangs</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1893</span> </div>
<div class="line"><span class="lineno"> 1894</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a> = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aef528790762b0a7936e165abbeb3d620">alloc_tree_support_preview_cache</a>();</div>
<div class="line"><span class="lineno"> 1895</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;is_slim = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8697e59f9029b0ce83867137111180e1">is_slim</a>;</div>
<div class="line"><span class="lineno"> 1896</span> </div>
<div class="line"><span class="lineno"> 1897</span>    <span class="comment">// Generate contact points of tree support</span></div>
<div class="line"><span class="lineno"> 1898</span>    <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#aac7a357adec6c78003f48bc435e89da4">stage_start</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3aff35c7b8897be9238cc3895239f4112f">STAGE_GENERATE_CONTACT_NODES</a>);</div>
<div class="line"><span class="lineno"> 1899</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../dc/d88/class_slic3r_1_1_print_base.html#a5715024e4ace4cdc0d1feb0be6e48ae2">set_status</a>(56, <a class="code hl_define" href="../../da/d6e/_o_b_j_8cpp.html#a7a5970404f762cc8fada02d3018fb45a">_L</a>(<span class="stringliteral">&quot;Support: generate contact points&quot;</span>));</div>
<div class="line"><span class="lineno"> 1900</span>    <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#af4886a3ee32c274a587fd91a9c644802">generate_contact_points</a>(contact_nodes);</div>
<div class="line"><span class="lineno"> 1901</span>    <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#a89c0d9ffd31f1b90e566f4cdc8bfcdfa">stage_finish</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3aff35c7b8897be9238cc3895239f4112f">STAGE_GENERATE_CONTACT_NODES</a>);</div>
<div class="line"><span class="lineno"> 1902</span> </div>
<div class="line"><span class="lineno"> 1903</span>    <span class="comment">//Drop nodes to lower layers.</span></div>
<div class="line"><span class="lineno"> 1904</span>    <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#aac7a357adec6c78003f48bc435e89da4">stage_start</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a7f81747ca179ca904511d0a4e429748b">STAGE_DROP_DOWN_NODES</a>);</div>
<div class="line"><span class="lineno"> 1905</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../dc/d88/class_slic3r_1_1_print_base.html#a5715024e4ace4cdc0d1feb0be6e48ae2">set_status</a>(60, <a class="code hl_define" href="../../da/d6e/_o_b_j_8cpp.html#a7a5970404f762cc8fada02d3018fb45a">_L</a>(<span class="stringliteral">&quot;Support: propagate branches&quot;</span>));</div>
<div class="line"><span class="lineno"> 1906</span>    <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad5e4f597762d95dd808dbd053aeac6ba">drop_nodes</a>(contact_nodes);</div>
<div class="line"><span class="lineno"> 1907</span>    <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#a89c0d9ffd31f1b90e566f4cdc8bfcdfa">stage_finish</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a7f81747ca179ca904511d0a4e429748b">STAGE_DROP_DOWN_NODES</a>);</div>
<div class="line"><span class="lineno"> 1908</span> </div>
<div class="line"><span class="lineno"> 1909</span>    <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a2a48a228bbe9db750b4acb65e1ea7ae5">smooth_nodes</a>(contact_nodes);</div>
<div class="line"><span class="lineno"> 1910</span> </div>
<div class="line"><span class="lineno"> 1911</span><span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#abde3ac4f19e1f9d342423a7643e17266">config</a>().tree_support_adaptive_layer_height)</div>
<div class="line"><span class="lineno"> 1912</span>        <span class="comment">// Adjust support layer heights</span></div>
<div class="line"><span class="lineno"> 1913</span>        <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a140270a302619e88c9cb94cd3efb9c29">adjust_layer_heights</a>(contact_nodes);</div>
<div class="line"><span class="lineno"> 1914</span> </div>
<div class="line"><span class="lineno"> 1915</span> </div>
<div class="line"><span class="lineno"> 1916</span>    <span class="comment">//Generate support areas.</span></div>
<div class="line"><span class="lineno"> 1917</span>    <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#aac7a357adec6c78003f48bc435e89da4">stage_start</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a992a76601a112b02ef6bb8c40cf586dc">STAGE_DRAW_CIRCLES</a>);</div>
<div class="line"><span class="lineno"> 1918</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../dc/d88/class_slic3r_1_1_print_base.html#a5715024e4ace4cdc0d1feb0be6e48ae2">set_status</a>(65, <a class="code hl_define" href="../../da/d6e/_o_b_j_8cpp.html#a7a5970404f762cc8fada02d3018fb45a">_L</a>(<span class="stringliteral">&quot;Support: draw polygons&quot;</span>));</div>
<div class="line"><span class="lineno"> 1919</span>    <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a5bf8f77ce79d4b92e7a2b28d96e2ffea">draw_circles</a>(contact_nodes);</div>
<div class="line"><span class="lineno"> 1920</span>    <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#a89c0d9ffd31f1b90e566f4cdc8bfcdfa">stage_finish</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a992a76601a112b02ef6bb8c40cf586dc">STAGE_DRAW_CIRCLES</a>);</div>
<div class="line"><span class="lineno"> 1921</span> </div>
<div class="line"><span class="lineno"> 1922</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; layer : contact_nodes)</div>
<div class="line"><span class="lineno"> 1923</span>    {</div>
<div class="line"><span class="lineno"> 1924</span>        <span class="keywordflow">for</span> (Node* p_node : layer)</div>
<div class="line"><span class="lineno"> 1925</span>        {</div>
<div class="line"><span class="lineno"> 1926</span>            <span class="keyword">delete</span> p_node;</div>
<div class="line"><span class="lineno"> 1927</span>        }</div>
<div class="line"><span class="lineno"> 1928</span>        layer.clear();</div>
<div class="line"><span class="lineno"> 1929</span>    }</div>
<div class="line"><span class="lineno"> 1930</span>    contact_nodes.clear();</div>
<div class="line"><span class="lineno"> 1931</span> </div>
<div class="line"><span class="lineno"> 1932</span>    <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#aac7a357adec6c78003f48bc435e89da4">stage_start</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a891c4536e80afae8d10236d94f76dcbf">STAGE_GENERATE_TOOLPATHS</a>);</div>
<div class="line"><span class="lineno"> 1933</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../dc/d88/class_slic3r_1_1_print_base.html#a5715024e4ace4cdc0d1feb0be6e48ae2">set_status</a>(69, <a class="code hl_define" href="../../da/d6e/_o_b_j_8cpp.html#a7a5970404f762cc8fada02d3018fb45a">_L</a>(<span class="stringliteral">&quot;Support: generate toolpath&quot;</span>));</div>
<div class="line"><span class="lineno"> 1934</span>    <a class="code hl_function" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa1b40260186de1e3d617847acf7386b5">generate_toolpaths</a>();</div>
<div class="line"><span class="lineno"> 1935</span>    <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#a89c0d9ffd31f1b90e566f4cdc8bfcdfa">stage_finish</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a891c4536e80afae8d10236d94f76dcbf">STAGE_GENERATE_TOOLPATHS</a>);</div>
<div class="line"><span class="lineno"> 1936</span> </div>
<div class="line"><span class="lineno"> 1937</span>    <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#a89c0d9ffd31f1b90e566f4cdc8bfcdfa">stage_finish</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3aae92fabc18e86fa4db152a4614ba9178">STAGE_total</a>);</div>
<div class="line"><span class="lineno"> 1938</span>    BOOST_LOG_TRIVIAL(info) &lt;&lt; <span class="stringliteral">&quot;tree support time &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a91566ffe92f166afecd32120a251ff8d">profiler</a>.<a class="code hl_function" href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#a4fd646aab6a78ad43bcf1446d778221d">report</a>();</div>
<div class="line"><span class="lineno"> 1939</span>}</div>
<div class="ttc" id="aclass_slic3r_1_1_const_vector_of_ptrs_adaptor_html_ab7a98b52825dd69a8e82b43ba1197270"><div class="ttname"><a href="../../d4/dab/class_slic3r_1_1_const_vector_of_ptrs_adaptor.html#ab7a98b52825dd69a8e82b43ba1197270">Slic3r::ConstVectorOfPtrsAdaptor::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition</b> Print.hpp:159</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_a4d0b4aca78fffa73137e8791e6b9065b"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#a4d0b4aca78fffa73137e8791e6b9065b">Slic3r::PrintObject::layers</a></div><div class="ttdeci">ConstLayerPtrsAdaptor layers() const</div><div class="ttdef"><b>Definition</b> Print.hpp:301</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_object_html_aef528790762b0a7936e165abbeb3d620"><div class="ttname"><a href="../../de/d87/class_slic3r_1_1_print_object.html#aef528790762b0a7936e165abbeb3d620">Slic3r::PrintObject::alloc_tree_support_preview_cache</a></div><div class="ttdeci">std::shared_ptr&lt; TreeSupportData &gt; alloc_tree_support_preview_cache()</div><div class="ttdef"><b>Definition</b> PrintObject.cpp:649</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a140270a302619e88c9cb94cd3efb9c29"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a140270a302619e88c9cb94cd3efb9c29">Slic3r::TreeSupport::adjust_layer_heights</a></div><div class="ttdeci">void adjust_layer_heights(std::vector&lt; std::vector&lt; Node * &gt; &gt; &amp;contact_nodes)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:3190</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a2a48a228bbe9db750b4acb65e1ea7ae5"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a2a48a228bbe9db750b4acb65e1ea7ae5">Slic3r::TreeSupport::smooth_nodes</a></div><div class="ttdeci">void smooth_nodes(std::vector&lt; std::vector&lt; Node * &gt; &gt; &amp;contact_nodes)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:3102</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_a5bf8f77ce79d4b92e7a2b28d96e2ffea"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#a5bf8f77ce79d4b92e7a2b28d96e2ffea">Slic3r::TreeSupport::draw_circles</a></div><div class="ttdeci">void draw_circles(const std::vector&lt; std::vector&lt; Node * &gt; &gt; &amp;contact_nodes)</div><div class="ttdoc">Draws circles around each node of the tree into the final support.</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:2078</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_aa1b40260186de1e3d617847acf7386b5"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa1b40260186de1e3d617847acf7386b5">Slic3r::TreeSupport::generate_toolpaths</a></div><div class="ttdeci">void generate_toolpaths()</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:1399</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_abee402a4a54cce95519d410554b75444"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#abee402a4a54cce95519d410554b75444">Slic3r::TreeSupport::detect_overhangs</a></div><div class="ttdeci">void detect_overhangs(bool detect_first_sharp_tail_only=false)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:715</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_ad5e4f597762d95dd808dbd053aeac6ba"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad5e4f597762d95dd808dbd053aeac6ba">Slic3r::TreeSupport::drop_nodes</a></div><div class="ttdeci">void drop_nodes(std::vector&lt; std::vector&lt; Node * &gt; &gt; &amp;contact_nodes)</div><div class="ttdoc">Drops down the nodes of the tree support towards the build plate.</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:2564</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_html_af4886a3ee32c274a587fd91a9c644802"><div class="ttname"><a href="../../d1/d72/class_slic3r_1_1_tree_support.html#af4886a3ee32c274a587fd91a9c644802">Slic3r::TreeSupport::generate_contact_points</a></div><div class="ttdeci">void generate_contact_points(std::vector&lt; std::vector&lt; Node * &gt; &gt; &amp;contact_nodes)</div><div class="ttdoc">Creates points where support contacts the model.</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:3381</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_profiler_html_a4fd646aab6a78ad43bcf1446d778221d"><div class="ttname"><a href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#a4fd646aab6a78ad43bcf1446d778221d">Slic3r::TreeSupportProfiler::report</a></div><div class="ttdeci">std::string report()</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:130</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_profiler_html_a89c0d9ffd31f1b90e566f4cdc8bfcdfa"><div class="ttname"><a href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#a89c0d9ffd31f1b90e566f4cdc8bfcdfa">Slic3r::TreeSupportProfiler::stage_finish</a></div><div class="ttdeci">void stage_finish(TreeSupportStage stage)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:110</div></div>
<div class="ttc" id="aclass_slic3r_1_1_tree_support_profiler_html_aac7a357adec6c78003f48bc435e89da4"><div class="ttname"><a href="../../d1/d03/class_slic3r_1_1_tree_support_profiler.html#aac7a357adec6c78003f48bc435e89da4">Slic3r::TreeSupportProfiler::stage_start</a></div><div class="ttdeci">void stage_start(TreeSupportStage stage)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:102</div></div>
<div class="ttc" id="anamespace_slic3r_html_abd4a1f06bd96d1a25c71bbeb32439db3a14a38c573873e355a6ad519e0b3ae4eb"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a14a38c573873e355a6ad519e0b3ae4eb">Slic3r::STAGE_DETECT_OVERHANGS</a></div><div class="ttdeci">@ STAGE_DETECT_OVERHANGS</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:73</div></div>
<div class="ttc" id="anamespace_slic3r_html_abd4a1f06bd96d1a25c71bbeb32439db3a7f81747ca179ca904511d0a4e429748b"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a7f81747ca179ca904511d0a4e429748b">Slic3r::STAGE_DROP_DOWN_NODES</a></div><div class="ttdeci">@ STAGE_DROP_DOWN_NODES</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:75</div></div>
<div class="ttc" id="anamespace_slic3r_html_abd4a1f06bd96d1a25c71bbeb32439db3a891c4536e80afae8d10236d94f76dcbf"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a891c4536e80afae8d10236d94f76dcbf">Slic3r::STAGE_GENERATE_TOOLPATHS</a></div><div class="ttdeci">@ STAGE_GENERATE_TOOLPATHS</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:77</div></div>
<div class="ttc" id="anamespace_slic3r_html_abd4a1f06bd96d1a25c71bbeb32439db3a992a76601a112b02ef6bb8c40cf586dc"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3a992a76601a112b02ef6bb8c40cf586dc">Slic3r::STAGE_DRAW_CIRCLES</a></div><div class="ttdeci">@ STAGE_DRAW_CIRCLES</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:76</div></div>
<div class="ttc" id="anamespace_slic3r_html_abd4a1f06bd96d1a25c71bbeb32439db3aae92fabc18e86fa4db152a4614ba9178"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3aae92fabc18e86fa4db152a4614ba9178">Slic3r::STAGE_total</a></div><div class="ttdeci">@ STAGE_total</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:83</div></div>
<div class="ttc" id="anamespace_slic3r_html_abd4a1f06bd96d1a25c71bbeb32439db3aff35c7b8897be9238cc3895239f4112f"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#abd4a1f06bd96d1a25c71bbeb32439db3aff35c7b8897be9238cc3895239f4112f">Slic3r::STAGE_GENERATE_CONTACT_NODES</a></div><div class="ttdeci">@ STAGE_GENERATE_CONTACT_NODES</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:74</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00015">_L</a>, <a class="el" href="../../#l00115">Slic3r::is_tree()</a>, <a class="el" href="../../#l00150">Slic3r::profiler</a>, <a class="el" href="../../#l00130">Slic3r::TreeSupportProfiler::report()</a>, <a class="el" href="../../#l00073">Slic3r::STAGE_DETECT_OVERHANGS</a>, <a class="el" href="../../#l00076">Slic3r::STAGE_DRAW_CIRCLES</a>, <a class="el" href="../../#l00075">Slic3r::STAGE_DROP_DOWN_NODES</a>, <a class="el" href="../../#l00110">Slic3r::TreeSupportProfiler::stage_finish()</a>, <a class="el" href="../../#l00074">Slic3r::STAGE_GENERATE_CONTACT_NODES</a>, <a class="el" href="../../#l00077">Slic3r::STAGE_GENERATE_TOOLPATHS</a>, <a class="el" href="../../#l00102">Slic3r::TreeSupportProfiler::stage_start()</a>, and <a class="el" href="../../#l00083">Slic3r::STAGE_total</a>.</p>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_acd2ed9a998b6d77058c209ca8884b1bf_cgraph.svg" width="367" height="232"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af4886a3ee32c274a587fd91a9c644802" name="af4886a3ee32c274a587fd91a9c644802"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4886a3ee32c274a587fd91a9c644802">&#9670;&#160;</a></span>generate_contact_points()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> Slic3r::TreeSupport::generate_contact_points </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>contact_nodes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates points where support contacts the model. </p>
<p>A set of points is created for each layer. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>The mesh to get the overhang areas to support of. </td></tr>
    <tr><td class="paramname">contact_nodes[out]</td><td>A vector of mappings from contact points to their tree nodes. </td></tr>
    <tr><td class="paramname">collision_areas</td><td>For every layer, the areas where a generated contact point would immediately collide with the model due to the X/Y distance. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>For each layer, a list of points where the tree should connect with the model. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 3382</span>{</div>
<div class="line"><span class="lineno"> 3383</span>    <span class="keyword">const</span> <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#ad48b86fa8e529e56c6bd00ff2f9839ab">PrintObjectConfig</a> &amp;config = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#abde3ac4f19e1f9d342423a7643e17266">config</a>();</div>
<div class="line"><span class="lineno"> 3384</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> point_spread = <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(config.tree_support_branch_distance.value);</div>
<div class="line"><span class="lineno"> 3385</span> </div>
<div class="line"><span class="lineno"> 3386</span>    <span class="comment">//First generate grid points to cover the entire area of the print.</span></div>
<div class="line"><span class="lineno"> 3387</span>    BoundingBox <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a4d0c9e0f802addbe38308663e5e4c8be">bounding_box</a> = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a571b601aadc8d8a24208e933bbd8704c">bounding_box</a>();</div>
<div class="line"><span class="lineno"> 3388</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> bounding_box_size = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a4d0c9e0f802addbe38308663e5e4c8be">bounding_box</a>.<a class="code hl_variable" href="../../dc/d28/class_slic3r_1_1_bounding_box_base.html#accba77660949c364f5acc5d60cfb053a">max</a> - <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a4d0c9e0f802addbe38308663e5e4c8be">bounding_box</a>.<a class="code hl_variable" href="../../dc/d28/class_slic3r_1_1_bounding_box_base.html#aaff4424e7b7071ebc78112f55dd3d6ce">min</a>;</div>
<div class="line"><span class="lineno"> 3389</span>    <span class="keyword">constexpr</span> <span class="keywordtype">double</span> rotate_angle = 22.0 / 180.0 * <a class="code hl_define" href="../../de/ddd/_extrusion_simulator_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;</div>
<div class="line"><span class="lineno"> 3390</span> </div>
<div class="line"><span class="lineno"> 3391</span>    <span class="keyword">const</span> <span class="keyword">auto</span> center = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3ba552ea517dcd78c5f7a18d043e31ce">bounding_box_middle</a>(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a4d0c9e0f802addbe38308663e5e4c8be">bounding_box</a>);</div>
<div class="line"><span class="lineno"> 3392</span>    <span class="keyword">const</span> <span class="keyword">auto</span> sin_angle = std::sin(rotate_angle);</div>
<div class="line"><span class="lineno"> 3393</span>    <span class="keyword">const</span> <span class="keyword">auto</span> cos_angle = std::cos(rotate_angle);</div>
<div class="line"><span class="lineno"> 3394</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> rotated_dims = <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(</div>
<div class="line"><span class="lineno"> 3395</span>        bounding_box_size(0) * cos_angle + bounding_box_size(1) * sin_angle,</div>
<div class="line"><span class="lineno"> 3396</span>        bounding_box_size(0) * sin_angle + bounding_box_size(1) * cos_angle) / 2;</div>
<div class="line"><span class="lineno"> 3397</span> </div>
<div class="line"><span class="lineno"> 3398</span>    std::vector&lt;Point&gt; grid_points;</div>
<div class="line"><span class="lineno"> 3399</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> x = -rotated_dims(0); <a class="code hl_function" href="../../df/d4e/namespacelibnest2d_1_1pointlike.html#a1e3045df0bee66333beaa96a9a1b6c9d">x</a> &lt; rotated_dims(0); <a class="code hl_function" href="../../df/d4e/namespacelibnest2d_1_1pointlike.html#a1e3045df0bee66333beaa96a9a1b6c9d">x</a> += point_spread) {</div>
<div class="line"><span class="lineno"> 3400</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> y = -rotated_dims(1); <a class="code hl_variable" href="../../d7/dc9/namespace_eigen_1_1internal.html#a3cc80fc03610837da180f7e6d8e7b3ec">y</a> &lt; rotated_dims(1); <a class="code hl_variable" href="../../d7/dc9/namespace_eigen_1_1internal.html#a3cc80fc03610837da180f7e6d8e7b3ec">y</a> += point_spread) {</div>
<div class="line"><span class="lineno"> 3401</span>            <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> pt(x, y);</div>
<div class="line"><span class="lineno"> 3402</span>            pt.rotate(cos_angle, sin_angle);</div>
<div class="line"><span class="lineno"> 3403</span>            pt += center;</div>
<div class="line"><span class="lineno"> 3404</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a4d0c9e0f802addbe38308663e5e4c8be">bounding_box</a>.<a class="code hl_function" href="../../da/d00/class_slic3r_1_1_bounding_box3_base.html#a098373ced0c6799776329f329c839ab2">contains</a>(pt)) {</div>
<div class="line"><span class="lineno"> 3405</span>                grid_points.push_back(pt);</div>
<div class="line"><span class="lineno"> 3406</span>            }</div>
<div class="line"><span class="lineno"> 3407</span>        }</div>
<div class="line"><span class="lineno"> 3408</span>    }</div>
<div class="line"><span class="lineno"> 3409</span> </div>
<div class="line"><span class="lineno"> 3410</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a> = config.layer_height.value;</div>
<div class="line"><span class="lineno"> 3411</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> z_distance_top = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#ae75919394f64528204ca434684c06d1b">gap_support_object</a>;</div>
<div class="line"><span class="lineno"> 3412</span>    <span class="comment">// BBS: add extra distance if thick bridge is enabled</span></div>
<div class="line"><span class="lineno"> 3413</span>    <span class="comment">// Note: normal support uses print_z, but tree support uses integer layers, so we need to subtract layer_height</span></div>
<div class="line"><span class="lineno"> 3414</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#ac8f1765efb10ac97c597982a0b4847f5">soluble_interface</a> &amp;&amp; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;thick_bridges) {</div>
<div class="line"><span class="lineno"> 3415</span>        z_distance_top += <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a4d0b4aca78fffa73137e8791e6b9065b">layers</a>()[0]-&gt;regions()[0]-&gt;region().bridging_height_avg(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../d5/d8f/class_slic3r_1_1_print.html#af1937a680d19c7dd8d3c24e5ff7332b8">config</a>()) - <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a>;</div>
<div class="line"><span class="lineno"> 3416</span>    }</div>
<div class="line"><span class="lineno"> 3417</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> z_distance_top_layers = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a799d085686d773026ef9031e8dfc0907">round_up_divide</a>(<a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(z_distance_top), <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a>)) + 1; <span class="comment">//Support must always be 1 layer below overhang.</span></div>
<div class="line"><span class="lineno"> 3418</span> </div>
<div class="line"><span class="lineno"> 3419</span>    <span class="keywordtype">size_t</span> support_roof_layers = config.support_interface_top_layers.value;</div>
<div class="line"><span class="lineno"> 3420</span>    <span class="keywordflow">if</span> (support_roof_layers &gt; 0)</div>
<div class="line"><span class="lineno"> 3421</span>        support_roof_layers += 1; <span class="comment">// BBS: add a normal support layer below interface (if we have interface)</span></div>
<div class="line"><span class="lineno"> 3422</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a>  thresh_angle = std::min(89.f, config.support_threshold_angle.value &lt; <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a> ? 30.f : config.support_threshold_angle.<a class="code hl_enumvalue" href="../../dc/df0/namespacenlohmann_1_1detail.html#a59e696b1dad6d0d99c172ac4518c2042a2063c1608d6e0baf80249c42e2be5804">value</a>);</div>
<div class="line"><span class="lineno"> 3423</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a>  half_overhang_distance = <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(<a class="code hl_function" href="../../d4/df0/_array_cwise_unary_ops_8h.html#a0c32a3874bfc5438d11b75c9f40256d1">tan</a>(thresh_angle * <a class="code hl_define" href="../../de/ddd/_extrusion_simulator_8cpp.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> / 180.0) * <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a> / 2);</div>
<div class="line"><span class="lineno"> 3424</span> </div>
<div class="line"><span class="lineno"> 3425</span>    <span class="comment">// fix bug of generating support for very thin objects</span></div>
<div class="line"><span class="lineno"> 3426</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a4d0b4aca78fffa73137e8791e6b9065b">layers</a>().<a class="code hl_function" href="../../d4/dab/class_slic3r_1_1_const_vector_of_ptrs_adaptor.html#ab7a98b52825dd69a8e82b43ba1197270">size</a>() &lt;= z_distance_top_layers + 1)</div>
<div class="line"><span class="lineno"> 3427</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3428</span> </div>
<div class="line"><span class="lineno"> 3429</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a39b142c27d4da545d49307bf5569d3ab">m_highest_overhang_layer</a> = 0;</div>
<div class="line"><span class="lineno"> 3430</span>    <span class="keywordtype">int</span>      nonempty_layers = 0;</div>
<div class="line"><span class="lineno"> 3431</span>    std::vector&lt;Slic3r::Vec3f&gt; all_nodes;</div>
<div class="line"><span class="lineno"> 3432</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> layer_nr = 1; layer_nr &lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a4d0b4aca78fffa73137e8791e6b9065b">layers</a>().<a class="code hl_variable" href="../../de/d38/lzoconf_8h.html#a809275ccd755fb7b88661d952134b14d">size</a>(); layer_nr++)</div>
<div class="line"><span class="lineno"> 3433</span>    {</div>
<div class="line"><span class="lineno"> 3434</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../dc/d88/class_slic3r_1_1_print_base.html#ab5f6b4781d433373200f5f328ebcb4a8">canceled</a>())</div>
<div class="line"><span class="lineno"> 3435</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3436</span>        <span class="keyword">auto</span>              ts_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>);</div>
<div class="line"><span class="lineno"> 3437</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a> &amp;overhang = ts_layer-&gt;overhang_areas;</div>
<div class="line"><span class="lineno"> 3438</span>        <span class="keyword">auto</span> &amp;          curr_nodes = contact_nodes[layer_nr];</div>
<div class="line"><span class="lineno"> 3439</span>        <span class="keywordflow">if</span> (overhang.empty())</div>
<div class="line"><span class="lineno"> 3440</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3441</span> </div>
<div class="line"><span class="lineno"> 3442</span>        <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a39b142c27d4da545d49307bf5569d3ab">m_highest_overhang_layer</a> = std::max(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a39b142c27d4da545d49307bf5569d3ab">m_highest_overhang_layer</a>, layer_nr);</div>
<div class="line"><span class="lineno"> 3443</span>        <span class="keyword">auto</span> print_z             = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a8918ae15322de198ce6d0632feaac9b4">print_z</a>;</div>
<div class="line"><span class="lineno"> 3444</span>        <span class="keyword">auto</span> <a class="code hl_function" href="../../d0/d25/namespace_slic3r_1_1arrangement.html#a5b816dd05a95b740ac2194b643ceaacc">height</a>              = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a37f53b1ef3b7fc3131f18845cd9c264a">height</a>;</div>
<div class="line"><span class="lineno"> 3445</span> </div>
<div class="line"><span class="lineno"> 3446</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> ExPolygon &amp;overhang_part : overhang)</div>
<div class="line"><span class="lineno"> 3447</span>        {</div>
<div class="line"><span class="lineno"> 3448</span>            BoundingBox overhang_bounds = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a6e3ba75aef7600dbb0a294a47d88ecb8">get_extents</a>(overhang_part);</div>
<div class="line"><span class="lineno"> 3449</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aafc183d8390ddc4b2b7af16954628504">support_style</a>==<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#ac4444e117129d57974e96c39d6976a3ba2d0abf8e046fa487260fa805a652b9d5">smsTreeHybrid</a> &amp;&amp; overhang_part.area() &gt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#af4d2760e2fc64fbd954c6fefa926200e">thresh_big_overhang</a>) {</div>
<div class="line"><span class="lineno"> 3450</span>                <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> candidate = overhang_bounds.center();</div>
<div class="line"><span class="lineno"> 3451</span>                <span class="keywordflow">if</span> (!overhang_part.contains(candidate))</div>
<div class="line"><span class="lineno"> 3452</span>                    <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#af308734b6d51a7b70c7d280d1008dcee">move_inside_expoly</a>(overhang_part, candidate);</div>
<div class="line"><span class="lineno"> 3453</span>                <span class="keywordflow">if</span> (!(config.support_on_build_plate_only &amp;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;m_layer_outlines_below[layer_nr], candidate))) {</div>
<div class="line"><span class="lineno"> 3454</span>                    Node* contact_node = <span class="keyword">new</span> Node(candidate, -z_distance_top_layers, layer_nr, support_roof_layers + z_distance_top_layers, <span class="keyword">true</span>, <a class="code hl_variable" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html#ac348a7869ad7a821f3f6bf19536e1d83">Node::NO_PARENT</a>, print_z,</div>
<div class="line"><span class="lineno"> 3455</span>                        height, z_distance_top);</div>
<div class="line"><span class="lineno"> 3456</span>                    contact_node-&gt;type = <a class="code hl_enumvalue" href="../../d1/d72/class_slic3r_1_1_tree_support.html#ad8a715908231a21dfd417bb8a368fd78a80f9da0a91828bd383c02077dfa419f2">ePolygon</a>;</div>
<div class="line"><span class="lineno"> 3457</span>                    contact_node-&gt;overhang = &amp;overhang_part;</div>
<div class="line"><span class="lineno"> 3458</span>                    curr_nodes.emplace_back(contact_node);</div>
<div class="line"><span class="lineno"> 3459</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3460</span>                }</div>
<div class="line"><span class="lineno"> 3461</span>            }</div>
<div class="line"><span class="lineno"> 3462</span> </div>
<div class="line"><span class="lineno"> 3463</span>            overhang_bounds.inflated(half_overhang_distance);</div>
<div class="line"><span class="lineno"> 3464</span>            <span class="keywordtype">bool</span> added = <span class="keyword">false</span>; <span class="comment">//Did we add a point this way?</span></div>
<div class="line"><span class="lineno"> 3465</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> candidate : grid_points)</div>
<div class="line"><span class="lineno"> 3466</span>            {</div>
<div class="line"><span class="lineno"> 3467</span>                <span class="keywordflow">if</span> (overhang_bounds.contains(candidate))</div>
<div class="line"><span class="lineno"> 3468</span>                {</div>
<div class="line"><span class="lineno"> 3469</span>                    <span class="comment">// BBS: move_inside_expoly shouldn&#39;t be used if candidate is already inside, as it moves point to boundary and the inside is not well supported!</span></div>
<div class="line"><span class="lineno"> 3470</span>                    <span class="keywordtype">bool</span>               is_inside       = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(overhang_part, candidate);</div>
<div class="line"><span class="lineno"> 3471</span>                    <span class="keywordflow">if</span> (!is_inside) {</div>
<div class="line"><span class="lineno"> 3472</span>                        <span class="keyword">constexpr</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> distance_inside = 0; <span class="comment">// Move point towards the border of the polygon if it is closer than half the overhang distance: Catch points that</span></div>
<div class="line"><span class="lineno"> 3473</span>                                                                <span class="comment">// fall between overhang areas on constant surfaces.</span></div>
<div class="line"><span class="lineno"> 3474</span>                        <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#af308734b6d51a7b70c7d280d1008dcee">move_inside_expoly</a>(overhang_part, candidate, distance_inside, half_overhang_distance);</div>
<div class="line"><span class="lineno"> 3475</span>                        is_inside = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a79210e483e07aa861d3500cef5f27e26">is_inside_ex</a>(overhang_part, candidate);</div>
<div class="line"><span class="lineno"> 3476</span>                    }</div>
<div class="line"><span class="lineno"> 3477</span>                    <span class="keywordflow">if</span> (is_inside)</div>
<div class="line"><span class="lineno"> 3478</span>                    {</div>
<div class="line"><span class="lineno"> 3479</span>                        <span class="comment">// collision radius has to be 0 or the supports are too few at curved slopes</span></div>
<div class="line"><span class="lineno"> 3480</span>                        <span class="comment">//if (!is_inside_ex(m_ts_data-&gt;get_collision(0, layer_nr), candidate))</span></div>
<div class="line"><span class="lineno"> 3481</span>                        {</div>
<div class="line"><span class="lineno"> 3482</span>                            <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> to_buildplate = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3483</span>                            Node *         contact_node  = <span class="keyword">new</span> Node(candidate, -z_distance_top_layers, layer_nr, support_roof_layers + z_distance_top_layers, to_buildplate,</div>
<div class="line"><span class="lineno"> 3484</span>                                                          <a class="code hl_variable" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html#ac348a7869ad7a821f3f6bf19536e1d83">Node::NO_PARENT</a>, print_z, height, z_distance_top);</div>
<div class="line"><span class="lineno"> 3485</span>                            contact_node-&gt;overhang = &amp;overhang_part;</div>
<div class="line"><span class="lineno"> 3486</span>                            curr_nodes.emplace_back(contact_node);</div>
<div class="line"><span class="lineno"> 3487</span>                            added = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3488</span>                        }</div>
<div class="line"><span class="lineno"> 3489</span>                    }</div>
<div class="line"><span class="lineno"> 3490</span>                }</div>
<div class="line"><span class="lineno"> 3491</span>            }</div>
<div class="line"><span class="lineno"> 3492</span> </div>
<div class="line"><span class="lineno"> 3493</span>            <span class="keywordflow">if</span> (!added) <span class="comment">//If we didn&#39;t add any points due to bad luck, we want to add one anyway such that loose parts are also supported.</span></div>
<div class="line"><span class="lineno"> 3494</span>            {</div>
<div class="line"><span class="lineno"> 3495</span>                <span class="keyword">auto</span> bbox = overhang_part.contour.bounding_box();</div>
<div class="line"><span class="lineno"> 3496</span>                <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a23808f414c5200a82ec3227245111a7f">Points</a> candidates;</div>
<div class="line"><span class="lineno"> 3497</span>                <span class="keywordflow">if</span> (ts_layer-&gt;overhang_types[&amp;overhang_part] == <a class="code hl_enumvalue" href="../../de/dad/class_slic3r_1_1_support_layer.html#aa5243471c16b51ef1ebc7f4b38cabbcca3869353538024929965c3878ebacd6aa">SupportLayer::Detected</a>)</div>
<div class="line"><span class="lineno"> 3498</span>                    candidates = {bbox.min, <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3ba552ea517dcd78c5f7a18d043e31ce">bounding_box_middle</a>(bbox), bbox.max};</div>
<div class="line"><span class="lineno"> 3499</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3500</span>                    candidates = {<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3ba552ea517dcd78c5f7a18d043e31ce">bounding_box_middle</a>(bbox)};</div>
<div class="line"><span class="lineno"> 3501</span> </div>
<div class="line"><span class="lineno"> 3502</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> candidate : candidates) {</div>
<div class="line"><span class="lineno"> 3503</span>                    <span class="keywordflow">if</span> (!overhang_part.contains(candidate))</div>
<div class="line"><span class="lineno"> 3504</span>                        <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#af308734b6d51a7b70c7d280d1008dcee">move_inside_expoly</a>(overhang_part, candidate);</div>
<div class="line"><span class="lineno"> 3505</span>                    <span class="keyword">constexpr</span> <span class="keywordtype">bool</span>   to_buildplate   = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3506</span>                    Node *contact_node = <span class="keyword">new</span> Node(candidate, -z_distance_top_layers, layer_nr, support_roof_layers + z_distance_top_layers, to_buildplate, <a class="code hl_variable" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html#ac348a7869ad7a821f3f6bf19536e1d83">Node::NO_PARENT</a>,</div>
<div class="line"><span class="lineno"> 3507</span>                                                  print_z, height, z_distance_top);</div>
<div class="line"><span class="lineno"> 3508</span>                    contact_node-&gt;overhang           = &amp;overhang_part;</div>
<div class="line"><span class="lineno"> 3509</span>                    curr_nodes.emplace_back(contact_node);</div>
<div class="line"><span class="lineno"> 3510</span>                }</div>
<div class="line"><span class="lineno"> 3511</span>            }</div>
<div class="line"><span class="lineno"> 3512</span>            <span class="comment">// add supports at corners for both auto and manual overhangs, github #2008</span></div>
<div class="line"><span class="lineno"> 3513</span>            <span class="keywordflow">if</span> (<span class="comment">/*ts_layer-&gt;overhang_types[&amp;overhang_part] == SupportLayer::Detected*/</span>1) {</div>
<div class="line"><span class="lineno"> 3514</span>                <span class="comment">// add points at corners</span></div>
<div class="line"><span class="lineno"> 3515</span>                <span class="keyword">auto</span> &amp;points = overhang_part.contour.points;</div>
<div class="line"><span class="lineno"> 3516</span>                <span class="keywordtype">int</span>   nSize  = points.size();</div>
<div class="line"><span class="lineno"> 3517</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nSize; i++) {</div>
<div class="line"><span class="lineno"> 3518</span>                    <span class="keyword">auto</span> pt = points[i];</div>
<div class="line"><span class="lineno"> 3519</span>                    <span class="keyword">auto</span> v1 = (pt - points[(i - 1 + nSize) % nSize]).cast&lt;<span class="keywordtype">double</span>&gt;().normalized();</div>
<div class="line"><span class="lineno"> 3520</span>                    <span class="keyword">auto</span> v2 = (pt - points[(i + 1) % nSize]).cast&lt;<span class="keywordtype">double</span>&gt;().normalized();</div>
<div class="line"><span class="lineno"> 3521</span>                    <span class="keywordflow">if</span> (v1.dot(v2) &gt; -0.7) { <span class="comment">// angle smaller than 135 degrees</span></div>
<div class="line"><span class="lineno"> 3522</span>                        Node *contact_node     = <span class="keyword">new</span> Node(pt, -z_distance_top_layers, layer_nr, support_roof_layers + z_distance_top_layers, <span class="keyword">true</span>, <a class="code hl_variable" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html#ac348a7869ad7a821f3f6bf19536e1d83">Node::NO_PARENT</a>, print_z,</div>
<div class="line"><span class="lineno"> 3523</span>                                                      height, z_distance_top);</div>
<div class="line"><span class="lineno"> 3524</span>                        contact_node-&gt;overhang = &amp;overhang_part;</div>
<div class="line"><span class="lineno"> 3525</span>                        contact_node-&gt;is_corner = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3526</span>                        curr_nodes.emplace_back(contact_node);</div>
<div class="line"><span class="lineno"> 3527</span>                    }</div>
<div class="line"><span class="lineno"> 3528</span>                }</div>
<div class="line"><span class="lineno"> 3529</span>            } </div>
<div class="line"><span class="lineno"> 3530</span>            <span class="keywordflow">if</span>(ts_layer-&gt;overhang_types[&amp;overhang_part] == <a class="code hl_enumvalue" href="../../de/dad/class_slic3r_1_1_support_layer.html#aa5243471c16b51ef1ebc7f4b38cabbccac5444b57223bf206553a8d6cd2b23916">SupportLayer::Enforced</a> || <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a8697e59f9029b0ce83867137111180e1">is_slim</a>){</div>
<div class="line"><span class="lineno"> 3531</span>                <span class="comment">// remove close points in Enforcers</span></div>
<div class="line"><span class="lineno"> 3532</span>                <span class="comment">// auto above_nodes = contact_nodes[layer_nr - 1];</span></div>
<div class="line"><span class="lineno"> 3533</span>                <span class="keywordflow">if</span> (!curr_nodes.empty() <span class="comment">/*&amp;&amp; !above_nodes.empty()*/</span>) {</div>
<div class="line"><span class="lineno"> 3534</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = curr_nodes.begin(); it != curr_nodes.end();) {</div>
<div class="line"><span class="lineno"> 3535</span>                        <span class="keywordtype">bool</span> is_duplicate = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3536</span>                        <span class="keywordflow">if</span> (!(*it)-&gt;is_corner) {</div>
<div class="line"><span class="lineno"> 3537</span>                            <a class="code hl_class" href="../../d2/d2d/class_eigen_1_1_matrix.html">Slic3r::Vec3f</a> curr_pt((*it)-&gt;position(0), (*it)-&gt;position(1), <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>((*it)-&gt;print_z));</div>
<div class="line"><span class="lineno"> 3538</span>                            <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;pt : all_nodes) {</div>
<div class="line"><span class="lineno"> 3539</span>                                <span class="keyword">auto</span> dif = curr_pt - pt;</div>
<div class="line"><span class="lineno"> 3540</span>                                <span class="keywordflow">if</span> (dif.norm() &lt; point_spread / 2) {</div>
<div class="line"><span class="lineno"> 3541</span>                                    <span class="keyword">delete</span> (*it);</div>
<div class="line"><span class="lineno"> 3542</span>                                    it           = curr_nodes.erase(it);</div>
<div class="line"><span class="lineno"> 3543</span>                                    is_duplicate = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3544</span>                                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3545</span>                                }</div>
<div class="line"><span class="lineno"> 3546</span>                            }</div>
<div class="line"><span class="lineno"> 3547</span>                        }</div>
<div class="line"><span class="lineno"> 3548</span>                        <span class="keywordflow">if</span> (!is_duplicate) it++;</div>
<div class="line"><span class="lineno"> 3549</span>                    }</div>
<div class="line"><span class="lineno"> 3550</span>                }</div>
<div class="line"><span class="lineno"> 3551</span>            }</div>
<div class="line"><span class="lineno"> 3552</span>        }</div>
<div class="line"><span class="lineno"> 3553</span>        <span class="keywordflow">if</span> (!curr_nodes.empty()) nonempty_layers++;</div>
<div class="line"><span class="lineno"> 3554</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> node : curr_nodes) { all_nodes.emplace_back(node-&gt;position(0), node-&gt;position(1), <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(node-&gt;print_z)); }</div>
<div class="line"><span class="lineno"> 3555</span><span class="preprocessor">#ifdef SUPPORT_TREE_DEBUG_TO_SVG</span></div>
<div class="line"><span class="lineno"> 3556</span>        draw_contours_and_nodes_to_svg(std::to_string(print_z), overhang, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;m_layer_outlines_below[layer_nr], {},</div>
<div class="line"><span class="lineno"> 3557</span>            contact_nodes[layer_nr], {}, <span class="stringliteral">&quot;init_contact_points&quot;</span>, { <span class="stringliteral">&quot;overhang&quot;</span>,<span class="stringliteral">&quot;outlines&quot;</span>,<span class="stringliteral">&quot;&quot;</span> });</div>
<div class="line"><span class="lineno"> 3558</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3559</span>    }</div>
<div class="line"><span class="lineno"> 3560</span>    <span class="keywordtype">int</span> nNodes = all_nodes.size();</div>
<div class="line"><span class="lineno"> 3561</span>    <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a87bcd1a50c69642adfbd467a7256c23d">avg_node_per_layer</a> = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4453aaa97f66b4d66f47d534979ee149">nodes_angle</a> = 0;</div>
<div class="line"><span class="lineno"> 3562</span>    <span class="keywordflow">if</span> (nNodes &gt; 0) {</div>
<div class="line"><span class="lineno"> 3563</span>        <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a87bcd1a50c69642adfbd467a7256c23d">avg_node_per_layer</a> = nNodes / nonempty_layers;</div>
<div class="line"><span class="lineno"> 3564</span>        <span class="comment">// get orientation of nodes by line fitting</span></div>
<div class="line"><span class="lineno"> 3565</span>        <span class="comment">// line: y=kx+b, where</span></div>
<div class="line"><span class="lineno"> 3566</span>        <span class="comment">//       k=tan(nodes_angle)=(n\sum{xy}-\sum{x}\sum{y})/(n\sum{x^2}-\sum{x}^2)</span></div>
<div class="line"><span class="lineno"> 3567</span>        <span class="keywordtype">float</span> mx = 0, my = 0, mxy = 0, mx2 = 0;</div>
<div class="line"><span class="lineno"> 3568</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;pt : all_nodes) {</div>
<div class="line"><span class="lineno"> 3569</span>            <span class="keywordtype">float</span> <a class="code hl_function" href="../../df/d4e/namespacelibnest2d_1_1pointlike.html#a1e3045df0bee66333beaa96a9a1b6c9d">x</a> = <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a53a12d2cc0717a94fc4007412cc349be">unscale_</a>(pt(0));</div>
<div class="line"><span class="lineno"> 3570</span>            <span class="keywordtype">float</span> <a class="code hl_variable" href="../../d7/dc9/namespace_eigen_1_1internal.html#a3cc80fc03610837da180f7e6d8e7b3ec">y</a> = <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a53a12d2cc0717a94fc4007412cc349be">unscale_</a>(pt(1));</div>
<div class="line"><span class="lineno"> 3571</span>            mx += <a class="code hl_function" href="../../df/d4e/namespacelibnest2d_1_1pointlike.html#a1e3045df0bee66333beaa96a9a1b6c9d">x</a>;</div>
<div class="line"><span class="lineno"> 3572</span>            my += <a class="code hl_variable" href="../../d7/dc9/namespace_eigen_1_1internal.html#a3cc80fc03610837da180f7e6d8e7b3ec">y</a>;</div>
<div class="line"><span class="lineno"> 3573</span>            mxy += <a class="code hl_function" href="../../df/d4e/namespacelibnest2d_1_1pointlike.html#a1e3045df0bee66333beaa96a9a1b6c9d">x</a> * <a class="code hl_variable" href="../../d7/dc9/namespace_eigen_1_1internal.html#a3cc80fc03610837da180f7e6d8e7b3ec">y</a>;</div>
<div class="line"><span class="lineno"> 3574</span>            mx2 += <a class="code hl_function" href="../../df/d4e/namespacelibnest2d_1_1pointlike.html#a1e3045df0bee66333beaa96a9a1b6c9d">x</a> * <a class="code hl_function" href="../../df/d4e/namespacelibnest2d_1_1pointlike.html#a1e3045df0bee66333beaa96a9a1b6c9d">x</a>;</div>
<div class="line"><span class="lineno"> 3575</span>        }</div>
<div class="line"><span class="lineno"> 3576</span>        <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4453aaa97f66b4d66f47d534979ee149">nodes_angle</a> = atan2(nNodes * mxy - mx * my, nNodes * mx2 - <a class="code hl_define" href="../../db/d7c/_orient_8cpp.html#ac3644f84794a8bfdacf39c4b2c2495fc">SQ</a>(mx));</div>
<div class="line"><span class="lineno"> 3577</span>        </div>
<div class="line"><span class="lineno"> 3578</span>        BOOST_LOG_TRIVIAL(info) &lt;&lt; <span class="stringliteral">&quot;avg_node_per_layer=&quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a87bcd1a50c69642adfbd467a7256c23d">avg_node_per_layer</a> &lt;&lt; <span class="stringliteral">&quot;, nodes_angle=&quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4453aaa97f66b4d66f47d534979ee149">nodes_angle</a>;</div>
<div class="line"><span class="lineno"> 3579</span>    }</div>
<div class="line"><span class="lineno"> 3580</span>}</div>
<div class="ttc" id="aclass_eigen_1_1_matrix_html"><div class="ttname"><a href="../../d2/d2d/class_eigen_1_1_matrix.html">Eigen::Matrix&lt; float, 3, 1, Eigen::DontAlign &gt;</a></div></div>
<div class="ttc" id="aclass_slic3r_1_1_bounding_box3_base_html_a098373ced0c6799776329f329c839ab2"><div class="ttname"><a href="../../da/d00/class_slic3r_1_1_bounding_box3_base.html#a098373ced0c6799776329f329c839ab2">Slic3r::BoundingBox3Base::contains</a></div><div class="ttdeci">bool contains(const PointClass &amp;point) const</div><div class="ttdef"><b>Definition</b> BoundingBox.hpp:146</div></div>
<div class="ttc" id="aclass_slic3r_1_1_bounding_box_base_html_aaff4424e7b7071ebc78112f55dd3d6ce"><div class="ttname"><a href="../../dc/d28/class_slic3r_1_1_bounding_box_base.html#aaff4424e7b7071ebc78112f55dd3d6ce">Slic3r::BoundingBoxBase::min</a></div><div class="ttdeci">PointClass min</div><div class="ttdef"><b>Definition</b> BoundingBox.hpp:16</div></div>
<div class="ttc" id="aclass_slic3r_1_1_bounding_box_base_html_accba77660949c364f5acc5d60cfb053a"><div class="ttname"><a href="../../dc/d28/class_slic3r_1_1_bounding_box_base.html#accba77660949c364f5acc5d60cfb053a">Slic3r::BoundingBoxBase::max</a></div><div class="ttdeci">PointClass max</div><div class="ttdef"><b>Definition</b> BoundingBox.hpp:17</div></div>
<div class="ttc" id="alibslic3r_8h_html_a53a12d2cc0717a94fc4007412cc349be"><div class="ttname"><a href="../../dd/d47/libslic3r_8h.html#a53a12d2cc0717a94fc4007412cc349be">unscale_</a></div><div class="ttdeci">#define unscale_(val)</div><div class="ttdef"><b>Definition</b> libslic3r.h:82</div></div>
<div class="ttc" id="anamespace_eigen_1_1internal_html_a3cc80fc03610837da180f7e6d8e7b3ec"><div class="ttname"><a href="../../d7/dc9/namespace_eigen_1_1internal.html#a3cc80fc03610837da180f7e6d8e7b3ec">Eigen::internal::y</a></div><div class="ttdeci">const Scalar &amp; y</div><div class="ttdef"><b>Definition</b> MathFunctions.h:552</div></div>
<div class="ttc" id="anamespace_slic3r_html_a23808f414c5200a82ec3227245111a7f"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a23808f414c5200a82ec3227245111a7f">Slic3r::Points</a></div><div class="ttdeci">std::vector&lt; Point &gt; Points</div><div class="ttdef"><b>Definition</b> Point.hpp:50</div></div>
<div class="ttc" id="anamespace_slic3r_html_a3ba552ea517dcd78c5f7a18d043e31ce"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a3ba552ea517dcd78c5f7a18d043e31ce">Slic3r::bounding_box_middle</a></div><div class="ttdeci">static Point bounding_box_middle(const BoundingBox &amp;bbox)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:659</div></div>
<div class="ttc" id="anamespace_slic3r_html_a4d0c9e0f802addbe38308663e5e4c8be"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a4d0c9e0f802addbe38308663e5e4c8be">Slic3r::bounding_box</a></div><div class="ttdeci">BoundingBoxf3 bounding_box(const TriangleMesh &amp;m)</div><div class="ttdef"><b>Definition</b> TriangleMesh.hpp:359</div></div>
<div class="ttc" id="anamespace_slic3r_html_a799d085686d773026ef9031e8dfc0907"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a799d085686d773026ef9031e8dfc0907">Slic3r::round_up_divide</a></div><div class="ttdeci">unsigned int round_up_divide(unsigned int dividend, unsigned int divisor)</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:41</div></div>
<div class="ttc" id="anamespace_slic3r_html_af308734b6d51a7b70c7d280d1008dcee"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#af308734b6d51a7b70c7d280d1008dcee">Slic3r::move_inside_expoly</a></div><div class="ttdeci">static unsigned int move_inside_expoly(const ExPolygon &amp;polygon, Point &amp;from, double distance=0, double max_move_distance=std::numeric_limits&lt; double &gt;::max())</div><div class="ttdef"><b>Definition</b> TreeSupport.cpp:338</div></div>
<div class="ttc" id="anamespacelibnest2d_1_1pointlike_html_a1e3045df0bee66333beaa96a9a1b6c9d"><div class="ttname"><a href="../../df/d4e/namespacelibnest2d_1_1pointlike.html#a1e3045df0bee66333beaa96a9a1b6c9d">libnest2d::pointlike::x</a></div><div class="ttdeci">TCoord&lt; P &gt; x(const P &amp;p)</div><div class="ttdef"><b>Definition</b> geometry_traits.hpp:310</div></div>
<div class="ttc" id="anamespacenlohmann_1_1detail_html_a59e696b1dad6d0d99c172ac4518c2042a2063c1608d6e0baf80249c42e2be5804"><div class="ttname"><a href="../../dc/df0/namespacenlohmann_1_1detail.html#a59e696b1dad6d0d99c172ac4518c2042a2063c1608d6e0baf80249c42e2be5804">nlohmann::detail::parse_event_t::value</a></div><div class="ttdeci">@ value</div><div class="ttdoc">the parser finished reading a JSON value</div></div>
<div class="ttc" id="astruct_slic3r_1_1_slicing_parameters_html_ae75919394f64528204ca434684c06d1b"><div class="ttname"><a href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#ae75919394f64528204ca434684c06d1b">Slic3r::SlicingParameters::gap_support_object</a></div><div class="ttdeci">coordf_t gap_support_object</div><div class="ttdef"><b>Definition</b> Slicing.hpp:88</div></div>
<div class="ttc" id="astruct_slic3r_1_1_tree_support_1_1_node_html_ac348a7869ad7a821f3f6bf19536e1d83"><div class="ttname"><a href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html#ac348a7869ad7a821f3f6bf19536e1d83">Slic3r::TreeSupport::Node::NO_PARENT</a></div><div class="ttdeci">static constexpr Node * NO_PARENT</div><div class="ttdef"><b>Definition</b> TreeSupport.hpp:240</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00089">Slic3r::MultiPoint::bounding_box()</a>, <a class="el" href="../../#l00659">Slic3r::bounding_box_middle()</a>, <a class="el" href="../../#l00225">Slic3r::BoundingBoxBase&lt; PointClass &gt;::center()</a>, <a class="el" href="../../#l00062">Slic3r::BoundingBoxBase&lt; PointClass &gt;::contains()</a>, <a class="el" href="../../#l00035">Slic3r::ExPolygon::contour</a>, <a class="el" href="../../#l00052">EPSILON</a>, <a class="el" href="../../#l00386">Slic3r::get_extents()</a>, <a class="el" href="../../#l00211">Slic3r::BoundingBox::inflated()</a>, <a class="el" href="../../#l00303">Slic3r::TreeSupport::Node::is_corner</a>, <a class="el" href="../../#l00611">Slic3r::is_inside_ex()</a>, <a class="el" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">Slic3r::layer_height()</a>, <a class="el" href="../../#l00020">M_PI</a>, <a class="el" href="../../#l00016">Slic3r::BoundingBoxBase&lt; PointClass &gt;::min</a>, <a class="el" href="../../#l00338">Slic3r::move_inside_expoly()</a>, <a class="el" href="../../#l00305">Slic3r::TreeSupport::Node::overhang</a>, <a class="el" href="../../#l00018">Slic3r::MultiPoint::points</a>, <a class="el" href="../../#l01047">Slic3r::PrintObjectConfig</a>, <a class="el" href="../../#l00180">Slic3r::Point::rotate()</a>, <a class="el" href="../../#l00041">Slic3r::round_up_divide()</a>, <a class="el" href="../../#l00081">scale_</a>, <a class="el" href="../../#l00378">size</a>, <a class="el" href="../../#l00104">Slic3r::smsTreeHybrid</a>, <a class="el" href="../../#l00021">SQ</a>, <a class="el" href="../../#l00234">tan()</a>, <a class="el" href="../../#l00301">Slic3r::TreeSupport::Node::type</a>, and <a class="el" href="../../#l00035">unscale_</a>.</p>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_af4886a3ee32c274a587fd91a9c644802_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="aa1b40260186de1e3d617847acf7386b5" name="aa1b40260186de1e3d617847acf7386b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1b40260186de1e3d617847acf7386b5">&#9670;&#160;</a></span>generate_toolpaths()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> Slic3r::TreeSupport::generate_toolpaths </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1400</span>{</div>
<div class="line"><span class="lineno"> 1401</span>    <span class="keyword">const</span> PrintConfig &amp;print_config = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../d5/d8f/class_slic3r_1_1_print.html#af1937a680d19c7dd8d3c24e5ff7332b8">config</a>();</div>
<div class="line"><span class="lineno"> 1402</span>    <span class="keyword">const</span> <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#ad48b86fa8e529e56c6bd00ff2f9839ab">PrintObjectConfig</a> &amp;object_config = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#abde3ac4f19e1f9d342423a7643e17266">config</a>();</div>
<div class="line"><span class="lineno"> 1403</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> support_extrusion_width = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa0479aee3f9b52bd26f72c7f94ee4dc0">support_extrusion_width</a>;</div>
<div class="line"><span class="lineno"> 1404</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> nozzle_diameter = print_config.nozzle_diameter.get_at(object_config.support_filament - 1);</div>
<div class="line"><span class="lineno"> 1405</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a> = object_config.layer_height.value;</div>
<div class="line"><span class="lineno"> 1406</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> wall_count = object_config.tree_support_wall_count.value;</div>
<div class="line"><span class="lineno"> 1407</span> </div>
<div class="line"><span class="lineno"> 1408</span>    <span class="comment">// Check if set to zero, use default if so.</span></div>
<div class="line"><span class="lineno"> 1409</span>    <span class="keywordflow">if</span> (support_extrusion_width &lt;= 0.0)</div>
<div class="line"><span class="lineno"> 1410</span>        support_extrusion_width = <a class="code hl_function" href="../../d6/d0f/class_slic3r_1_1_flow.html#a84918dd0798eb452f858b0391847bddd">Flow::auto_extrusion_width</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a4bcb312043a874462f942e362c16567aa16d80b2546547565f4e334f9cf68a415">FlowRole::frSupportMaterial</a>, (<span class="keywordtype">float</span>)nozzle_diameter);</div>
<div class="line"><span class="lineno"> 1411</span> </div>
<div class="line"><span class="lineno"> 1412</span>    <span class="comment">// coconut: use same intensity settings as SupportMaterial.cpp</span></div>
<div class="line"><span class="lineno"> 1413</span>    <span class="keyword">auto</span> m_support_material_interface_flow = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#aa1f36f6004a4359d15dec3d8bbcf3e3e">support_material_interface_flow</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>, <span class="keywordtype">float</span>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a4e9e7e96af55db823c04201bee40292e">layer_height</a>));</div>
<div class="line"><span class="lineno"> 1414</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> interface_spacing = object_config.support_interface_spacing.value + m_support_material_interface_flow.spacing();</div>
<div class="line"><span class="lineno"> 1415</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> bottom_interface_spacing = object_config.support_bottom_interface_spacing.value + m_support_material_interface_flow.spacing();</div>
<div class="line"><span class="lineno"> 1416</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> interface_density = std::min(1., m_support_material_interface_flow.spacing() / interface_spacing);</div>
<div class="line"><span class="lineno"> 1417</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> bottom_interface_density = std::min(1., m_support_material_interface_flow.spacing() / bottom_interface_spacing);</div>
<div class="line"><span class="lineno"> 1418</span> </div>
<div class="line"><span class="lineno"> 1419</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> branch_radius = object_config.tree_support_branch_diameter.value / 2;</div>
<div class="line"><span class="lineno"> 1420</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> branch_radius_scaled = <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(branch_radius);</div>
<div class="line"><span class="lineno"> 1421</span> </div>
<div class="line"><span class="lineno"> 1422</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a5dbc527ceb07d109234242201e8439c1">support_layers</a>().<a class="code hl_function" href="../../d4/dab/class_slic3r_1_1_const_vector_of_ptrs_adaptor.html#add0d03a44936815c301ee82d76b2b792">empty</a>())</div>
<div class="line"><span class="lineno"> 1423</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1424</span> </div>
<div class="line"><span class="lineno"> 1425</span>    <span class="comment">// calculate fill areas for raft layers</span></div>
<div class="line"><span class="lineno"> 1426</span>    <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a517930244d210021577457148f9a49e3">ExPolygons</a> raft_areas;</div>
<div class="line"><span class="lineno"> 1427</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aea3e7f3fc4b46b4290105f655edcde47">layer_count</a>() &gt; 0) {</div>
<div class="line"><span class="lineno"> 1428</span>        <span class="keyword">const</span> Layer *layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a4d0b4aca78fffa73137e8791e6b9065b">layers</a>().<a class="code hl_function" href="../../d4/dab/class_slic3r_1_1_const_vector_of_ptrs_adaptor.html#ad4bc30ba8bb4ce2d4e8e8c6c85ffcd04">front</a>();</div>
<div class="line"><span class="lineno"> 1429</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> ExPolygon &amp;expoly : layer-&gt;lslices) {</div>
<div class="line"><span class="lineno"> 1430</span>            raft_areas.push_back(expoly);</div>
<div class="line"><span class="lineno"> 1431</span>        }</div>
<div class="line"><span class="lineno"> 1432</span>    }</div>
<div class="line"><span class="lineno"> 1433</span> </div>
<div class="line"><span class="lineno"> 1434</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#ad77e3d2fb551f8261f9298335a9a0ec5">support_layer_count</a>() &gt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>) {</div>
<div class="line"><span class="lineno"> 1435</span>        <span class="keyword">const</span> SupportLayer *ts_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>);</div>
<div class="line"><span class="lineno"> 1436</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> ExPolygon expoly : ts_layer-&gt;floor_areas)</div>
<div class="line"><span class="lineno"> 1437</span>            raft_areas.push_back(expoly);</div>
<div class="line"><span class="lineno"> 1438</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> ExPolygon expoly : ts_layer-&gt;roof_areas)</div>
<div class="line"><span class="lineno"> 1439</span>            raft_areas.push_back(expoly);</div>
<div class="line"><span class="lineno"> 1440</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> ExPolygon expoly : ts_layer-&gt;base_areas)</div>
<div class="line"><span class="lineno"> 1441</span>            raft_areas.push_back(expoly);</div>
<div class="line"><span class="lineno"> 1442</span>    }</div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span>    raft_areas = std::move(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5e96c84b799b62906e4a46a94eb8916c">offset_ex</a>(raft_areas, <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(3.)));</div>
<div class="line"><span class="lineno"> 1445</span> </div>
<div class="line"><span class="lineno"> 1446</span>    <span class="comment">// generate raft tool path</span></div>
<div class="line"><span class="lineno"> 1447</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a> &gt; 0)</div>
<div class="line"><span class="lineno"> 1448</span>    {</div>
<div class="line"><span class="lineno"> 1449</span>        <a class="code hl_enumeration" href="../../de/db8/namespace_slic3r.html#a6fa3193f46e8c4fc55359a5c124f46e6">ExtrusionRole</a> raft_contour_er = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a2aa68d58cabcb7cea93686d1cd08c022">base_raft_layers</a> &gt; 0 ? <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a6fa3193f46e8c4fc55359a5c124f46e6a667e5eb77b54b3867d5ddd7474bd2f1a">erSupportMaterial</a> : <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a6fa3193f46e8c4fc55359a5c124f46e6a54a07a476d1b976ab5ee4f95e80df634">erSupportMaterialInterface</a>;</div>
<div class="line"><span class="lineno"> 1450</span>        SupportLayer *ts_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a5dbc527ceb07d109234242201e8439c1">support_layers</a>().<a class="code hl_function" href="../../d4/dab/class_slic3r_1_1_const_vector_of_ptrs_adaptor.html#ad4bc30ba8bb4ce2d4e8e8c6c85ffcd04">front</a>();</div>
<div class="line"><span class="lineno"> 1451</span>        Flow flow = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../d5/d8f/class_slic3r_1_1_print.html#a5b587e73fcc946136a3222e74dec5c83">brim_flow</a>();</div>
<div class="line"><span class="lineno"> 1452</span> </div>
<div class="line"><span class="lineno"> 1453</span>        <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a> loops;</div>
<div class="line"><span class="lineno"> 1454</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> ExPolygon&amp; expoly : raft_areas) {</div>
<div class="line"><span class="lineno"> 1455</span>            loops.push_back(expoly.contour);</div>
<div class="line"><span class="lineno"> 1456</span>            loops.insert(loops.end(), expoly.holes.begin(), expoly.holes.end());</div>
<div class="line"><span class="lineno"> 1457</span>        }</div>
<div class="line"><span class="lineno"> 1458</span>        <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5f8283c1f9814ff89f3a8013404d9649">extrusion_entities_append_loops</a>(ts_layer-&gt;support_fills.entities, std::move(loops), raft_contour_er,</div>
<div class="line"><span class="lineno"> 1459</span>            <span class="keywordtype">float</span>(flow.mm3_per_mm()), <span class="keywordtype">float</span>(flow.width()), <span class="keywordtype">float</span>(flow.height()));</div>
<div class="line"><span class="lineno"> 1460</span>        raft_areas = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5e96c84b799b62906e4a46a94eb8916c">offset_ex</a>(raft_areas, -flow.scaled_spacing() / 2.);</div>
<div class="line"><span class="lineno"> 1461</span>    }</div>
<div class="line"><span class="lineno"> 1462</span> </div>
<div class="line"><span class="lineno"> 1463</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> layer_nr = 0; layer_nr &lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a2aa68d58cabcb7cea93686d1cd08c022">base_raft_layers</a>; layer_nr++) {</div>
<div class="line"><span class="lineno"> 1464</span>        SupportLayer *ts_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr);</div>
<div class="line"><span class="lineno"> 1465</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> expand_offset = (layer_nr == 0 ? 0. : -1.);</div>
<div class="line"><span class="lineno"> 1466</span> </div>
<div class="line"><span class="lineno"> 1467</span>        Flow support_flow = layer_nr == 0 ? <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../d5/d8f/class_slic3r_1_1_print.html#a5b587e73fcc946136a3222e74dec5c83">brim_flow</a>() : Flow(support_extrusion_width, ts_layer-&gt;height, nozzle_diameter);</div>
<div class="line"><span class="lineno"> 1468</span>        Fill* filler_interface = <a class="code hl_function" href="../../d7/dcc/class_slic3r_1_1_fill.html#ae4f0ccb5cf9427ade958c67faa188c64">Fill::new_from_type</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fac9e881fccb86a6b1c7cf776b66c6e0db">ipRectilinear</a>);</div>
<div class="line"><span class="lineno"> 1469</span>        filler_interface-&gt;angle = layer_nr == 0 ? 90 : 0;</div>
<div class="line"><span class="lineno"> 1470</span>        filler_interface-&gt;spacing = support_extrusion_width;</div>
<div class="line"><span class="lineno"> 1471</span> </div>
<div class="line"><span class="lineno"> 1472</span>        FillParams fill_params;</div>
<div class="line"><span class="lineno"> 1473</span>        fill_params.density     = object_config.raft_first_layer_density * 0.01;</div>
<div class="line"><span class="lineno"> 1474</span>        fill_params.dont_adjust = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1475</span> </div>
<div class="line"><span class="lineno"> 1476</span>        <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#abca4f04baa025ac33fb5ba57fb9244eb">fill_expolygons_generate_paths</a>(ts_layer-&gt;support_fills.entities, std::move(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5e96c84b799b62906e4a46a94eb8916c">offset_ex</a>(raft_areas, <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(expand_offset))),</div>
<div class="line"><span class="lineno"> 1477</span>            filler_interface, fill_params, <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a6fa3193f46e8c4fc55359a5c124f46e6a667e5eb77b54b3867d5ddd7474bd2f1a">erSupportMaterial</a>, support_flow);</div>
<div class="line"><span class="lineno"> 1478</span>    }</div>
<div class="line"><span class="lineno"> 1479</span> </div>
<div class="line"><span class="lineno"> 1480</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> layer_nr = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a2aa68d58cabcb7cea93686d1cd08c022">base_raft_layers</a>;</div>
<div class="line"><span class="lineno"> 1481</span>         layer_nr &lt; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a2aa68d58cabcb7cea93686d1cd08c022">base_raft_layers</a> + <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#ae6cca9e93ef7f659e4e8be919ff1342f">interface_raft_layers</a>;</div>
<div class="line"><span class="lineno"> 1482</span>         layer_nr++)</div>
<div class="line"><span class="lineno"> 1483</span>    {</div>
<div class="line"><span class="lineno"> 1484</span>        SupportLayer *ts_layer = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a82f39ab79ee6822bab0b43c89fa7a3ff">get_support_layer</a>(layer_nr);</div>
<div class="line"><span class="lineno"> 1485</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> expand_offset = (layer_nr == 0 ? 0. : -1.);</div>
<div class="line"><span class="lineno"> 1486</span> </div>
<div class="line"><span class="lineno"> 1487</span>        Flow support_flow(support_extrusion_width, ts_layer-&gt;height, nozzle_diameter);</div>
<div class="line"><span class="lineno"> 1488</span>        Fill* filler_interface = <a class="code hl_function" href="../../d7/dcc/class_slic3r_1_1_fill.html#ae4f0ccb5cf9427ade958c67faa188c64">Fill::new_from_type</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fac9e881fccb86a6b1c7cf776b66c6e0db">ipRectilinear</a>);</div>
<div class="line"><span class="lineno"> 1489</span>        filler_interface-&gt;angle = 0;</div>
<div class="line"><span class="lineno"> 1490</span>        filler_interface-&gt;spacing = support_extrusion_width;</div>
<div class="line"><span class="lineno"> 1491</span> </div>
<div class="line"><span class="lineno"> 1492</span>        FillParams fill_params;</div>
<div class="line"><span class="lineno"> 1493</span>        fill_params.density = interface_density;</div>
<div class="line"><span class="lineno"> 1494</span>        fill_params.dont_adjust = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1495</span> </div>
<div class="line"><span class="lineno"> 1496</span>        <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#abca4f04baa025ac33fb5ba57fb9244eb">fill_expolygons_generate_paths</a>(ts_layer-&gt;support_fills.entities, std::move(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5e96c84b799b62906e4a46a94eb8916c">offset_ex</a>(raft_areas, <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(expand_offset))),</div>
<div class="line"><span class="lineno"> 1497</span>            filler_interface, fill_params, <a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a6fa3193f46e8c4fc55359a5c124f46e6a54a07a476d1b976ab5ee4f95e80df634">erSupportMaterialInterface</a>, support_flow);</div>
<div class="line"><span class="lineno"> 1498</span>    }</div>
<div class="line"><span class="lineno"> 1499</span> </div>
<div class="line"><span class="lineno"> 1500</span>    BoundingBox bbox_object(<a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(-<a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(1.), -<a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(1.0)), <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a>(<a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(1.), <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(1.)));</div>
<div class="line"><span class="lineno"> 1501</span> </div>
<div class="line"><span class="lineno"> 1502</span>    std::shared_ptr&lt;Fill&gt; filler_interface = std::shared_ptr&lt;Fill&gt;(<a class="code hl_function" href="../../d7/dcc/class_slic3r_1_1_fill.html#ae4f0ccb5cf9427ade958c67faa188c64">Fill::new_from_type</a>(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a4cebd329d67e84cf50b2942817987696">m_support_params</a>.<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#af304f7a2146b1c0e97bd5f50d53ddf89">contact_fill_pattern</a>));</div>
<div class="line"><span class="lineno"> 1503</span>    std::shared_ptr&lt;Fill&gt; filler_Roof1stLayer = std::shared_ptr&lt;Fill&gt;(<a class="code hl_function" href="../../d7/dcc/class_slic3r_1_1_fill.html#ae4f0ccb5cf9427ade958c67faa188c64">Fill::new_from_type</a>(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#a0799da4d5630e9003a6732d1b159391fac9e881fccb86a6b1c7cf776b66c6e0db">ipRectilinear</a>));</div>
<div class="line"><span class="lineno"> 1504</span>    filler_interface-&gt;set_bounding_box(bbox_object);</div>
<div class="line"><span class="lineno"> 1505</span>    filler_Roof1stLayer-&gt;set_bounding_box(bbox_object);</div>
<div class="line"><span class="lineno"> 1506</span>    filler_interface-&gt;angle = <a class="code hl_function" href="../../d3/dfb/namespace_slic3r_1_1_geometry.html#a345f6f1e6238a364b20bdabac88a8314">Geometry::deg2rad</a>(object_config.support_angle.value + 90.);</div>
<div class="line"><span class="lineno"> 1507</span>    filler_Roof1stLayer-&gt;angle = <a class="code hl_function" href="../../d3/dfb/namespace_slic3r_1_1_geometry.html#a345f6f1e6238a364b20bdabac88a8314">Geometry::deg2rad</a>(object_config.support_angle.value + 90.);</div>
<div class="line"><span class="lineno"> 1508</span> </div>
<div class="line"><span class="lineno"> 1509</span>    <span class="comment">// generate tree support tool paths</span></div>
<div class="line"><span class="lineno"> 1510</span>    tbb::parallel_for(</div>
<div class="line"><span class="lineno"> 1511</span>        tbb::blocked_range&lt;size_t&gt;(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#adb71d9dc16f8b49fdde6037bce2ca4cd">m_raft_layers</a>, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#ad77e3d2fb551f8261f9298335a9a0ec5">support_layer_count</a>()),</div>
<div class="line"><span class="lineno"> 1512</span>        [&amp;](<span class="keyword">const</span> tbb::blocked_range&lt;size_t&gt;&amp; <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a51e1ea9708d6434aae1e8394bef8acdc">range</a>)</div>
<div class="line"><span class="lineno"> 1513</span>        {</div>
<div class="line"><span class="lineno"> 1514</span>            for (size_t layer_id = range.begin(); layer_id &lt; range.end(); layer_id++) {</div>
<div class="line"><span class="lineno"> 1515</span>                if (m_object-&gt;print()-&gt;canceled())</div>
<div class="line"><span class="lineno"> 1516</span>                    break;</div>
<div class="line"><span class="lineno"> 1517</span> </div>
<div class="line"><span class="lineno"> 1518</span>                m_object-&gt;print()-&gt;set_status(70, (boost::format(_L(<span class="stringliteral">&quot;Support: generate toolpath at layer %d&quot;</span>)) % layer_id).str());</div>
<div class="line"><span class="lineno"> 1519</span> </div>
<div class="line"><span class="lineno"> 1520</span>                SupportLayer* ts_layer = m_object-&gt;get_support_layer(layer_id);</div>
<div class="line"><span class="lineno"> 1521</span>                Flow support_flow(support_extrusion_width, ts_layer-&gt;height, nozzle_diameter);</div>
<div class="line"><span class="lineno"> 1522</span>                coordf_t support_spacing         = object_config.support_base_pattern_spacing.value + support_flow.spacing();</div>
<div class="line"><span class="lineno"> 1523</span>                coordf_t support_density         = std::min(1., support_flow.spacing() / support_spacing);</div>
<div class="line"><span class="lineno"> 1524</span>                ts_layer-&gt;support_fills.no_sort = false;</div>
<div class="line"><span class="lineno"> 1525</span> </div>
<div class="line"><span class="lineno"> 1526</span>                for (auto&amp; area_group : ts_layer-&gt;area_groups) {</div>
<div class="line"><span class="lineno"> 1527</span>                    ExPolygon&amp; poly = *area_group.area;</div>
<div class="line"><span class="lineno"> 1528</span>                    ExPolygons polys;</div>
<div class="line"><span class="lineno"> 1529</span>                    FillParams fill_params;</div>
<div class="line"><span class="lineno"> 1530</span>                    if (area_group.type != SupportLayer::BaseType) {</div>
<div class="line"><span class="lineno"> 1531</span>                        <span class="comment">// interface</span></div>
<div class="line"><span class="lineno"> 1532</span>                        if (layer_id == 0) {</div>
<div class="line"><span class="lineno"> 1533</span>                            Flow flow = m_raft_layers == 0 ? m_object-&gt;print()-&gt;brim_flow() : support_flow;</div>
<div class="line"><span class="lineno"> 1534</span>                            make_perimeter_and_inner_brim(ts_layer-&gt;support_fills.entities, poly, wall_count, flow,</div>
<div class="line"><span class="lineno"> 1535</span>                                                          area_group.type == SupportLayer::RoofType ? erSupportMaterialInterface : erSupportMaterial);</div>
<div class="line"><span class="lineno"> 1536</span>                            polys = std::move(offset_ex(poly, -flow.scaled_spacing()));</div>
<div class="line"><span class="lineno"> 1537</span>                        } else if (area_group.type == SupportLayer::Roof1stLayer) {</div>
<div class="line"><span class="lineno"> 1538</span>                            polys = std::move(offset_ex(poly, 0.5*support_flow.scaled_width()));</div>
<div class="line"><span class="lineno"> 1539</span>                        }</div>
<div class="line"><span class="lineno"> 1540</span>                        else {</div>
<div class="line"><span class="lineno"> 1541</span>                            polys.push_back(poly);</div>
<div class="line"><span class="lineno"> 1542</span>                        }</div>
<div class="line"><span class="lineno"> 1543</span>                        fill_params.density = interface_density;</div>
<div class="line"><span class="lineno"> 1544</span>                        fill_params.dont_adjust = true;</div>
<div class="line"><span class="lineno"> 1545</span>                    }</div>
<div class="line"><span class="lineno"> 1546</span>                    if (area_group.type == SupportLayer::Roof1stLayer) {</div>
<div class="line"><span class="lineno"> 1547</span>                        <span class="comment">// roof_1st_layer</span></div>
<div class="line"><span class="lineno"> 1548</span>                        fill_params.density = interface_density;</div>
<div class="line"><span class="lineno"> 1549</span>                        <span class="comment">// Note: spacing means the separation between two lines as if they are tightly extruded</span></div>
<div class="line"><span class="lineno"> 1550</span>                        filler_Roof1stLayer-&gt;spacing = m_support_material_interface_flow.spacing();</div>
<div class="line"><span class="lineno"> 1551</span>                        <span class="comment">// generate a perimeter first to support interface better</span></div>
<div class="line"><span class="lineno"> 1552</span>                        ExtrusionEntityCollection* temp_support_fills = new ExtrusionEntityCollection();</div>
<div class="line"><span class="lineno"> 1553</span>                        make_perimeter_and_infill(temp_support_fills-&gt;entities, *m_object-&gt;print(), poly, 1, m_support_material_interface_flow, erSupportMaterial,</div>
<div class="line"><span class="lineno"> 1554</span>                            filler_Roof1stLayer.get(), interface_density, false);</div>
<div class="line"><span class="lineno"> 1555</span>                        temp_support_fills-&gt;no_sort = true; <span class="comment">// make sure loops are first</span></div>
<div class="line"><span class="lineno"> 1556</span>                        if (!temp_support_fills-&gt;entities.empty())</div>
<div class="line"><span class="lineno"> 1557</span>                            ts_layer-&gt;support_fills.entities.push_back(temp_support_fills);</div>
<div class="line"><span class="lineno"> 1558</span>                        else</div>
<div class="line"><span class="lineno"> 1559</span>                            delete temp_support_fills;</div>
<div class="line"><span class="lineno"> 1560</span>                    } else if (area_group.type == SupportLayer::FloorType) {</div>
<div class="line"><span class="lineno"> 1561</span>                        <span class="comment">// floor_areas</span></div>
<div class="line"><span class="lineno"> 1562</span>                        fill_params.density = bottom_interface_density;</div>
<div class="line"><span class="lineno"> 1563</span>                        filler_interface-&gt;spacing = m_support_material_interface_flow.spacing();</div>
<div class="line"><span class="lineno"> 1564</span>                        fill_expolygons_generate_paths(ts_layer-&gt;support_fills.entities, std::move(polys),</div>
<div class="line"><span class="lineno"> 1565</span>                            filler_interface.get(), fill_params, erSupportMaterialInterface, m_support_material_interface_flow);</div>
<div class="line"><span class="lineno"> 1566</span>                    } else if (area_group.type == SupportLayer::RoofType) {</div>
<div class="line"><span class="lineno"> 1567</span>                        <span class="comment">// roof_areas</span></div>
<div class="line"><span class="lineno"> 1568</span>                        fill_params.density       = interface_density;</div>
<div class="line"><span class="lineno"> 1569</span>                        filler_interface-&gt;spacing = m_support_material_interface_flow.spacing();</div>
<div class="line"><span class="lineno"> 1570</span>                        if (m_object_config-&gt;support_interface_pattern == smipGrid) {</div>
<div class="line"><span class="lineno"> 1571</span>                            filler_interface-&gt;angle = Geometry::deg2rad(object_config.support_angle.value);</div>
<div class="line"><span class="lineno"> 1572</span>                            fill_params.dont_sort = true;</div>
<div class="line"><span class="lineno"> 1573</span>                        }</div>
<div class="line"><span class="lineno"> 1574</span>                        if (m_object_config-&gt;support_interface_pattern == smipRectilinearInterlaced)</div>
<div class="line"><span class="lineno"> 1575</span>                            filler_interface-&gt;layer_id = round(area_group.dist_to_top / ts_layer-&gt;height);</div>
<div class="line"><span class="lineno"> 1576</span>                        fill_expolygons_generate_paths(ts_layer-&gt;support_fills.entities, std::move(polys), filler_interface.get(), fill_params, erSupportMaterialInterface,</div>
<div class="line"><span class="lineno"> 1577</span>                                                       m_support_material_interface_flow);</div>
<div class="line"><span class="lineno"> 1578</span>                    }</div>
<div class="line"><span class="lineno"> 1579</span>                    else {</div>
<div class="line"><span class="lineno"> 1580</span>                        <span class="comment">// base_areas</span></div>
<div class="line"><span class="lineno"> 1581</span>                        Flow flow               = (layer_id == 0 &amp;&amp; m_raft_layers == 0) ? m_object-&gt;print()-&gt;brim_flow() : support_flow;</div>
<div class="line"><span class="lineno"> 1582</span>                        bool need_infill = with_infill;</div>
<div class="line"><span class="lineno"> 1583</span>                        if(m_object_config-&gt;support_base_pattern==smpDefault)</div>
<div class="line"><span class="lineno"> 1584</span>                            need_infill &amp;= area_group.need_infill;</div>
<div class="line"><span class="lineno"> 1585</span>                        if (layer_id&gt;0 &amp;&amp; area_group.dist_to_top &lt; 10 &amp;&amp; !need_infill &amp;&amp; support_style!=smsTreeHybrid) {</div>
<div class="line"><span class="lineno"> 1586</span>                            if (area_group.dist_to_top &lt; 5)  <span class="comment">// 1 wall at the top &lt;5mm</span></div>
<div class="line"><span class="lineno"> 1587</span>                                make_perimeter_and_inner_brim(ts_layer-&gt;support_fills.entities, poly, 1, flow, erSupportMaterial);</div>
<div class="line"><span class="lineno"> 1588</span>                            else <span class="comment">// at least 2 walls for range [5,10)</span></div>
<div class="line"><span class="lineno"> 1589</span>                                make_perimeter_and_inner_brim(ts_layer-&gt;support_fills.entities, poly, std::max(wall_count, size_t(2)), flow, erSupportMaterial);</div>
<div class="line"><span class="lineno"> 1590</span>                        }</div>
<div class="line"><span class="lineno"> 1591</span>                        else if (layer_id &gt; 0 &amp;&amp; need_infill &amp;&amp; m_support_params.base_fill_pattern != ipLightning) {</div>
<div class="line"><span class="lineno"> 1592</span>                            std::shared_ptr&lt;Fill&gt; filler_support = std::shared_ptr&lt;Fill&gt;(Fill::new_from_type(m_support_params.base_fill_pattern));</div>
<div class="line"><span class="lineno"> 1593</span>                            filler_support-&gt;set_bounding_box(bbox_object);</div>
<div class="line"><span class="lineno"> 1594</span>                            filler_support-&gt;spacing = object_config.support_base_pattern_spacing.value * support_density;<span class="comment">// constant spacing to align support infill lines</span></div>
<div class="line"><span class="lineno"> 1595</span>                            filler_support-&gt;angle = Geometry::deg2rad(object_config.support_angle.value);</div>
<div class="line"><span class="lineno"> 1596</span> </div>
<div class="line"><span class="lineno"> 1597</span>                            <span class="comment">// allow infill-only mode if support is thick enough (so min_wall_count is 0);</span></div>
<div class="line"><span class="lineno"> 1598</span>                            <span class="comment">// otherwise must draw 1 wall</span></div>
<div class="line"><span class="lineno"> 1599</span>                            size_t min_wall_count = offset(poly, -scale_(support_spacing * 1.5)).empty() ? 1 : 0;</div>
<div class="line"><span class="lineno"> 1600</span>                            make_perimeter_and_infill(ts_layer-&gt;support_fills.entities, *m_object-&gt;print(), poly, std::max(min_wall_count, wall_count), flow,</div>
<div class="line"><span class="lineno"> 1601</span>                                erSupportMaterial, filler_support.get(), support_density);</div>
<div class="line"><span class="lineno"> 1602</span>                        }</div>
<div class="line"><span class="lineno"> 1603</span>                        else {</div>
<div class="line"><span class="lineno"> 1604</span>                            make_perimeter_and_inner_brim(ts_layer-&gt;support_fills.entities, poly,</div>
<div class="line"><span class="lineno"> 1605</span>                                layer_id &gt; 0 ? wall_count : std::numeric_limits&lt;size_t&gt;::max(), flow, erSupportMaterial);</div>
<div class="line"><span class="lineno"> 1606</span>                        }</div>
<div class="line"><span class="lineno"> 1607</span>                        </div>
<div class="line"><span class="lineno"> 1608</span>                    }</div>
<div class="line"><span class="lineno"> 1609</span>                }</div>
<div class="line"><span class="lineno"> 1610</span>                if (m_support_params.base_fill_pattern == ipLightning)</div>
<div class="line"><span class="lineno"> 1611</span>                {</div>
<div class="line"><span class="lineno"> 1612</span>                    double print_z = ts_layer-&gt;print_z;</div>
<div class="line"><span class="lineno"> 1613</span>                    if (printZ_to_lightninglayer.find(print_z) == printZ_to_lightninglayer.end())</div>
<div class="line"><span class="lineno"> 1614</span>                        continue;</div>
<div class="line"><span class="lineno"> 1615</span>                    <span class="comment">//TODO:</span></div>
<div class="line"><span class="lineno"> 1616</span>                    <span class="comment">//1.the second parameter of convertToLines seems to decide how long the lightning should be trimmed from its root, so that the root wont overlap/detach the support contour.</span></div>
<div class="line"><span class="lineno"> 1617</span>                    <span class="comment">// whether current value works correctly remained to be tested</span></div>
<div class="line"><span class="lineno"> 1618</span>                    <span class="comment">//2.related to previous one, that lightning roots need to be trimed more when support has multiple walls</span></div>
<div class="line"><span class="lineno"> 1619</span>                    <span class="comment">//3.function connect_infill() and variable &#39;params&#39; helps create connection pattern along contours between two lightning roots,</span></div>
<div class="line"><span class="lineno"> 1620</span>                    <span class="comment">// strengthen lightnings while it may make support harder. decide to enable it or not. if yes, proper values for params are remained to be tested</span></div>
<div class="line"><span class="lineno"> 1621</span>                    auto&amp; lightning_layer = generator-&gt;getTreesForLayer(printZ_to_lightninglayer[print_z]);</div>
<div class="line"><span class="lineno"> 1622</span> </div>
<div class="line"><span class="lineno"> 1623</span>                    Flow       flow  = (layer_id == 0 &amp;&amp; m_raft_layers == 0) ? m_object-&gt;print()-&gt;brim_flow() :support_flow;</div>
<div class="line"><span class="lineno"> 1624</span>                    ExPolygons areas = offset_ex(ts_layer-&gt;base_areas, -flow.scaled_spacing());</div>
<div class="line"><span class="lineno"> 1625</span> </div>
<div class="line"><span class="lineno"> 1626</span>                    for (auto&amp; area : areas)</div>
<div class="line"><span class="lineno"> 1627</span>                    {</div>
<div class="line"><span class="lineno"> 1628</span>                        Polylines polylines = lightning_layer.convertToLines(to_polygons(area), 0);</div>
<div class="line"><span class="lineno"> 1629</span>                        for (auto itr = polylines.begin(); itr != polylines.end();)</div>
<div class="line"><span class="lineno"> 1630</span>                        {</div>
<div class="line"><span class="lineno"> 1631</span>                            if (itr-&gt;length() &lt; scale_(1.0))</div>
<div class="line"><span class="lineno"> 1632</span>                                itr = polylines.erase(itr);</div>
<div class="line"><span class="lineno"> 1633</span>                            else</div>
<div class="line"><span class="lineno"> 1634</span>                                itr++;</div>
<div class="line"><span class="lineno"> 1635</span>                        }</div>
<div class="line"><span class="lineno"> 1636</span>                        Polylines opt_polylines;</div>
<div class="line"><span class="lineno"> 1637</span>#if 1</div>
<div class="line"><span class="lineno"> 1638</span>                        <span class="comment">//this wont create connection patterns along contours</span></div>
<div class="line"><span class="lineno"> 1639</span>                        append(opt_polylines, chain_polylines(std::move(polylines)));</div>
<div class="line"><span class="lineno"> 1640</span>#else</div>
<div class="line"><span class="lineno"> 1641</span>                        <span class="comment">//this will create connection patterns along contours</span></div>
<div class="line"><span class="lineno"> 1642</span>                        FillParams params;</div>
<div class="line"><span class="lineno"> 1643</span>                        params.anchor_length = float(Fill::infill_anchor * 0.01 * flow.spacing());</div>
<div class="line"><span class="lineno"> 1644</span>                        params.anchor_length_max = Fill::infill_anchor_max;</div>
<div class="line"><span class="lineno"> 1645</span>                        params.anchor_length = std::min(params.anchor_length, params.anchor_length_max);</div>
<div class="line"><span class="lineno"> 1646</span>                        Fill::connect_infill(std::move(polylines), area, opt_polylines, flow.spacing(), params);</div>
<div class="line"><span class="lineno"> 1647</span>#endif</div>
<div class="line"><span class="lineno"> 1648</span>                        extrusion_entities_append_paths(ts_layer-&gt;support_fills.entities, opt_polylines, erSupportMaterial,</div>
<div class="line"><span class="lineno"> 1649</span>                            float(flow.mm3_per_mm()), float(flow.width()), float(flow.height()));</div>
<div class="line"><span class="lineno"> 1650</span> </div>
<div class="line"><span class="lineno"> 1651</span>#ifdef SUPPORT_TREE_DEBUG_TO_SVG</div>
<div class="line"><span class="lineno"> 1652</span>                        std::string name = <span class="stringliteral">&quot;./SVG/trees_polyline_&quot;</span> + std::to_string(ts_layer-&gt;print_z) <span class="comment">/*+ &quot;_&quot; + std::to_string(rand_num)*/</span> + <span class="stringliteral">&quot;.svg&quot;</span>;</div>
<div class="line"><span class="lineno"> 1653</span>                        BoundingBox bbox = get_extents(ts_layer-&gt;base_areas);</div>
<div class="line"><span class="lineno"> 1654</span>                        SVG svg(name, bbox);</div>
<div class="line"><span class="lineno"> 1655</span>                        if (svg.is_opened()) {</div>
<div class="line"><span class="lineno"> 1656</span>                            svg.draw(ts_layer-&gt;base_areas, <span class="stringliteral">&quot;blue&quot;</span>);</div>
<div class="line"><span class="lineno"> 1657</span>                            svg.draw(generator-&gt;Overhangs()[printZ_to_lightninglayer[print_z]], <span class="stringliteral">&quot;red&quot;</span>);</div>
<div class="line"><span class="lineno"> 1658</span>                            for (auto &amp;line : opt_polylines) svg.draw(line, <span class="stringliteral">&quot;yellow&quot;</span>);</div>
<div class="line"><span class="lineno"> 1659</span>                        }</div>
<div class="line"><span class="lineno"> 1660</span>#endif</div>
<div class="line"><span class="lineno"> 1661</span>                    }</div>
<div class="line"><span class="lineno"> 1662</span>                }</div>
<div class="line"><span class="lineno"> 1663</span> </div>
<div class="line"><span class="lineno"> 1664</span>                <span class="comment">// sort extrusions to reduce travel, also make sure walls go before infills</span></div>
<div class="line"><span class="lineno"> 1665</span>                if(ts_layer-&gt;support_fills.no_sort==false)</div>
<div class="line"><span class="lineno"> 1666</span>                    chain_and_reorder_extrusion_entities(ts_layer-&gt;support_fills.entities);</div>
<div class="line"><span class="lineno"> 1667</span>            }</div>
<div class="line"><span class="lineno"> 1668</span>        }</div>
<div class="line"><span class="lineno"> 1669</span>    );</div>
<div class="line"><span class="lineno"> 1670</span>}</div>
<div class="ttc" id="aclass_slic3r_1_1_const_vector_of_ptrs_adaptor_html_ad4bc30ba8bb4ce2d4e8e8c6c85ffcd04"><div class="ttname"><a href="../../d4/dab/class_slic3r_1_1_const_vector_of_ptrs_adaptor.html#ad4bc30ba8bb4ce2d4e8e8c6c85ffcd04">Slic3r::ConstVectorOfPtrsAdaptor::front</a></div><div class="ttdeci">const T * front() const</div><div class="ttdef"><b>Definition</b> Print.hpp:156</div></div>
<div class="ttc" id="aclass_slic3r_1_1_const_vector_of_ptrs_adaptor_html_add0d03a44936815c301ee82d76b2b792"><div class="ttname"><a href="../../d4/dab/class_slic3r_1_1_const_vector_of_ptrs_adaptor.html#add0d03a44936815c301ee82d76b2b792">Slic3r::ConstVectorOfPtrsAdaptor::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition</b> Print.hpp:160</div></div>
<div class="ttc" id="aclass_slic3r_1_1_fill_html_ae4f0ccb5cf9427ade958c67faa188c64"><div class="ttname"><a href="../../d7/dcc/class_slic3r_1_1_fill.html#ae4f0ccb5cf9427ade958c67faa188c64">Slic3r::Fill::new_from_type</a></div><div class="ttdeci">static Fill * new_from_type(const InfillPattern type)</div><div class="ttdef"><b>Definition</b> FillBase.cpp:36</div></div>
<div class="ttc" id="aclass_slic3r_1_1_flow_html_a84918dd0798eb452f858b0391847bddd"><div class="ttname"><a href="../../d6/d0f/class_slic3r_1_1_flow.html#a84918dd0798eb452f858b0391847bddd">Slic3r::Flow::auto_extrusion_width</a></div><div class="ttdeci">static float auto_extrusion_width(FlowRole role, float nozzle_diameter)</div><div class="ttdef"><b>Definition</b> Flow.cpp:21</div></div>
<div class="ttc" id="aclass_slic3r_1_1_print_html_a5b587e73fcc946136a3222e74dec5c83"><div class="ttname"><a href="../../d5/d8f/class_slic3r_1_1_print.html#a5b587e73fcc946136a3222e74dec5c83">Slic3r::Print::brim_flow</a></div><div class="ttdeci">Flow brim_flow() const</div><div class="ttdef"><b>Definition</b> Print.cpp:1327</div></div>
<div class="ttc" id="anamespace_slic3r_html_a4bcb312043a874462f942e362c16567aa16d80b2546547565f4e334f9cf68a415"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a4bcb312043a874462f942e362c16567aa16d80b2546547565f4e334f9cf68a415">Slic3r::frSupportMaterial</a></div><div class="ttdeci">@ frSupportMaterial</div><div class="ttdef"><b>Definition</b> Flow.hpp:22</div></div>
<div class="ttc" id="anamespace_slic3r_html_a5f8283c1f9814ff89f3a8013404d9649"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a5f8283c1f9814ff89f3a8013404d9649">Slic3r::extrusion_entities_append_loops</a></div><div class="ttdeci">void extrusion_entities_append_loops(ExtrusionEntitiesPtr &amp;dst, Polygons &amp;&amp;loops, ExtrusionRole role, double mm3_per_mm, float width, float height)</div><div class="ttdef"><b>Definition</b> ExtrusionEntity.hpp:548</div></div>
<div class="ttc" id="anamespace_slic3r_html_a6fa3193f46e8c4fc55359a5c124f46e6"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a6fa3193f46e8c4fc55359a5c124f46e6">Slic3r::ExtrusionRole</a></div><div class="ttdeci">ExtrusionRole</div><div class="ttdef"><b>Definition</b> ExtrusionEntity.hpp:20</div></div>
<div class="ttc" id="anamespace_slic3r_html_a6fa3193f46e8c4fc55359a5c124f46e6a54a07a476d1b976ab5ee4f95e80df634"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a6fa3193f46e8c4fc55359a5c124f46e6a54a07a476d1b976ab5ee4f95e80df634">Slic3r::erSupportMaterialInterface</a></div><div class="ttdeci">@ erSupportMaterialInterface</div><div class="ttdef"><b>Definition</b> ExtrusionEntity.hpp:36</div></div>
<div class="ttc" id="anamespace_slic3r_html_a6fa3193f46e8c4fc55359a5c124f46e6a667e5eb77b54b3867d5ddd7474bd2f1a"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a6fa3193f46e8c4fc55359a5c124f46e6a667e5eb77b54b3867d5ddd7474bd2f1a">Slic3r::erSupportMaterial</a></div><div class="ttdeci">@ erSupportMaterial</div><div class="ttdef"><b>Definition</b> ExtrusionEntity.hpp:35</div></div>
<div class="ttc" id="anamespace_slic3r_html_aa1f36f6004a4359d15dec3d8bbcf3e3e"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#aa1f36f6004a4359d15dec3d8bbcf3e3e">Slic3r::support_material_interface_flow</a></div><div class="ttdeci">Flow support_material_interface_flow(const PrintObject *object, float layer_height)</div><div class="ttdef"><b>Definition</b> Flow.cpp:244</div></div>
<div class="ttc" id="anamespace_slic3r_html_abca4f04baa025ac33fb5ba57fb9244eb"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#abca4f04baa025ac33fb5ba57fb9244eb">Slic3r::fill_expolygons_generate_paths</a></div><div class="ttdeci">static void fill_expolygons_generate_paths(ExtrusionEntitiesPtr &amp;dst, ExPolygons &amp;&amp;expolygons, Fill *filler, const FillParams &amp;fill_params, ExtrusionRole role, const Flow &amp;flow)</div><div class="ttdef"><b>Definition</b> SupportMaterial.cpp:3720</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00097">Slic3r::Fill::angle</a>, <a class="el" href="../../#l00273">Slic3r::SupportLayer::base_areas</a>, <a class="el" href="../../#l00045">Slic3r::FillParams::density</a>, <a class="el" href="../../#l00056">Slic3r::FillParams::dont_adjust</a>, <a class="el" href="../../#l00032">Slic3r::ExtrusionEntityCollection::entities</a>, <a class="el" href="../../#l00035">Slic3r::erSupportMaterial</a>, <a class="el" href="../../#l00036">Slic3r::erSupportMaterialInterface</a>, <a class="el" href="../../#l00548">Slic3r::extrusion_entities_append_loops()</a>, <a class="el" href="../../#l01239">Slic3r::fill_expolygons_generate_paths()</a>, <a class="el" href="../../#l00300">Slic3r::SupportLayer::floor_areas</a>, <a class="el" href="../../#l00065">Slic3r::Flow::height()</a>, <a class="el" href="../../#l00132">Slic3r::Layer::height</a>, <a class="el" href="../../#l00055">Slic3r::ipRectilinear</a>, <a class="el" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">Slic3r::layer_height()</a>, <a class="el" href="../../#l00148">Slic3r::Layer::lslices</a>, <a class="el" href="../../#l00201">Slic3r::Flow::mm3_per_mm()</a>, <a class="el" href="../../#l00409">Slic3r::offset_ex()</a>, <a class="el" href="../../#l01047">Slic3r::PrintObjectConfig</a>, <a class="el" href="../../#l00374">Slic3r::range()</a>, <a class="el" href="../../#l00298">Slic3r::SupportLayer::roof_areas</a>, <a class="el" href="../../#l00081">scale_</a>, <a class="el" href="../../#l00069">Slic3r::Flow::scaled_spacing()</a>, <a class="el" href="../../#l00093">Slic3r::Fill::spacing</a>, <a class="el" href="../../#l00269">Slic3r::SupportLayer::support_fills</a>, <a class="el" href="../../#l00244">Slic3r::support_material_interface_flow()</a>, and <a class="el" href="../../#l00061">Slic3r::Flow::width()</a>.</p>
<div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_aa1b40260186de1e3d617847acf7386b5_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a1f4739dd1f82d8f6dd87945aaf2ac00b" name="a1f4739dd1f82d8f6dd87945aaf2ac00b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f4739dd1f82d8f6dd87945aaf2ac00b">&#9670;&#160;</a></span>get_trim_support_regions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a> Slic3r::TreeSupport::get_trim_support_regions </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d87/class_slic3r_1_1_print_object.html">PrintObject</a> &amp;&#160;</td>
          <td class="paramname"><em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/dad/class_slic3r_1_1_support_layer.html">SupportLayer</a> *&#160;</td>
          <td class="paramname"><em>support_layer_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a>&#160;</td>
          <td class="paramname"><em>gap_extra_above</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a>&#160;</td>
          <td class="paramname"><em>gap_extra_below</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a>&#160;</td>
          <td class="paramname"><em>gap_xy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2008</span>{</div>
<div class="line"><span class="lineno"> 2009</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a9111d5e56324c880f1a8f185cc3cf645">sharp_tail_xy_gap</a> = 0.2f;</div>
<div class="line"><span class="lineno"> 2010</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a286ab5ffd65184a79428d60bf2a00253">no_overlap_xy_gap</a> = 0.2f;</div>
<div class="line"><span class="lineno"> 2011</span>    <span class="keywordtype">double</span> gap_xy_scaled = <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(gap_xy);</div>
<div class="line"><span class="lineno"> 2012</span>    SupportLayer&amp; support_layer = *support_layer_ptr;</div>
<div class="line"><span class="lineno"> 2013</span>    <span class="keyword">auto</span> m_print_config = <span class="keywordtype">object</span>.print()-&gt;config();</div>
<div class="line"><span class="lineno"> 2014</span> </div>
<div class="line"><span class="lineno"> 2015</span>    <span class="keywordtype">size_t</span> idx_object_layer_overlapping = size_t(-1);</div>
<div class="line"><span class="lineno"> 2016</span> </div>
<div class="line"><span class="lineno"> 2017</span>    <span class="keyword">auto</span> is_layers_overlap = [](<span class="keyword">const</span> SupportLayer&amp; support_layer, <span class="keyword">const</span> Layer&amp; object_layer, <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> bridging_height = 0.f) -&gt; <span class="keywordtype">bool</span> {</div>
<div class="line"><span class="lineno"> 2018</span>        <span class="keywordflow">if</span> (std::abs(support_layer.print_z - object_layer.print_z) &lt; <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>)</div>
<div class="line"><span class="lineno"> 2019</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2020</span> </div>
<div class="line"><span class="lineno"> 2021</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> object_lh = bridging_height &gt; <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a> ? bridging_height : object_layer.height;</div>
<div class="line"><span class="lineno"> 2022</span>        <span class="keywordflow">if</span> (support_layer.print_z &lt; object_layer.print_z &amp;&amp; support_layer.print_z &gt; object_layer.print_z - object_lh)</div>
<div class="line"><span class="lineno"> 2023</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2024</span> </div>
<div class="line"><span class="lineno"> 2025</span>        <span class="keywordflow">if</span> (support_layer.print_z &gt; object_layer.print_z &amp;&amp; support_layer.bottom_z() &lt; object_layer.print_z - <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>)</div>
<div class="line"><span class="lineno"> 2026</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2027</span> </div>
<div class="line"><span class="lineno"> 2028</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2029</span>        };</div>
<div class="line"><span class="lineno"> 2030</span> </div>
<div class="line"><span class="lineno"> 2031</span>    <span class="comment">// Find the overlapping object layers including the extra above / below gap.</span></div>
<div class="line"><span class="lineno"> 2032</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> z_threshold = support_layer.bottom_z() - gap_extra_below + <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>;</div>
<div class="line"><span class="lineno"> 2033</span>    idx_object_layer_overlapping = <a class="code hl_function" href="../../d1/d68/class_slic3r_1_1_layer.html#aa0cbe8238d4410456bb61b64ea96128e">Layer::idx_higher_or_equal</a>(</div>
<div class="line"><span class="lineno"> 2034</span>        <span class="keywordtype">object</span>.layers().<a class="code hl_function" href="../../dd/d66/namespacelibnest2d_1_1shapelike.html#a2aeb0374bbb83d0a6452bca14e1bbbda">begin</a>(), <span class="keywordtype">object</span>.layers().<a class="code hl_variable" href="../../d2/d86/xmltok__impl_8inc.html#ade76451eec04fdb3da08ae68f8afee41">end</a>(), idx_object_layer_overlapping,</div>
<div class="line"><span class="lineno"> 2035</span>        [z_threshold](<span class="keyword">const</span> Layer* layer) { <span class="keywordflow">return</span> layer-&gt;print_z &gt;= z_threshold; });</div>
<div class="line"><span class="lineno"> 2036</span>    <span class="comment">// Collect all the object layers intersecting with this layer.</span></div>
<div class="line"><span class="lineno"> 2037</span>    <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a> polygons_trimming;</div>
<div class="line"><span class="lineno"> 2038</span>    <span class="keywordtype">size_t</span> i = idx_object_layer_overlapping;</div>
<div class="line"><span class="lineno"> 2039</span>    <span class="keywordflow">for</span> (; i &lt; <span class="keywordtype">object</span>.layers().<a class="code hl_variable" href="../../de/d38/lzoconf_8h.html#a809275ccd755fb7b88661d952134b14d">size</a>(); ++i) {</div>
<div class="line"><span class="lineno"> 2040</span>        <span class="keyword">const</span> Layer&amp; object_layer = *<span class="keywordtype">object</span>.layers()[i];</div>
<div class="line"><span class="lineno"> 2041</span>        <span class="keywordflow">if</span> (object_layer.bottom_z() &gt; support_layer.print_z + gap_extra_above - <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>)</div>
<div class="line"><span class="lineno"> 2042</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2043</span> </div>
<div class="line"><span class="lineno"> 2044</span>        <span class="keywordtype">bool</span> is_overlap = is_layers_overlap(support_layer, object_layer);</div>
<div class="line"><span class="lineno"> 2045</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> ExPolygon&amp; expoly : object_layer.lslices) {</div>
<div class="line"><span class="lineno"> 2046</span>            <span class="comment">// BBS</span></div>
<div class="line"><span class="lineno"> 2047</span>            <span class="keywordtype">bool</span> is_sharptail = !<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a9853756af06b71590c902865926b8e28">intersection_ex</a>({ expoly }, object_layer.sharp_tails).<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a83fc268888773d5c0f886fc2e54b8c64">empty</a>();</div>
<div class="line"><span class="lineno"> 2048</span>            <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> trimming_offset = is_sharptail ? <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(<a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a9111d5e56324c880f1a8f185cc3cf645">sharp_tail_xy_gap</a>) :</div>
<div class="line"><span class="lineno"> 2049</span>                is_overlap ? gap_xy_scaled :</div>
<div class="line"><span class="lineno"> 2050</span>                <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(<a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a286ab5ffd65184a79428d60bf2a00253">no_overlap_xy_gap</a>);</div>
<div class="line"><span class="lineno"> 2051</span>            <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#ab4a593838c4a67f7ca75a318a9f707b2">polygons_append</a>(polygons_trimming, <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5ec552d076296fd705739c608edc1580">offset</a>({ expoly }, trimming_offset, <a class="code hl_define" href="../../db/d63/_print_object_8cpp.html#a952c572f92c0eee8cc1866011a230243">SUPPORT_SURFACES_OFFSET_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2052</span>            }</div>
<div class="line"><span class="lineno"> 2053</span>        }</div>
<div class="line"><span class="lineno"> 2054</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#ac8f1765efb10ac97c597982a0b4847f5">soluble_interface</a> &amp;&amp; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;thick_bridges) {</div>
<div class="line"><span class="lineno"> 2055</span>        <span class="comment">// Collect all bottom surfaces, which will be extruded with a bridging flow.</span></div>
<div class="line"><span class="lineno"> 2056</span>        <span class="keywordflow">for</span> (; i &lt; <span class="keywordtype">object</span>.layers().<a class="code hl_variable" href="../../de/d38/lzoconf_8h.html#a809275ccd755fb7b88661d952134b14d">size</a>(); ++i) {</div>
<div class="line"><span class="lineno"> 2057</span>            <span class="keyword">const</span> Layer&amp; object_layer = *<span class="keywordtype">object</span>.layers()[i];</div>
<div class="line"><span class="lineno"> 2058</span>            <span class="keywordtype">bool</span> some_region_overlaps = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2059</span>            <span class="keywordflow">for</span> (LayerRegion* region : object_layer.regions()) {</div>
<div class="line"><span class="lineno"> 2060</span>                <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> bridging_height = region-&gt;region().bridging_height_avg(m_print_config);</div>
<div class="line"><span class="lineno"> 2061</span>                <span class="keywordflow">if</span> (object_layer.print_z - bridging_height &gt; support_layer.print_z + gap_extra_above - <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>)</div>
<div class="line"><span class="lineno"> 2062</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2063</span>                some_region_overlaps = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2064</span> </div>
<div class="line"><span class="lineno"> 2065</span>                <span class="keywordtype">bool</span> is_overlap = is_layers_overlap(support_layer, object_layer, bridging_height);</div>
<div class="line"><span class="lineno"> 2066</span>                <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> trimming_offset = is_overlap ? gap_xy_scaled : <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(<a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#a286ab5ffd65184a79428d60bf2a00253">no_overlap_xy_gap</a>);</div>
<div class="line"><span class="lineno"> 2067</span>                <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#ab4a593838c4a67f7ca75a318a9f707b2">polygons_append</a>(polygons_trimming,</div>
<div class="line"><span class="lineno"> 2068</span>                    <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a5ec552d076296fd705739c608edc1580">offset</a>(region-&gt;fill_surfaces.filter_by_type(<a class="code hl_enumvalue" href="../../de/db8/namespace_slic3r.html#abe9699b26eb18f6636b045c930d167d8aab7b75c6465c93d9f8a8d76ab5494037">stBottomBridge</a>), trimming_offset, <a class="code hl_define" href="../../db/d63/_print_object_8cpp.html#a952c572f92c0eee8cc1866011a230243">SUPPORT_SURFACES_OFFSET_PARAMETERS</a>));</div>
<div class="line"><span class="lineno"> 2069</span>                }</div>
<div class="line"><span class="lineno"> 2070</span>            <span class="keywordflow">if</span> (!some_region_overlaps)</div>
<div class="line"><span class="lineno"> 2071</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2072</span>            }</div>
<div class="line"><span class="lineno"> 2073</span>        }</div>
<div class="line"><span class="lineno"> 2074</span> </div>
<div class="line"><span class="lineno"> 2075</span>    <span class="keywordflow">return</span> polygons_trimming;</div>
<div class="line"><span class="lineno"> 2076</span>}</div>
<div class="ttc" id="aclass_slic3r_1_1_layer_html_aa0cbe8238d4410456bb61b64ea96128e"><div class="ttname"><a href="../../d1/d68/class_slic3r_1_1_layer.html#aa0cbe8238d4410456bb61b64ea96128e">Slic3r::Layer::idx_higher_or_equal</a></div><div class="ttdeci">static IndexType idx_higher_or_equal(IteratorType begin, IteratorType end, IndexType idx, FN_HIGHER_EQUAL fn_higher_equal)</div><div class="ttdef"><b>Definition</b> Layer.hpp:205</div></div>
<div class="ttc" id="anamespace_slic3r_html_a286ab5ffd65184a79428d60bf2a00253"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a286ab5ffd65184a79428d60bf2a00253">Slic3r::no_overlap_xy_gap</a></div><div class="ttdeci">static const double no_overlap_xy_gap</div><div class="ttdef"><b>Definition</b> SupportMaterial.cpp:1527</div></div>
<div class="ttc" id="anamespace_slic3r_html_a9111d5e56324c880f1a8f185cc3cf645"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#a9111d5e56324c880f1a8f185cc3cf645">Slic3r::sharp_tail_xy_gap</a></div><div class="ttdeci">static const double sharp_tail_xy_gap</div><div class="ttdef"><b>Definition</b> SupportMaterial.cpp:1526</div></div>
<div class="ttc" id="anamespace_slic3r_html_ab4a593838c4a67f7ca75a318a9f707b2"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#ab4a593838c4a67f7ca75a318a9f707b2">Slic3r::polygons_append</a></div><div class="ttdeci">void polygons_append(Polygons &amp;dst, const ExPolygon &amp;src)</div><div class="ttdef"><b>Definition</b> ExPolygon.hpp:374</div></div>
<div class="ttc" id="anamespace_slic3r_html_abe9699b26eb18f6636b045c930d167d8aab7b75c6465c93d9f8a8d76ab5494037"><div class="ttname"><a href="../../de/db8/namespace_slic3r.html#abe9699b26eb18f6636b045c930d167d8aab7b75c6465c93d9f8a8d76ab5494037">Slic3r::stBottomBridge</a></div><div class="ttdeci">@ stBottomBridge</div><div class="ttdef"><b>Definition</b> Surface.hpp:15</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00133">Slic3r::Layer::bottom_z()</a>, <a class="el" href="../../#l00241">Slic3r::empty()</a>, <a class="el" href="../../#l00881">end</a>, <a class="el" href="../../#l00052">EPSILON</a>, <a class="el" href="../../#l00752">Slic3r::intersection_ex()</a>, <a class="el" href="../../#l00148">Slic3r::Layer::lslices</a>, <a class="el" href="../../#l00374">Slic3r::polygons_append()</a>, <a class="el" href="../../#l00131">Slic3r::Layer::print_z</a>, <a class="el" href="../../#l00158">Slic3r::Layer::regions()</a>, <a class="el" href="../../#l00081">scale_</a>, <a class="el" href="../../#l00136">Slic3r::Layer::sharp_tails</a>, <a class="el" href="../../#l00378">size</a>, <a class="el" href="../../#l00015">Slic3r::stBottomBridge</a>, and <a class="el" href="../../#l00714">SUPPORT_SURFACES_OFFSET_PARAMETERS</a>.</p>
<div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_a1f4739dd1f82d8f6dd87945aaf2ac00b_cgraph.svg" width="100%" height="475"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a311cf4a64ef47ee36a1bbcd2fccb2b20" name="a311cf4a64ef47ee36a1bbcd2fccb2b20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a311cf4a64ef47ee36a1bbcd2fccb2b20">&#9670;&#160;</a></span>insert_dropped_node()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> Slic3r::TreeSupport::insert_dropped_node </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>nodes_layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> *&#160;</td>
          <td class="paramname"><em>node</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add a node to the next layer. </p>
<p>If a node is already at that position in the layer, the nodes are merged. </p>
<div class="fragment"><div class="line"><span class="lineno"> 3583</span>{</div>
<div class="line"><span class="lineno"> 3584</span>    std::vector&lt;Node*&gt;::iterator conflicting_node_it = std::find(nodes_layer.begin(), nodes_layer.end(), p_node);</div>
<div class="line"><span class="lineno"> 3585</span>    <span class="keywordflow">if</span> (conflicting_node_it == nodes_layer.end()) <span class="comment">//No conflict.</span></div>
<div class="line"><span class="lineno"> 3586</span>    {</div>
<div class="line"><span class="lineno"> 3587</span>        nodes_layer.emplace_back(p_node);</div>
<div class="line"><span class="lineno"> 3588</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3589</span>    }</div>
<div class="line"><span class="lineno"> 3590</span> </div>
<div class="line"><span class="lineno"> 3591</span>    Node* conflicting_node = *conflicting_node_it;</div>
<div class="line"><span class="lineno"> 3592</span>    conflicting_node-&gt;distance_to_top = std::max(conflicting_node-&gt;distance_to_top, p_node-&gt;distance_to_top);</div>
<div class="line"><span class="lineno"> 3593</span>    conflicting_node-&gt;support_roof_layers_below = std::max(conflicting_node-&gt;support_roof_layers_below, p_node-&gt;support_roof_layers_below);</div>
<div class="line"><span class="lineno"> 3594</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00291">Slic3r::TreeSupport::Node::distance_to_top</a>, and <a class="el" href="../../#l00323">Slic3r::TreeSupport::Node::support_roof_layers_below</a>.</p>

</div>
</div>
<a id="a819f86c9e3f1aef6f1c99d66a4c19725" name="a819f86c9e3f1aef6f1c99d66a4c19725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a819f86c9e3f1aef6f1c99d66a4c19725">&#9670;&#160;</a></span>plan_layer_heights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="../../d8/d61/struct_slic3r_1_1_layer_height_data.html">LayerHeightData</a> &gt; Slic3r::TreeSupport::plan_layer_heights </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>contact_nodes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Optimize the generation of tree support by pre-planning the layer_heights. </p>
<p>BBS: MusangKing: maximum layer height  </p>
<div class="fragment"><div class="line"><span class="lineno"> 3283</span>{</div>
<div class="line"><span class="lineno"> 3284</span>    <span class="keyword">const</span> <a class="code hl_variable" href="../../de/db8/namespace_slic3r.html#ad48b86fa8e529e56c6bd00ff2f9839ab">PrintObjectConfig</a>&amp; config = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#abde3ac4f19e1f9d342423a7643e17266">config</a>();</div>
<div class="line"><span class="lineno"> 3285</span>    <span class="keyword">const</span> PrintConfig &amp;      print_config     = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../d5/d8f/class_slic3r_1_1_print.html#af1937a680d19c7dd8d3c24e5ff7332b8">config</a>();</div>
<div class="line"><span class="lineno"> 3286</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a19be622d0f5e34b67adb49c73cfaae53">max_layer_height</a> = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#a015b5a46493742b5a3fe2094507ac411">max_layer_height</a>;</div>
<div class="line"><span class="lineno"> 3287</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a> = config.layer_height.value;</div>
<div class="line"><span class="lineno"> 3288</span>    <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> z_distance_top = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#ae75919394f64528204ca434684c06d1b">gap_support_object</a>;</div>
<div class="line"><span class="lineno"> 3289</span>    <span class="comment">// BBS: add extra distance if thick bridge is enabled</span></div>
<div class="line"><span class="lineno"> 3290</span>    <span class="comment">// Note: normal support uses print_z, but tree support uses integer layers, so we need to subtract layer_height</span></div>
<div class="line"><span class="lineno"> 3291</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#ac8f1765efb10ac97c597982a0b4847f5">soluble_interface</a> &amp;&amp; <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a676288a8d6c41e000fa9c603362300da">m_object_config</a>-&gt;thick_bridges) {</div>
<div class="line"><span class="lineno"> 3292</span>        z_distance_top += <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#a4d0b4aca78fffa73137e8791e6b9065b">layers</a>()[0]-&gt;regions()[0]-&gt;region().bridging_height_avg(<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../d6/d0d/class_slic3r_1_1_print_object_base_with_state.html#ac2790a8abd4e0ae7ca1290b25285940e">print</a>()-&gt;<a class="code hl_function" href="../../d5/d8f/class_slic3r_1_1_print.html#af1937a680d19c7dd8d3c24e5ff7332b8">config</a>()) - <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a>;</div>
<div class="line"><span class="lineno"> 3293</span>    }</div>
<div class="line"><span class="lineno"> 3294</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> support_roof_layers = config.support_interface_top_layers.value;</div>
<div class="line"><span class="lineno"> 3295</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> z_distance_top_layers = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a799d085686d773026ef9031e8dfc0907">round_up_divide</a>(<a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(z_distance_top), <a class="code hl_define" href="../../dd/d47/libslic3r_8h.html#a5e7dd5d14b7e7bb8f1dab0fd4fa3e0f2">scale_</a>(<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a>)) + 1;</div>
<div class="line"><span class="lineno"> 3296</span>    std::vector&lt;LayerHeightData&gt; layer_heights(contact_nodes.size());</div>
<div class="line"><span class="lineno"> 3297</span>    std::vector&lt;int&gt; <a class="code hl_function" href="../../d8/d86/namespace_slic3r_1_1opt.html#ad9b818b6999367924c5dcf86a940c2f4">bounds</a>;</div>
<div class="line"><span class="lineno"> 3298</span> </div>
<div class="line"><span class="lineno"> 3299</span>    <span class="keywordflow">if</span> (!config.tree_support_adaptive_layer_height || <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a> == <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a19be622d0f5e34b67adb49c73cfaae53">max_layer_height</a> || !print_config.independent_support_layer_height) {</div>
<div class="line"><span class="lineno"> 3300</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = 0; layer_nr &lt; contact_nodes.size(); layer_nr++) {</div>
<div class="line"><span class="lineno"> 3301</span>            layer_heights[layer_nr] = {<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a8918ae15322de198ce6d0632feaac9b4">print_z</a>, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a37f53b1ef3b7fc3131f18845cd9c264a">height</a>, layer_nr &gt; 0 ? size_t(layer_nr - 1) : 0};</div>
<div class="line"><span class="lineno"> 3302</span>        }</div>
<div class="line"><span class="lineno"> 3303</span>        <span class="keywordflow">return</span> layer_heights;</div>
<div class="line"><span class="lineno"> 3304</span>    }</div>
<div class="line"><span class="lineno"> 3305</span> </div>
<div class="line"><span class="lineno"> 3306</span>    <a class="code hl_function" href="../../d8/d86/namespace_slic3r_1_1opt.html#ad9b818b6999367924c5dcf86a940c2f4">bounds</a>.push_back(0);</div>
<div class="line"><span class="lineno"> 3307</span>    <span class="comment">// Keep first layer still</span></div>
<div class="line"><span class="lineno"> 3308</span>    layer_heights[0] = {<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(0)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a8918ae15322de198ce6d0632feaac9b4">print_z</a>, <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(0)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a37f53b1ef3b7fc3131f18845cd9c264a">height</a>, 0};</div>
<div class="line"><span class="lineno"> 3309</span>    <span class="comment">// Collect top contact layers</span></div>
<div class="line"><span class="lineno"> 3310</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = 1; layer_nr &lt; contact_nodes.size(); layer_nr++)</div>
<div class="line"><span class="lineno"> 3311</span>    {</div>
<div class="line"><span class="lineno"> 3312</span>        <span class="keywordflow">if</span> (!contact_nodes[layer_nr].<a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a83fc268888773d5c0f886fc2e54b8c64">empty</a>())</div>
<div class="line"><span class="lineno"> 3313</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; support_roof_layers + z_distance_top_layers + 1; i++) {</div>
<div class="line"><span class="lineno"> 3314</span>                <span class="keywordflow">if</span> (layer_nr - i &gt; 0) {</div>
<div class="line"><span class="lineno"> 3315</span>                    <a class="code hl_function" href="../../d8/d86/namespace_slic3r_1_1opt.html#ad9b818b6999367924c5dcf86a940c2f4">bounds</a>.push_back(layer_nr - i);</div>
<div class="line"><span class="lineno"> 3316</span>                    layer_heights[layer_nr - i].print_z = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr - i)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a8918ae15322de198ce6d0632feaac9b4">print_z</a>;</div>
<div class="line"><span class="lineno"> 3317</span>                    layer_heights[layer_nr - i].height = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr - i)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a37f53b1ef3b7fc3131f18845cd9c264a">height</a>;</div>
<div class="line"><span class="lineno"> 3318</span>                } </div>
<div class="line"><span class="lineno"> 3319</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3320</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3321</span>                }</div>
<div class="line"><span class="lineno"> 3322</span> </div>
<div class="line"><span class="lineno"> 3323</span>            }</div>
<div class="line"><span class="lineno"> 3324</span>    }</div>
<div class="line"><span class="lineno"> 3325</span>    std::set&lt;int&gt; s(<a class="code hl_function" href="../../d8/d86/namespace_slic3r_1_1opt.html#ad9b818b6999367924c5dcf86a940c2f4">bounds</a>.begin(), <a class="code hl_function" href="../../d8/d86/namespace_slic3r_1_1opt.html#ad9b818b6999367924c5dcf86a940c2f4">bounds</a>.end());</div>
<div class="line"><span class="lineno"> 3326</span>    <a class="code hl_function" href="../../d8/d86/namespace_slic3r_1_1opt.html#ad9b818b6999367924c5dcf86a940c2f4">bounds</a>.assign(s.begin(), s.end());</div>
<div class="line"><span class="lineno"> 3327</span> </div>
<div class="line"><span class="lineno"> 3328</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> idx_extreme = 0; idx_extreme &lt; <a class="code hl_function" href="../../d8/d86/namespace_slic3r_1_1opt.html#ad9b818b6999367924c5dcf86a940c2f4">bounds</a>.size(); idx_extreme++) {</div>
<div class="line"><span class="lineno"> 3329</span>        <span class="keywordtype">int</span> extr2_layer_nr = <a class="code hl_function" href="../../d8/d86/namespace_slic3r_1_1opt.html#ad9b818b6999367924c5dcf86a940c2f4">bounds</a>[idx_extreme];</div>
<div class="line"><span class="lineno"> 3330</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> extr2z = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(extr2_layer_nr)-&gt;<a class="code hl_function" href="../../d1/d68/class_slic3r_1_1_layer.html#abdaf2fa25fbc0bc32cdcd71f53583845">bottom_z</a>();</div>
<div class="line"><span class="lineno"> 3331</span>        <span class="keywordtype">int</span> extr1_layer_nr = idx_extreme == 0 ? -1 : <a class="code hl_function" href="../../d8/d86/namespace_slic3r_1_1opt.html#ad9b818b6999367924c5dcf86a940c2f4">bounds</a>[idx_extreme - 1];</div>
<div class="line"><span class="lineno"> 3332</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> extr1z = idx_extreme == 0 ? 0.f : <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(extr1_layer_nr)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a8918ae15322de198ce6d0632feaac9b4">print_z</a>;</div>
<div class="line"><span class="lineno"> 3333</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../d3/dfb/namespace_slic3r_1_1_geometry.html#a2b2112c1026a31e7c4c00693ca0bc2e2">dist</a> = extr2z - extr1z;</div>
<div class="line"><span class="lineno"> 3334</span> </div>
<div class="line"><span class="lineno"> 3335</span>        <span class="comment">// Insert intermediate layers.</span></div>
<div class="line"><span class="lineno"> 3336</span>        <span class="keywordtype">size_t</span> n_layers_extra = size_t(<a class="code hl_function" href="../../d4/df0/_array_cwise_unary_ops_8h.html#a63043b6807e8e10fb1adf4667e3664d2">ceil</a>(dist / (<a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a0f07085f338767f4b9fff39a418e717f">m_slicing_params</a>.<a class="code hl_variable" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html#adcacd33d748550926fbff35daa13d8eb">max_suport_layer_height</a> + <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>)));</div>
<div class="line"><span class="lineno"> 3337</span>        <span class="keywordtype">int</span> actual_internel_layers = extr2_layer_nr - extr1_layer_nr - 1;</div>
<div class="line"><span class="lineno"> 3338</span>        <span class="keywordtype">int</span> extr_layers_left = extr2_layer_nr - extr1_layer_nr - n_layers_extra - 1;</div>
<div class="line"><span class="lineno"> 3339</span>        <span class="keywordflow">if</span> (n_layers_extra &lt; 1)</div>
<div class="line"><span class="lineno"> 3340</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3341</span> </div>
<div class="line"><span class="lineno"> 3342</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> <a class="code hl_function" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a6ceea497872e0323516dbb68ef605a21">step</a> = <a class="code hl_function" href="../../d3/dfb/namespace_slic3r_1_1_geometry.html#a2b2112c1026a31e7c4c00693ca0bc2e2">dist</a> / <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a>(n_layers_extra);</div>
<div class="line"><span class="lineno"> 3343</span>        <a class="code hl_typedef" href="../../dd/d47/libslic3r_8h.html#a95c875c81df33d788132374e2b57c6c1">coordf_t</a> print_z = extr1z + <a class="code hl_function" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a6ceea497872e0323516dbb68ef605a21">step</a>;</div>
<div class="line"><span class="lineno"> 3344</span>        assert(step &gt;= <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">layer_height</a> - <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>);</div>
<div class="line"><span class="lineno"> 3345</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = extr1_layer_nr + 1; layer_nr &lt; extr2_layer_nr; layer_nr++) {</div>
<div class="line"><span class="lineno"> 3346</span>            <span class="comment">// if (curr_layer_nodes.empty()) continue;</span></div>
<div class="line"><span class="lineno"> 3347</span>            <span class="keywordflow">if</span> (std::abs(print_z - <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#a3dea25663c426511a32a88d80361fa37">m_object</a>-&gt;<a class="code hl_function" href="../../de/d87/class_slic3r_1_1_print_object.html#aeb29a80908c06dd8644112f4cfff9354">get_layer</a>(layer_nr)-&gt;<a class="code hl_variable" href="../../d1/d68/class_slic3r_1_1_layer.html#a8918ae15322de198ce6d0632feaac9b4">print_z</a>) &lt; step / 2 + <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a> || extr_layers_left &lt; 1) {</div>
<div class="line"><span class="lineno"> 3348</span>                layer_heights[layer_nr].print_z = print_z;</div>
<div class="line"><span class="lineno"> 3349</span>                layer_heights[layer_nr].height = <a class="code hl_function" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a6ceea497872e0323516dbb68ef605a21">step</a>;</div>
<div class="line"><span class="lineno"> 3350</span>                print_z += <a class="code hl_function" href="../../d9/d6c/namespacemarchsq_1_1____impl.html#a6ceea497872e0323516dbb68ef605a21">step</a>;</div>
<div class="line"><span class="lineno"> 3351</span>            }</div>
<div class="line"><span class="lineno"> 3352</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3353</span>                <span class="comment">// can&#39;t clear curr_layer_nodes, or the model will have empty layers</span></div>
<div class="line"><span class="lineno"> 3354</span>                layer_heights[layer_nr].print_z = 0.0;</div>
<div class="line"><span class="lineno"> 3355</span>                layer_heights[layer_nr].height = 0.0;</div>
<div class="line"><span class="lineno"> 3356</span>                extr_layers_left--;</div>
<div class="line"><span class="lineno"> 3357</span>            }</div>
<div class="line"><span class="lineno"> 3358</span>        }</div>
<div class="line"><span class="lineno"> 3359</span>    }</div>
<div class="line"><span class="lineno"> 3360</span> </div>
<div class="line"><span class="lineno"> 3361</span>    <span class="comment">// fill in next_layer_nr</span></div>
<div class="line"><span class="lineno"> 3362</span>    <span class="keywordtype">int</span> i = layer_heights.size() - 1, j = i;</div>
<div class="line"><span class="lineno"> 3363</span>    <span class="keywordflow">for</span> (; j &gt;= 0; i = j) {</div>
<div class="line"><span class="lineno"> 3364</span>        <span class="keywordflow">if</span> (layer_heights[i].height &lt; <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>) {</div>
<div class="line"><span class="lineno"> 3365</span>            j--;</div>
<div class="line"><span class="lineno"> 3366</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3367</span>        }</div>
<div class="line"><span class="lineno"> 3368</span>        <span class="keywordflow">for</span> (j = i - 1; j &gt;= 0; j--) {</div>
<div class="line"><span class="lineno"> 3369</span>            <span class="keywordflow">if</span> (layer_heights[j].height &gt; <a class="code hl_variable" href="../../dd/d47/libslic3r_8h.html#a75f355966e0a97665eaf5a4c79baa7af">EPSILON</a>) {</div>
<div class="line"><span class="lineno"> 3370</span>                layer_heights[i].next_layer_nr = j;</div>
<div class="line"><span class="lineno"> 3371</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3372</span>            }</div>
<div class="line"><span class="lineno"> 3373</span>        }</div>
<div class="line"><span class="lineno"> 3374</span>        BOOST_LOG_TRIVIAL(info) &lt;&lt; <span class="stringliteral">&quot;plan_layer_heights print_z, height, layer_nr-&gt;next_layer_nr: &quot;</span> &lt;&lt; layer_heights[i].print_z &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; layer_heights[i].height &lt;&lt; <span class="stringliteral">&quot;   &quot;</span></div>
<div class="line"><span class="lineno"> 3375</span>            &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;-&gt;&quot;</span> &lt;&lt; layer_heights[i].next_layer_nr &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 3376</span>    }</div>
<div class="line"><span class="lineno"> 3377</span> </div>
<div class="line"><span class="lineno"> 3378</span>    <span class="keywordflow">return</span> layer_heights;</div>
<div class="line"><span class="lineno"> 3379</span>}</div>
<div class="ttc" id="anamespace_slic3r_1_1opt_html_ad9b818b6999367924c5dcf86a940c2f4"><div class="ttname"><a href="../../d8/d86/namespace_slic3r_1_1opt.html#ad9b818b6999367924c5dcf86a940c2f4">Slic3r::opt::bounds</a></div><div class="ttdeci">Bounds&lt; N &gt; bounds(const Bound(&amp;b)[N])</div><div class="ttdef"><b>Definition</b> Optimizer.hpp:174</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00402">ceil()</a>, <a class="el" href="../../#l00241">Slic3r::empty()</a>, <a class="el" href="../../#l00052">EPSILON</a>, <a class="el" href="../../de/db8/namespace_slic3r.html#a3fc0fbbcb45d8a2fef27e26e1289ec21">Slic3r::layer_height()</a>, <a class="el" href="../../de/db8/namespace_slic3r.html#a19be622d0f5e34b67adb49c73cfaae53">Slic3r::max_layer_height()</a>, <a class="el" href="../../#l01047">Slic3r::PrintObjectConfig</a>, <a class="el" href="../../#l00041">Slic3r::round_up_divide()</a>, and <a class="el" href="../../#l00081">scale_</a>.</p>
<div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_a819f86c9e3f1aef6f1c99d66a4c19725_cgraph.svg" width="360" height="234"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2a48a228bbe9db750b4acb65e1ea7ae5" name="a2a48a228bbe9db750b4acb65e1ea7ae5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a48a228bbe9db750b4acb65e1ea7ae5">&#9670;&#160;</a></span>smooth_nodes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d95/glu-libtess_8h.html#a4292190e3f1f6b373a760c7d9316ad3c">void</a> Slic3r::TreeSupport::smooth_nodes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="../../d3/d61/struct_slic3r_1_1_tree_support_1_1_node.html">Node</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>contact_nodes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3103</span>{</div>
<div class="line"><span class="lineno"> 3104</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = 0; layer_nr &lt; contact_nodes.size(); layer_nr++) {</div>
<div class="line"><span class="lineno"> 3105</span>        std::vector&lt;Node *&gt; &amp;curr_layer_nodes = contact_nodes[layer_nr];</div>
<div class="line"><span class="lineno"> 3106</span>        <span class="keywordflow">if</span> (curr_layer_nodes.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3107</span>        <span class="keywordflow">for</span> (Node *node : curr_layer_nodes) {</div>
<div class="line"><span class="lineno"> 3108</span>            node-&gt;is_processed = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3109</span>            <span class="keywordflow">if</span> (layer_nr == 0) node-&gt;is_merged = <span class="keyword">true</span>;  <span class="comment">// nodes on plate are also merged nodes</span></div>
<div class="line"><span class="lineno"> 3110</span>        }</div>
<div class="line"><span class="lineno"> 3111</span>    }</div>
<div class="line"><span class="lineno"> 3112</span> </div>
<div class="line"><span class="lineno"> 3113</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = 0; layer_nr&lt; contact_nodes.size(); layer_nr++) {</div>
<div class="line"><span class="lineno"> 3114</span>        std::vector&lt;Node *&gt; &amp;curr_layer_nodes = contact_nodes[layer_nr];</div>
<div class="line"><span class="lineno"> 3115</span>        <span class="keywordflow">if</span> (curr_layer_nodes.empty()) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3116</span>        <span class="keywordflow">for</span> (Node *node : curr_layer_nodes) {</div>
<div class="line"><span class="lineno"> 3117</span>            <span class="keywordflow">if</span> (!node-&gt;is_processed) {</div>
<div class="line"><span class="lineno"> 3118</span>                std::vector&lt;Point&gt; pts;</div>
<div class="line"><span class="lineno"> 3119</span>                std::vector&lt;Node *&gt;   branch;</div>
<div class="line"><span class="lineno"> 3120</span>                Node *              p_node = node;</div>
<div class="line"><span class="lineno"> 3121</span>                <span class="comment">// add a fixed head</span></div>
<div class="line"><span class="lineno"> 3122</span>                <span class="keywordflow">if</span> (node-&gt;child) {</div>
<div class="line"><span class="lineno"> 3123</span>                    pts.push_back(p_node-&gt;child-&gt;position);</div>
<div class="line"><span class="lineno"> 3124</span>                    branch.push_back(p_node-&gt;child);</div>
<div class="line"><span class="lineno"> 3125</span>                }</div>
<div class="line"><span class="lineno"> 3126</span>                <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno"> 3127</span>                    pts.push_back(p_node-&gt;position);</div>
<div class="line"><span class="lineno"> 3128</span>                    branch.push_back(p_node);</div>
<div class="line"><span class="lineno"> 3129</span>                    p_node = p_node-&gt;parent;</div>
<div class="line"><span class="lineno"> 3130</span>                } <span class="keywordflow">while</span> (p_node &amp;&amp; !p_node-&gt;is_processed);</div>
<div class="line"><span class="lineno"> 3131</span>                <span class="keywordflow">if</span> (pts.size() &lt; 3) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3132</span> </div>
<div class="line"><span class="lineno"> 3133</span>                std::vector&lt;Point&gt; pts1 = pts;</div>
<div class="line"><span class="lineno"> 3134</span>                <span class="comment">// TODO here we assume layer height gap is constant. If not true, need to consider height jump</span></div>
<div class="line"><span class="lineno"> 3135</span>                <span class="keyword">const</span> <span class="keywordtype">int</span> iterations = 100;</div>
<div class="line"><span class="lineno"> 3136</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; iterations; k++) {</div>
<div class="line"><span class="lineno"> 3137</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; pts.size() - 1; i++) {</div>
<div class="line"><span class="lineno"> 3138</span>                        <span class="keywordtype">size_t</span>   i2 = i &gt;= 2 ? i - 2 : 0;</div>
<div class="line"><span class="lineno"> 3139</span>                        <span class="keywordtype">size_t</span>   i3 = i &lt; pts.size() - 2 ? i + 2 : pts.size() - 1;</div>
<div class="line"><span class="lineno"> 3140</span>                        <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> pt  = (pts[i2] + pts[i - 1] + pts[i] + pts[i + 1] + pts[i3]) / 5;</div>
<div class="line"><span class="lineno"> 3141</span>                        pts1[i] = pt;</div>
<div class="line"><span class="lineno"> 3142</span>                        <span class="keywordflow">if</span> (k == iterations - 1) {</div>
<div class="line"><span class="lineno"> 3143</span>                            branch[i]-&gt;position = pt;</div>
<div class="line"><span class="lineno"> 3144</span>                            branch[i]-&gt;movement = (pts[i + 1] - pts[i - 1]) / 2;</div>
<div class="line"><span class="lineno"> 3145</span>                            branch[i]-&gt;is_processed = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3146</span>                        }</div>
<div class="line"><span class="lineno"> 3147</span>                    }</div>
<div class="line"><span class="lineno"> 3148</span>                    <span class="keywordflow">if</span> (k &lt; iterations - 1)</div>
<div class="line"><span class="lineno"> 3149</span>                        std::swap(pts, pts1);</div>
<div class="line"><span class="lineno"> 3150</span>                }</div>
<div class="line"><span class="lineno"> 3151</span>            }</div>
<div class="line"><span class="lineno"> 3152</span>        }</div>
<div class="line"><span class="lineno"> 3153</span>    }</div>
<div class="line"><span class="lineno"> 3154</span>    <span class="comment">// save tree structure for viewing in python</span></div>
<div class="line"><span class="lineno"> 3155</span>    <span class="keyword">auto</span>&amp; tree_nodes = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa683ac2cae76bf3adfde9333039016db">m_ts_data</a>-&gt;tree_nodes;</div>
<div class="line"><span class="lineno"> 3156</span>    std::map&lt;Node*, int&gt; ptr2idx;</div>
<div class="line"><span class="lineno"> 3157</span>    std::map&lt;int, Node*&gt; idx2ptr;</div>
<div class="line"><span class="lineno"> 3158</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> layer_nr = 0; layer_nr &lt; contact_nodes.size(); layer_nr++) {</div>
<div class="line"><span class="lineno"> 3159</span>        std::vector&lt;Node*&gt;&amp; curr_layer_nodes = contact_nodes[layer_nr];</div>
<div class="line"><span class="lineno"> 3160</span>        <span class="keywordflow">for</span> (Node* node : curr_layer_nodes) {</div>
<div class="line"><span class="lineno"> 3161</span>            ptr2idx.emplace(node, tree_nodes.size());</div>
<div class="line"><span class="lineno"> 3162</span>            idx2ptr.emplace(tree_nodes.size(), node);</div>
<div class="line"><span class="lineno"> 3163</span>            tree_nodes.emplace_back(node-&gt;position, node-&gt;print_z);</div>
<div class="line"><span class="lineno"> 3164</span>        }</div>
<div class="line"><span class="lineno"> 3165</span>    }</div>
<div class="line"><span class="lineno"> 3166</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; tree_nodes.size(); i++) {</div>
<div class="line"><span class="lineno"> 3167</span>        <a class="code hl_function" href="../../df/d13/namespace_im_gui.html#a4dff507ce8bbe0da9556bb50b1e60d7f">TreeNode</a>&amp; tree_node = tree_nodes[i];</div>
<div class="line"><span class="lineno"> 3168</span>        Node* p_node = idx2ptr[i];</div>
<div class="line"><span class="lineno"> 3169</span>        <span class="keywordflow">if</span> (p_node-&gt;child)</div>
<div class="line"><span class="lineno"> 3170</span>            tree_node.children.push_back(ptr2idx[p_node-&gt;child]);</div>
<div class="line"><span class="lineno"> 3171</span>        <span class="keywordflow">if</span>(p_node-&gt;parent)</div>
<div class="line"><span class="lineno"> 3172</span>            tree_node.parents.push_back(ptr2idx[p_node-&gt;parent]);</div>
<div class="line"><span class="lineno"> 3173</span>    }</div>
<div class="line"><span class="lineno"> 3174</span><span class="preprocessor">#ifdef SUPPORT_TREE_DEBUG_TO_SVG</span></div>
<div class="line"><span class="lineno"> 3175</span>    <a class="code hl_class" href="../../d9/dcc/classnlohmann_1_1basic__json.html">nlohmann::json</a> jj;</div>
<div class="line"><span class="lineno"> 3176</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; tree_nodes.size(); i++) {</div>
<div class="line"><span class="lineno"> 3177</span>        <a class="code hl_class" href="../../d9/dcc/classnlohmann_1_1basic__json.html">nlohmann::json</a> j;</div>
<div class="line"><span class="lineno"> 3178</span>        j[<span class="stringliteral">&quot;pos&quot;</span>] = tree_nodes[i].pos;</div>
<div class="line"><span class="lineno"> 3179</span>        j[<span class="stringliteral">&quot;children&quot;</span>] = tree_nodes[i].children;</div>
<div class="line"><span class="lineno"> 3180</span>        j[<span class="stringliteral">&quot;linked&quot;</span>] = !(tree_nodes[i].pos.z() &gt; 0.205 &amp;&amp; tree_nodes[i].children.empty());</div>
<div class="line"><span class="lineno"> 3181</span>        jj.<a class="code hl_function" href="../../d9/dcc/classnlohmann_1_1basic__json.html#ab9e0253c92736db021840105d374c4c4">push_back</a>(j);</div>
<div class="line"><span class="lineno"> 3182</span>    }</div>
<div class="line"><span class="lineno"> 3183</span>    </div>
<div class="line"><span class="lineno"> 3184</span>    std::ofstream ofs(<span class="stringliteral">&quot;tree_nodes.json&quot;</span>);</div>
<div class="line"><span class="lineno"> 3185</span>    ofs &lt;&lt; jj.<a class="code hl_function" href="../../d9/dcc/classnlohmann_1_1basic__json.html#a476756fb08e7f2416aad116d137977f4">dump</a>();</div>
<div class="line"><span class="lineno"> 3186</span>    ofs.close();</div>
<div class="line"><span class="lineno"> 3187</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3188</span>}</div>
<div class="ttc" id="aclassnlohmann_1_1basic__json_html"><div class="ttname"><a href="../../d9/dcc/classnlohmann_1_1basic__json.html">nlohmann::basic_json</a></div><div class="ttdoc">a class to store JSON values</div><div class="ttdef"><b>Definition</b> json.hpp:177</div></div>
<div class="ttc" id="aclassnlohmann_1_1basic__json_html_a476756fb08e7f2416aad116d137977f4"><div class="ttname"><a href="../../d9/dcc/classnlohmann_1_1basic__json.html#a476756fb08e7f2416aad116d137977f4">nlohmann::basic_json::dump</a></div><div class="ttdeci">string_t dump(const int indent=-1, const char indent_char=' ', const bool ensure_ascii=false, const error_handler_t error_handler=error_handler_t::strict) const</div><div class="ttdoc">serialization</div><div class="ttdef"><b>Definition</b> json.hpp:2418</div></div>
<div class="ttc" id="aclassnlohmann_1_1basic__json_html_ab9e0253c92736db021840105d374c4c4"><div class="ttname"><a href="../../d9/dcc/classnlohmann_1_1basic__json.html#ab9e0253c92736db021840105d374c4c4">nlohmann::basic_json::push_back</a></div><div class="ttdeci">void push_back(basic_json &amp;&amp;val)</div><div class="ttdoc">add an object to an array</div><div class="ttdef"><b>Definition</b> json.hpp:5451</div></div>
<div class="ttc" id="anamespace_im_gui_html_a4dff507ce8bbe0da9556bb50b1e60d7f"><div class="ttname"><a href="../../df/d13/namespace_im_gui.html#a4dff507ce8bbe0da9556bb50b1e60d7f">ImGui::TreeNode</a></div><div class="ttdeci">IMGUI_API bool TreeNode(const char *label)</div><div class="ttdef"><b>Definition</b> imgui_widgets.cpp:6500</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00344">Slic3r::TreeSupport::Node::child</a>, <a class="el" href="../../#l00036">Slic3r::TreeNode::children</a>, <a class="el" href="../../#l02418">nlohmann::basic_json&lt; ObjectType, ArrayType, StringType, BooleanType, NumberIntegerType, NumberUnsignedType, NumberFloatType, AllocatorType, JSONSerializer, BinaryType &gt;::dump()</a>, <a class="el" href="../../#l00304">Slic3r::TreeSupport::Node::is_processed</a>, <a class="el" href="../../#l00343">Slic3r::TreeSupport::Node::parent</a>, <a class="el" href="../../#l00037">Slic3r::TreeNode::parents</a>, <a class="el" href="../../#l00297">Slic3r::TreeSupport::Node::position</a>, and <a class="el" href="../../#l05451">nlohmann::basic_json&lt; ObjectType, ArrayType, StringType, BooleanType, NumberIntegerType, NumberUnsignedType, NumberFloatType, AllocatorType, JSONSerializer, BinaryType &gt;::push_back()</a>.</p>
<div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_a2a48a228bbe9db750b4acb65e1ea7ae5_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a02203b50af22328f55e5eb988d665553" name="a02203b50af22328f55e5eb988d665553"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02203b50af22328f55e5eb988d665553">&#9670;&#160;</a></span>spanning_tree_to_polygon()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a> Slic3r::TreeSupport::spanning_tree_to_polygon </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../df/de0/class_slic3r_1_1_minimum_spanning_tree.html">MinimumSpanningTree</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>spanning_trees</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a>&#160;</td>
          <td class="paramname"><em>layer_contours</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d38/lzoconf_8h.html#a61569f2965b7a369eb10b6d75d410d11">int</a>&#160;</td>
          <td class="paramname"><em>layer_nr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1673</span>{</div>
<div class="line"><span class="lineno"> 1674</span>    <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#ae39547681b4c9f15f0d44712cdb01d6a">Polygons</a> polys;</div>
<div class="line"><span class="lineno"> 1675</span>    <span class="keyword">auto</span>&amp; mst_line_x_layer_contour_cache = <a class="code hl_variable" href="../../d1/d72/class_slic3r_1_1_tree_support.html#aa16cc2e23a002f4f13f5f28ae12afbf4">m_mst_line_x_layer_contour_caches</a>[layer_nr];</div>
<div class="line"><span class="lineno"> 1676</span>    <span class="keywordflow">for</span> (MinimumSpanningTree mst : spanning_trees) {</div>
<div class="line"><span class="lineno"> 1677</span>        std::vector&lt;Point&gt; points = mst.vertices();</div>
<div class="line"><span class="lineno"> 1678</span>        <span class="keywordflow">if</span> (points.size() == 0)</div>
<div class="line"><span class="lineno"> 1679</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1680</span>        std::map&lt;Point, bool&gt; visited;</div>
<div class="line"><span class="lineno"> 1681</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;points.size();i++)</div>
<div class="line"><span class="lineno"> 1682</span>            visited.emplace(points[i],<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1683</span> </div>
<div class="line"><span class="lineno"> 1684</span>        std::unordered_set&lt;Line, LineHash&gt; to_ignore;</div>
<div class="line"><span class="lineno"> 1685</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; points.size(); i++) {</div>
<div class="line"><span class="lineno"> 1686</span>            <span class="keywordflow">if</span> (visited[points[i]] == <span class="keyword">true</span>)</div>
<div class="line"><span class="lineno"> 1687</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1688</span> </div>
<div class="line"><span class="lineno"> 1689</span>            <a class="code hl_enumvalue" href="../../d5/dd8/namespace_clipper2_lib.html#ae11c4d64b0c006fdcb85278a8d4a414ea4c0a11247d92f73fb84baa51e37a3263">Polygon</a> poly;</div>
<div class="line"><span class="lineno"> 1690</span>            <span class="keywordtype">bool</span> has_next = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1691</span>            <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> pt1 = points[i];</div>
<div class="line"><span class="lineno"> 1692</span>            poly.points.push_back(pt1);</div>
<div class="line"><span class="lineno"> 1693</span>            visited[pt1] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1694</span> </div>
<div class="line"><span class="lineno"> 1695</span>            <span class="keywordflow">while</span> (has_next) {</div>
<div class="line"><span class="lineno"> 1696</span>                <span class="keyword">const</span> std::vector&lt;Point&gt;&amp; neighbours = mst.adjacent_nodes(pt1);</div>
<div class="line"><span class="lineno"> 1697</span>                <span class="keywordflow">if</span> (neighbours.empty())</div>
<div class="line"><span class="lineno"> 1698</span>                {</div>
<div class="line"><span class="lineno"> 1699</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1700</span>                }</div>
<div class="line"><span class="lineno"> 1701</span> </div>
<div class="line"><span class="lineno"> 1702</span>                <span class="keywordtype">double</span> min_ccw = std::numeric_limits&lt;double&gt;::max();</div>
<div class="line"><span class="lineno"> 1703</span>                <a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> pt_selected = neighbours[0];</div>
<div class="line"><span class="lineno"> 1704</span>                has_next = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1705</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d8/d9b/point__areas_8cpp.html#a6a2f109ab3e0aba2f61e7d28188c3660">Point</a> pt2 : neighbours) {</div>
<div class="line"><span class="lineno"> 1706</span>                    <span class="keywordflow">if</span> (to_ignore.find(Line(pt1, pt2)) == to_ignore.end()) {</div>
<div class="line"><span class="lineno"> 1707</span>                        <span class="keyword">auto</span> iter = mst_line_x_layer_contour_cache.find({ pt1,pt2 });</div>
<div class="line"><span class="lineno"> 1708</span>                        <span class="keywordflow">if</span> (iter != mst_line_x_layer_contour_cache.end()) {</div>
<div class="line"><span class="lineno"> 1709</span>                            <span class="keywordflow">if</span> (iter-&gt;second)</div>
<div class="line"><span class="lineno"> 1710</span>                                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1711</span>                        }</div>
<div class="line"><span class="lineno"> 1712</span>                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1713</span>                            <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a498065f79ccb865fc410d4afeacffc9c">Polylines</a> pls;</div>
<div class="line"><span class="lineno"> 1714</span>                            pls.emplace_back(pt1, pt2);</div>
<div class="line"><span class="lineno"> 1715</span>                            <a class="code hl_typedef" href="../../de/db8/namespace_slic3r.html#a498065f79ccb865fc410d4afeacffc9c">Polylines</a> pls_intersect = <a class="code hl_function" href="../../de/db8/namespace_slic3r.html#acebc3af95608afde6afc3aae65d00bd0">intersection_pl</a>(pls, layer_contours);</div>
<div class="line"><span class="lineno"> 1716</span>                            mst_line_x_layer_contour_cache.insert({ {pt1, pt2}, !pls_intersect.empty() });</div>
<div class="line"><span class="lineno"> 1717</span>                            mst_line_x_layer_contour_cache.insert({ {pt2, pt1}, !pls_intersect.empty() });</div>
<div class="line"><span class="lineno"> 1718</span>                            <span class="keywordflow">if</span> (!pls_intersect.empty())</div>
<div class="line"><span class="lineno"> 1719</span>                                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1720</span>                        }</div>
<div class="line"><span class="lineno"> 1721</span> </div>
<div class="line"><span class="lineno"> 1722</span>                        <span class="keywordflow">if</span> (poly.points.size() &lt; 2 || visited[pt2]==<span class="keyword">false</span>)</div>
<div class="line"><span class="lineno"> 1723</span>                        {</div>
<div class="line"><span class="lineno"> 1724</span>                            pt_selected = pt2;</div>
<div class="line"><span class="lineno"> 1725</span>                            has_next = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1726</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1727</span>                        }</div>
<div class="line"><span class="lineno"> 1728</span>                        <span class="keywordtype">double</span> curr_ccw = pt2.ccw(pt1, poly.points.back());</div>
<div class="line"><span class="lineno"> 1729</span>                        <span class="keywordflow">if</span> (curr_ccw &lt; min_ccw)</div>
<div class="line"><span class="lineno"> 1730</span>                        {</div>
<div class="line"><span class="lineno"> 1731</span>                            min_ccw = curr_ccw;</div>
<div class="line"><span class="lineno"> 1732</span>                            pt_selected = pt2;</div>
<div class="line"><span class="lineno"> 1733</span>                            has_next = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1734</span>                        }</div>
<div class="line"><span class="lineno"> 1735</span>                    }</div>
<div class="line"><span class="lineno"> 1736</span>                }</div>
<div class="line"><span class="lineno"> 1737</span>                <span class="keywordflow">if</span> (has_next) {</div>
<div class="line"><span class="lineno"> 1738</span>                    poly.points.push_back(pt_selected);</div>
<div class="line"><span class="lineno"> 1739</span>                    to_ignore.insert(Line(pt1, pt_selected));</div>
<div class="line"><span class="lineno"> 1740</span>                    visited[pt_selected] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1741</span>                    pt1 = pt_selected;</div>
<div class="line"><span class="lineno"> 1742</span>                }</div>
<div class="line"><span class="lineno"> 1743</span>            }</div>
<div class="line"><span class="lineno"> 1744</span>            polys.emplace_back(std::move(poly));</div>
<div class="line"><span class="lineno"> 1745</span>        }</div>
<div class="line"><span class="lineno"> 1746</span>    }</div>
<div class="line"><span class="lineno"> 1747</span>    <span class="keywordflow">return</span> polys;</div>
<div class="line"><span class="lineno"> 1748</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00118">Slic3r::Point::ccw()</a>, <a class="el" href="../../#l00877">Slic3r::intersection_pl()</a>, and <a class="el" href="../../#l00018">Slic3r::MultiPoint::points</a>.</p>
<div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d1/d72/class_slic3r_1_1_tree_support_a02203b50af22328f55e5eb988d665553_cgraph.svg" width="100%" height="425"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a87bcd1a50c69642adfbd467a7256c23d" name="a87bcd1a50c69642adfbd467a7256c23d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87bcd1a50c69642adfbd467a7256c23d">&#9670;&#160;</a></span>avg_node_per_layer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d38/lzoconf_8h.html#a61569f2965b7a369eb10b6d75d410d11">int</a> Slic3r::TreeSupport::avg_node_per_layer = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aae0dd8cf9cd59f50841b17a85b3ed4d1" name="aae0dd8cf9cd59f50841b17a85b3ed4d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae0dd8cf9cd59f50841b17a85b3ed4d1">&#9670;&#160;</a></span>generator</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="../../d3/d93/class_slic3r_1_1_fill_lightning_1_1_generator.html">FillLightning::Generator</a>&gt; Slic3r::TreeSupport::generator</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac79134cdc391e7219e62f2c69be76ad7" name="ac79134cdc391e7219e62f2c69be76ad7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac79134cdc391e7219e62f2c69be76ad7">&#9670;&#160;</a></span>has_cantilever</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Slic3r::TreeSupport::has_cantilever = false</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab6ceca30741c916ae61fd99b6e2f000b" name="ab6ceca30741c916ae61fd99b6e2f000b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6ceca30741c916ae61fd99b6e2f000b">&#9670;&#160;</a></span>has_overhangs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Slic3r::TreeSupport::has_overhangs = false</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aea51639c5c7e46181da9e0f45bbda696" name="aea51639c5c7e46181da9e0f45bbda696"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea51639c5c7e46181da9e0f45bbda696">&#9670;&#160;</a></span>has_sharp_tails</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Slic3r::TreeSupport::has_sharp_tails = false</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8697e59f9029b0ce83867137111180e1" name="a8697e59f9029b0ce83867137111180e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8697e59f9029b0ce83867137111180e1">&#9670;&#160;</a></span>is_slim</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Slic3r::TreeSupport::is_slim = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00664">TreeSupport()</a>.</p>

</div>
</div>
<a id="a0fe17d4240db49835485cfc72af0fd1b" name="a0fe17d4240db49835485cfc72af0fd1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fe17d4240db49835485cfc72af0fd1b">&#9670;&#160;</a></span>is_strong</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Slic3r::TreeSupport::is_strong = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00664">TreeSupport()</a>.</p>

</div>
</div>
<a id="a39b142c27d4da545d49307bf5569d3ab" name="a39b142c27d4da545d49307bf5569d3ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39b142c27d4da545d49307bf5569d3ab">&#9670;&#160;</a></span>m_highest_overhang_layer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Slic3r::TreeSupport::m_highest_overhang_layer = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4fa44f6f6c9cbe27ad358c1313e1267d" name="a4fa44f6f6c9cbe27ad358c1313e1267d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fa44f6f6c9cbe27ad358c1313e1267d">&#9670;&#160;</a></span>m_machine_border</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc4/class_slic3r_1_1_ex_polygon.html">ExPolygon</a> Slic3r::TreeSupport::m_machine_border</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Polygons representing the limits of the printable area of the machine. </p>

<p class="reference">Referenced by <a class="el" href="../../#l00664">TreeSupport()</a>.</p>

</div>
</div>
<a id="aa16cc2e23a002f4f13f5f28ae12afbf4" name="aa16cc2e23a002f4f13f5f28ae12afbf4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa16cc2e23a002f4f13f5f28ae12afbf4">&#9670;&#160;</a></span>m_mst_line_x_layer_contour_caches</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::unordered_map&lt;<a class="el" href="../../d6/d3b/class_slic3r_1_1_line.html">Line</a>, bool, <a class="el" href="../../dd/d21/struct_slic3r_1_1_line_hash.html">LineHash</a>&gt; &gt; Slic3r::TreeSupport::m_mst_line_x_layer_contour_caches</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3dea25663c426511a32a88d80361fa37" name="a3dea25663c426511a32a88d80361fa37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dea25663c426511a32a88d80361fa37">&#9670;&#160;</a></span>m_object</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d87/class_slic3r_1_1_print_object.html">PrintObject</a>* Slic3r::TreeSupport::m_object</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00664">TreeSupport()</a>, and <a class="el" href="../../#l00715">detect_overhangs()</a>.</p>

</div>
</div>
<a id="a676288a8d6c41e000fa9c603362300da" name="a676288a8d6c41e000fa9c603362300da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a676288a8d6c41e000fa9c603362300da">&#9670;&#160;</a></span>m_object_config</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../de/db8/namespace_slic3r.html#ad48b86fa8e529e56c6bd00ff2f9839ab">PrintObjectConfig</a>* Slic3r::TreeSupport::m_object_config</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00664">TreeSupport()</a>.</p>

</div>
</div>
<a id="adb71d9dc16f8b49fdde6037bce2ca4cd" name="adb71d9dc16f8b49fdde6037bce2ca4cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb71d9dc16f8b49fdde6037bce2ca4cd">&#9670;&#160;</a></span>m_raft_layers</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Slic3r::TreeSupport::m_raft_layers = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00664">TreeSupport()</a>.</p>

</div>
</div>
<a id="a0f07085f338767f4b9fff39a418e717f" name="a0f07085f338767f4b9fff39a418e717f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f07085f338767f4b9fff39a418e717f">&#9670;&#160;</a></span>m_slicing_params</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d2b/struct_slic3r_1_1_slicing_parameters.html">SlicingParameters</a> Slic3r::TreeSupport::m_slicing_params</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00664">TreeSupport()</a>.</p>

</div>
</div>
<a id="a8e234c218b1adc33974bc22796876ed2" name="a8e234c218b1adc33974bc22796876ed2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e234c218b1adc33974bc22796876ed2">&#9670;&#160;</a></span>m_spanning_trees</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;<a class="el" href="../../df/de0/class_slic3r_1_1_minimum_spanning_tree.html">MinimumSpanningTree</a>&gt; &gt; Slic3r::TreeSupport::m_spanning_trees</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4cebd329d67e84cf50b2942817987696" name="a4cebd329d67e84cf50b2942817987696"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cebd329d67e84cf50b2942817987696">&#9670;&#160;</a></span>m_support_params</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html#dc/d1c/struct_slic3r_1_1_tree_support_1_1_support_params">SupportParams</a> Slic3r::TreeSupport::m_support_params</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00664">TreeSupport()</a>.</p>

</div>
</div>
<a id="aa683ac2cae76bf3adfde9333039016db" name="aa683ac2cae76bf3adfde9333039016db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa683ac2cae76bf3adfde9333039016db">&#9670;&#160;</a></span>m_ts_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="../../d9/da6/class_slic3r_1_1_tree_support_data.html">TreeSupportData</a>&gt; Slic3r::TreeSupport::m_ts_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generator for model collision, avoidance and internal guide volumes. </p>
<p>Lazily computes volumes as needed. </p><dl class="section warning"><dt>Warning</dt><dd>This class is NOT currently thread-safe and should not be accessed in OpenMP blocks </dd></dl>

</div>
</div>
<a id="a161d05526fd75928c2dc1d04e4c0c49a" name="a161d05526fd75928c2dc1d04e4c0c49a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a161d05526fd75928c2dc1d04e4c0c49a">&#9670;&#160;</a></span>MAX_BRANCH_RADIUS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a> Slic3r::TreeSupport::MAX_BRANCH_RADIUS = 10.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00664">TreeSupport()</a>.</p>

</div>
</div>
<a id="ad9a79d4d08f9c209973a02bf7293e2e6" name="ad9a79d4d08f9c209973a02bf7293e2e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9a79d4d08f9c209973a02bf7293e2e6">&#9670;&#160;</a></span>max_cantilever_dist</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Slic3r::TreeSupport::max_cantilever_dist = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00715">detect_overhangs()</a>.</p>

</div>
</div>
<a id="a8a49148abbffe316cb0548cbc48d0603" name="a8a49148abbffe316cb0548cbc48d0603"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a49148abbffe316cb0548cbc48d0603">&#9670;&#160;</a></span>MIN_BRANCH_RADIUS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/db8/namespace_slic3r.html#a2ac5c755948c74f5f5f975acd5057fe9">coordf_t</a> Slic3r::TreeSupport::MIN_BRANCH_RADIUS = 0.5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4453aaa97f66b4d66f47d534979ee149" name="a4453aaa97f66b4d66f47d534979ee149"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4453aaa97f66b4d66f47d534979ee149">&#9670;&#160;</a></span>nodes_angle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float Slic3r::TreeSupport::nodes_angle = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a99db4fd5f893221ceec871fec5d28af2" name="a99db4fd5f893221ceec871fec5d28af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99db4fd5f893221ceec871fec5d28af2">&#9670;&#160;</a></span>printZ_to_lightninglayer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;double, size_t&gt; Slic3r::TreeSupport::printZ_to_lightninglayer</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aafc183d8390ddc4b2b7af16954628504" name="aafc183d8390ddc4b2b7af16954628504"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafc183d8390ddc4b2b7af16954628504">&#9670;&#160;</a></span>support_style</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/db8/namespace_slic3r.html#ac4444e117129d57974e96c39d6976a3b">SupportMaterialStyle</a> Slic3r::TreeSupport::support_style</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00664">TreeSupport()</a>.</p>

</div>
</div>
<a id="a2dde09f186446f7f085b60e1a1ea3df3" name="a2dde09f186446f7f085b60e1a1ea3df3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dde09f186446f7f085b60e1a1ea3df3">&#9670;&#160;</a></span>support_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/db8/namespace_slic3r.html#aaaabcf9acc53536eede4610d1218434c">SupportType</a> Slic3r::TreeSupport::support_type</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00664">TreeSupport()</a>, and <a class="el" href="../../#l00715">detect_overhangs()</a>.</p>

</div>
</div>
<a id="ac2482e1ff17824c9f85615be4188049e" name="ac2482e1ff17824c9f85615be4188049e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2482e1ff17824c9f85615be4188049e">&#9670;&#160;</a></span>tree_support_branch_diameter_angle</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float Slic3r::TreeSupport::tree_support_branch_diameter_angle = 5.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00664">TreeSupport()</a>.</p>

</div>
</div>
<a id="a8272b9400f42356243f0973d0f2cb0c0" name="a8272b9400f42356243f0973d0f2cb0c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8272b9400f42356243f0973d0f2cb0c0">&#9670;&#160;</a></span>with_infill</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Slic3r::TreeSupport::with_infill = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../#l00664">TreeSupport()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/libslic3r/<a class="el" href="../../">TreeSupport.hpp</a></li>
<li>src/libslic3r/<a class="el" href="../../">TreeSupport.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../de/db8/namespace_slic3r.html">Slic3r</a></li><li class="navelem"><a class="el" href="../../d1/d72/class_slic3r_1_1_tree_support.html">TreeSupport</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
